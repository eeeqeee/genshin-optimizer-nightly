{"version":3,"file":"861.48fcb7f41eccc90c.js","mappings":"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","sources":["webpack:///./src/app/Components/Character/LocationAutocomplete.tsx","webpack:///./src/app/Components/ToggleButton/WeaponToggle.tsx","webpack:///./src/app/PageWeapon/index.tsx","webpack:///./src/app/ReactHooks/useWeapon.tsx","webpack:///./src/app/Util/totalUtils.ts","webpack:///../../node_modules/@mui/icons-material/Edit.js","webpack:///../../node_modules/@mui/icons-material/esm/Add.js","webpack:///../../node_modules/@mui/icons-material/esm/Lock.js","webpack:///../../node_modules/@mui/icons-material/esm/LockOpen.js"],"sourcesContent":["import type {\n  LocationCharacterKey,\n  LocationKey,\n} from '@genshin-optimizer/consts'\nimport {\n  allTravelerKeys,\n  charKeyToLocCharKey,\n  charKeyToLocGenderedCharKey,\n} from '@genshin-optimizer/consts'\nimport { BusinessCenter } from '@mui/icons-material'\nimport type { AutocompleteProps } from '@mui/material'\nimport { Skeleton } from '@mui/material'\nimport { Suspense, useCallback, useContext, useMemo } from 'react'\nimport { useTranslation } from 'react-i18next'\nimport { SillyContext } from '../../Context/SillyContext'\nimport { getCharSheet } from '../../Data/Characters'\nimport type CharacterSheet from '../../Data/Characters/CharacterSheet'\nimport { DatabaseContext } from '../../Database/Database'\nimport useDBMeta from '../../ReactHooks/useDBMeta'\nimport type { GeneralAutocompleteOption } from '../GeneralAutocomplete'\nimport { GeneralAutocomplete } from '../GeneralAutocomplete'\nimport CharIconSide from '../Image/CharIconSide'\ntype LocationAutocompleteProps = {\n  location: LocationKey\n  setLocation: (v: LocationKey) => void\n  filter?: (v: CharacterSheet) => void\n  autoCompleteProps?: Omit<\n    AutocompleteProps<\n      GeneralAutocompleteOption<LocationKey>,\n      false,\n      false,\n      false\n    >,\n    'renderInput' | 'onChange' | 'options'\n  >\n}\nexport function LocationAutocomplete({\n  location,\n  setLocation,\n  filter = () => true,\n  autoCompleteProps = {},\n}: LocationAutocompleteProps) {\n  const { t } = useTranslation([\n    'ui',\n    'artifact',\n    'sillyWisher_charNames',\n    'charNames_gen',\n  ])\n  const { silly } = useContext(SillyContext)\n  const { database } = useContext(DatabaseContext)\n  const { gender } = useDBMeta()\n  const toText = useCallback(\n    (silly: boolean) =>\n      (key: LocationCharacterKey): string =>\n        t(\n          `${\n            silly ? 'sillyWisher_charNames' : 'charNames_gen'\n          }:${charKeyToLocGenderedCharKey(\n            database.chars.LocationToCharacterKey(key),\n            gender\n          )}`\n        ),\n    [database, gender, t]\n  )\n  const toImg = useCallback(\n    (key: LocationKey) =>\n      key === '' ? (\n        <BusinessCenter />\n      ) : (\n        <CharIconSide\n          characterKey={database.chars.LocationToCharacterKey(key)}\n        />\n      ),\n    [database]\n  )\n  const isFavorite = useCallback(\n    (key: LocationCharacterKey) =>\n      key === 'Traveler'\n        ? allTravelerKeys.some((key) => database.charMeta.get(key).favorite)\n        : key\n        ? database.charMeta.get(key).favorite\n        : false,\n    [database]\n  )\n\n  const values: GeneralAutocompleteOption<LocationKey>[] = useMemo(\n    () => [\n      {\n        key: '',\n        label: t`artifact:filterLocation.inventory`,\n      },\n      ...Array.from(\n        new Set(\n          database.chars.keys\n            .filter((k) =>\n              getCharSheet(k, gender) ? filter(getCharSheet(k, gender)) : true\n            )\n            .map((k) => charKeyToLocCharKey(k))\n        )\n      )\n        .map(\n          (v): GeneralAutocompleteOption<LocationKey> => ({\n            key: v,\n            label: toText(silly)(v),\n            favorite: isFavorite(v),\n            alternateNames: silly ? [toText(!silly)(v)] : undefined,\n          })\n        )\n        .sort((a, b) => {\n          if (a.favorite && !b.favorite) return -1\n          if (!a.favorite && b.favorite) return 1\n          return a.label.localeCompare(b.label)\n        }),\n    ],\n    [t, database.chars.keys, gender, filter, toText, silly, isFavorite]\n  )\n  return (\n    <Suspense fallback={<Skeleton variant=\"text\" width={100} />}>\n      <GeneralAutocomplete\n        size=\"small\"\n        options={values}\n        valueKey={location}\n        onChange={(k) => setLocation(k ?? '')}\n        toImg={toImg}\n        {...autoCompleteProps}\n      />\n    </Suspense>\n  )\n}\n","import type { WeaponTypeKey } from '@genshin-optimizer/consts'\nimport { allWeaponTypeKeys } from '@genshin-optimizer/consts'\nimport { imgAssets } from '@genshin-optimizer/g-assets'\nimport { Chip, ToggleButton, useMediaQuery, useTheme } from '@mui/material'\nimport { handleMultiSelect } from '../../Util/MultiSelect'\nimport ImgIcon from '../Image/ImgIcon'\nimport type { SolidToggleButtonGroupProps } from '../SolidToggleButtonGroup'\nimport SolidToggleButtonGroup from '../SolidToggleButtonGroup'\ntype WeaponToggleProps = Omit<\n  SolidToggleButtonGroupProps,\n  'onChange' | 'value'\n> & {\n  onChange: (value: WeaponTypeKey[]) => void\n  value: WeaponTypeKey[]\n  totals: Record<WeaponTypeKey, Displayable>\n}\n\nconst weaponTypeHandler = handleMultiSelect([...allWeaponTypeKeys])\nexport default function WeaponToggle({\n  value,\n  totals,\n  onChange,\n  ...props\n}: WeaponToggleProps) {\n  const theme = useTheme()\n  const xs = !useMediaQuery(theme.breakpoints.up('sm'))\n  return (\n    <SolidToggleButtonGroup exclusive value={value} {...props}>\n      {allWeaponTypeKeys.map((wt) => (\n        <ToggleButton\n          key={wt}\n          value={wt}\n          sx={{\n            p: xs ? 1 : undefined,\n            minWidth: xs ? 0 : '7em',\n            display: 'flex',\n            gap: xs ? 0 : 1,\n          }}\n          onClick={() => onChange(weaponTypeHandler(value, wt))}\n        >\n          <ImgIcon src={imgAssets.weaponTypes?.[wt]} size={2} sideMargin />\n          <Chip label={totals[wt]} size=\"small\" />\n        </ToggleButton>\n      ))}\n    </SolidToggleButtonGroup>\n  )\n}\n","import type { WeaponKey } from '@genshin-optimizer/consts'\nimport { allRarityKeys, allWeaponTypeKeys } from '@genshin-optimizer/consts'\nimport { useForceUpdate, useMediaQueryUp } from '@genshin-optimizer/react-util'\nimport { clamp, filterFunction, sortFunction } from '@genshin-optimizer/util'\nimport { Add } from '@mui/icons-material'\nimport {\n  Box,\n  Button,\n  CardContent,\n  Grid,\n  Pagination,\n  Skeleton,\n  TextField,\n  Typography,\n} from '@mui/material'\nimport type { ChangeEvent } from 'react'\nimport React, {\n  lazy,\n  Suspense,\n  useCallback,\n  useContext,\n  useDeferredValue,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'react'\nimport ReactGA from 'react-ga4'\nimport { Trans, useTranslation } from 'react-i18next'\nimport CardDark from '../Components/Card/CardDark'\nimport SortByButton from '../Components/SortByButton'\nimport RarityToggle from '../Components/ToggleButton/RarityToggle'\nimport WeaponToggle from '../Components/ToggleButton/WeaponToggle'\nimport { getWeaponSheet } from '../Data/Weapons'\nimport { DatabaseContext } from '../Database/Database'\nimport { catTotal } from '../Util/totalUtils'\nimport {\n  weaponFilterConfigs,\n  weaponSortConfigs,\n  weaponSortMap,\n} from '../Util/WeaponSort'\nimport { initialWeapon } from '../Util/WeaponUtil'\nimport WeaponCard from './WeaponCard'\nconst WeaponSelectionModal = React.lazy(\n  () => import('../Components/Weapon/WeaponSelectionModal')\n)\n// Lazy load the weapon display\nconst WeaponEditor = lazy(() => import('./WeaponEditor'))\n\nconst columns = { xs: 1, sm: 2, md: 3, lg: 3, xl: 4 }\nconst numToShowMap = { xs: 10, sm: 12, md: 24, lg: 24, xl: 24 }\n\nconst sortKeys = Object.keys(weaponSortMap)\nexport default function PageWeapon() {\n  const { t } = useTranslation(['page_weapon', 'ui', 'weaponNames_gen'])\n  const { database } = useContext(DatabaseContext)\n  const [state, setState] = useState(database.displayWeapon.get())\n  useEffect(\n    () => database.displayWeapon.follow((r, dbMeta) => setState(dbMeta)),\n    [database]\n  )\n\n  const [newWeaponModalShow, setnewWeaponModalShow] = useState(false)\n  const [dbDirty, forceUpdate] = useForceUpdate()\n  const invScrollRef = useRef<HTMLDivElement>(null)\n  const [pageIndex, setPageIndex] = useState(0)\n  //set follow, should run only once\n  useEffect(() => {\n    ReactGA.send({ hitType: 'pageview', page: '/weapon' })\n    return database.weapons.followAny(\n      (k, r) => (r === 'new' || r === 'remove') && forceUpdate()\n    )\n  }, [forceUpdate, database])\n\n  const brPt = useMediaQueryUp()\n  const maxNumToDisplay = numToShowMap[brPt]\n\n  const deleteWeapon = useCallback(\n    async (key: string) => {\n      const weapon = database.weapons.get(key)\n      if (!weapon) return\n      const name = t(`weaponNames_gen:${weapon.key}`)\n\n      if (!window.confirm(t('removeWeapon', { value: name }))) return\n      database.weapons.remove(key)\n      if (state.editWeaponId === key)\n        database.displayWeapon.set({ editWeaponId: '' })\n    },\n    [state.editWeaponId, database, t]\n  )\n\n  const editWeapon = useCallback(\n    (key: string | undefined) => {\n      database.displayWeapon.set({ editWeaponId: key })\n    },\n    [database]\n  )\n\n  const newWeapon = useCallback(\n    (weaponKey: WeaponKey) => {\n      editWeapon(database.weapons.new(initialWeapon(weaponKey)))\n    },\n    [database, editWeapon]\n  )\n\n  const [searchTerm, setSearchTerm] = useState('')\n  const deferredSearchTerm = useDeferredValue(searchTerm)\n\n  const { sortType, ascending, weaponType, rarity } = state\n  const { weaponIdList, totalWeaponNum } = useMemo(() => {\n    const weapons = database.weapons.values\n    const totalWeaponNum = weapons.length\n    const weaponIdList = weapons\n      .filter(\n        filterFunction(\n          { weaponType, rarity, name: deferredSearchTerm },\n          weaponFilterConfigs()\n        )\n      )\n      .sort(\n        sortFunction(\n          weaponSortMap[sortType] ?? [],\n          ascending,\n          weaponSortConfigs()\n        )\n      )\n      .map((weapon) => weapon.id)\n    return dbDirty && { weaponIdList, totalWeaponNum }\n  }, [\n    dbDirty,\n    database,\n    sortType,\n    ascending,\n    rarity,\n    weaponType,\n    deferredSearchTerm,\n  ])\n\n  const { weaponIdsToShow, numPages, currentPageIndex } = useMemo(() => {\n    const numPages = Math.ceil(weaponIdList.length / maxNumToDisplay)\n    const currentPageIndex = clamp(pageIndex, 0, numPages - 1)\n    return {\n      weaponIdsToShow: weaponIdList.slice(\n        currentPageIndex * maxNumToDisplay,\n        (currentPageIndex + 1) * maxNumToDisplay\n      ),\n      numPages,\n      currentPageIndex,\n    }\n  }, [weaponIdList, pageIndex, maxNumToDisplay])\n\n  // Pagination\n  const totalShowing =\n    weaponIdList.length !== totalWeaponNum\n      ? `${weaponIdList.length}/${totalWeaponNum}`\n      : `${totalWeaponNum}`\n  const setPage = useCallback(\n    (_: ChangeEvent<unknown>, value: number) => {\n      invScrollRef.current?.scrollIntoView({ behavior: 'smooth' })\n      setPageIndex(value - 1)\n    },\n    [setPageIndex, invScrollRef]\n  )\n\n  const resetEditWeapon = useCallback(\n    () => database.displayWeapon.set({ editWeaponId: '' }),\n    [database]\n  )\n\n  const { editWeaponId } = state\n\n  // Validate weaponId to be an actual weapon\n  useEffect(() => {\n    if (!editWeaponId) return\n    if (!database.weapons.get(editWeaponId)) resetEditWeapon()\n  }, [database, editWeaponId, resetEditWeapon])\n\n  const weaponTotals = useMemo(\n    () =>\n      catTotal(allWeaponTypeKeys, (ct) =>\n        Object.entries(database.weapons.data).forEach(([id, weapon]) => {\n          const wtk = getWeaponSheet(weapon.key).weaponType\n          ct[wtk].total++\n          if (weaponIdList.includes(id)) ct[wtk].current++\n        })\n      ),\n    [database, weaponIdList]\n  )\n\n  const weaponRarityTotals = useMemo(\n    () =>\n      catTotal(allRarityKeys, (ct) =>\n        Object.entries(database.weapons.data).forEach(([id, weapon]) => {\n          const wr = getWeaponSheet(weapon.key).rarity\n          ct[wr].total++\n          if (weaponIdList.includes(id)) ct[wr].current++\n        })\n      ),\n    [database, weaponIdList]\n  )\n\n  return (\n    <Box my={1} display=\"flex\" flexDirection=\"column\" gap={1}>\n      <Suspense fallback={false}>\n        <WeaponSelectionModal\n          show={newWeaponModalShow}\n          onHide={() => setnewWeaponModalShow(false)}\n          onSelect={newWeapon}\n        />\n      </Suspense>\n      {/* Editor/character detail display */}\n      <Suspense fallback={false}>\n        <WeaponEditor\n          weaponId={editWeaponId}\n          footer\n          onClose={resetEditWeapon}\n        />\n      </Suspense>\n\n      <CardDark ref={invScrollRef}>\n        <CardContent sx={{ display: 'flex', flexDirection: 'column', gap: 1 }}>\n          <Box display=\"flex\" flexWrap=\"wrap\" gap={1} alignItems=\"stretch\">\n            <WeaponToggle\n              onChange={(weaponType) =>\n                database.displayWeapon.set({ weaponType })\n              }\n              value={weaponType}\n              totals={weaponTotals}\n              size=\"small\"\n            />\n            <RarityToggle\n              sx={{ height: '100%' }}\n              onChange={(rarity) => database.displayWeapon.set({ rarity })}\n              value={rarity}\n              totals={weaponRarityTotals}\n              size=\"small\"\n            />\n            <Box flexGrow={1} />\n            <TextField\n              autoFocus\n              size=\"small\"\n              value={searchTerm}\n              onChange={(e: ChangeEvent<HTMLTextAreaElement>) =>\n                setSearchTerm(e.target.value)\n              }\n              label={t('weaponName')}\n              sx={{ height: '100%' }}\n              InputProps={{\n                sx: { height: '100%' },\n              }}\n            />\n          </Box>\n          <Box\n            display=\"flex\"\n            justifyContent=\"space-between\"\n            alignItems=\"flex-end\"\n            flexWrap=\"wrap\"\n          >\n            <Pagination\n              count={numPages}\n              page={currentPageIndex + 1}\n              onChange={setPage}\n            />\n            <ShowingWeapon\n              numShowing={weaponIdsToShow.length}\n              total={totalShowing}\n              t={t}\n            />\n            <SortByButton\n              sx={{ height: '100%' }}\n              sortKeys={sortKeys}\n              value={sortType}\n              onChange={(sortType) => database.displayWeapon.set({ sortType })}\n              ascending={ascending}\n              onChangeAsc={(ascending) =>\n                database.displayWeapon.set({ ascending })\n              }\n            />\n          </Box>\n        </CardContent>\n      </CardDark>\n      <Suspense\n        fallback={\n          <Skeleton\n            variant=\"rectangular\"\n            sx={{ width: '100%', height: '100%', minHeight: 500 }}\n          />\n        }\n      >\n        <Button\n          fullWidth\n          onClick={() => setnewWeaponModalShow(true)}\n          color=\"info\"\n          startIcon={<Add />}\n        >\n          {t('page_weapon:addWeapon')}\n        </Button>\n        <Grid container spacing={1} columns={columns}>\n          {weaponIdsToShow.map((weaponId) => (\n            <Grid item key={weaponId} xs={1}>\n              <WeaponCard\n                weaponId={weaponId}\n                onDelete={deleteWeapon}\n                onEdit={editWeapon}\n                canEquip\n              />\n            </Grid>\n          ))}\n        </Grid>\n      </Suspense>\n      {numPages > 1 && (\n        <CardDark>\n          <CardContent>\n            <Grid container alignItems=\"flex-end\">\n              <Grid item flexGrow={1}>\n                <Pagination\n                  count={numPages}\n                  page={currentPageIndex + 1}\n                  onChange={setPage}\n                />\n              </Grid>\n              <Grid item>\n                <ShowingWeapon\n                  numShowing={weaponIdsToShow.length}\n                  total={totalShowing}\n                  t={t}\n                />\n              </Grid>\n            </Grid>\n          </CardContent>\n        </CardDark>\n      )}\n    </Box>\n  )\n}\nfunction ShowingWeapon({ numShowing, total, t }) {\n  return (\n    <Typography color=\"text.secondary\">\n      <Trans t={t} i18nKey=\"showingNum\" count={numShowing} value={total}>\n        Showing <b>{{ count: numShowing } as TransObject}</b> out of{' '}\n        {{ value: total }} Weapons\n      </Trans>\n    </Typography>\n  )\n}\n","import { useContext, useEffect, useState } from 'react'\nimport { DatabaseContext } from '../Database/Database'\n\nexport default function useWeapon(weaponID: string | undefined = '') {\n  const { database } = useContext(DatabaseContext)\n  const [weapon, setWeapon] = useState(database.weapons.get(weaponID))\n  useEffect(\n    () => setWeapon(database.weapons.get(weaponID)),\n    [database, weaponID]\n  )\n  useEffect(\n    () =>\n      weaponID\n        ? database.weapons.follow(\n            weaponID,\n            (k, r, v) => r === 'update' && setWeapon(v)\n          )\n        : undefined,\n    [weaponID, setWeapon, database]\n  )\n  return weapon\n}\n","import { objMap } from '@genshin-optimizer/util'\ntype Entry = {\n  total: number\n  current: number\n}\ntype CatTotalKey = string | number | symbol\n// A helper function to generate multiple `current/total` formated string object with categories using a single callback\nexport function bulkCatTotal(\n  catTotals: Record<CatTotalKey, readonly CatTotalKey[]>,\n  cb: (ctMap: Record<CatTotalKey, Record<CatTotalKey, Entry>>) => void\n) {\n  const ctMap = objMap(catTotals, (keys) => catTotalObj(keys))\n  cb(ctMap)\n  return objMap(ctMap, (ct) => catTotalToStringObj(ct))\n}\n// A helper function to generate a `current/total` formated string object with categories\nexport function catTotal<T extends CatTotalKey>(\n  keys: readonly T[],\n  cb: (ct: Record<T, Entry>) => void\n) {\n  const ct = catTotalObj(keys)\n  cb(ct)\n  return catTotalToStringObj(ct)\n}\n\nfunction catTotalObj<T extends CatTotalKey>(\n  keys: readonly T[]\n): Record<T, Entry> {\n  return Object.fromEntries(\n    keys.map((k) => [k, { total: 0, current: 0 }])\n  ) as Record<T, Entry>\n}\n\nfunction catTotalToStringObj<T extends CatTotalKey>(tot: Record<T, Entry>) {\n  return objMap(tot, ({ total, current }) =>\n    current === total ? `${total}` : `${current}/${total}`\n  ) as Record<T, string>\n}\n","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z\"\n}), 'Edit');\nexports.default = _default;","import createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z\"\n}), 'Add');","import createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z\"\n}), 'Lock');","import createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M12 17c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm6-9h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6h1.9c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm0 12H6V10h12v10z\"\n}), 'LockOpen');"],"names":["LocationAutocomplete","location","setLocation","filter","autoCompleteProps","t","useTranslation","silly","useContext","SillyContext","database","DatabaseContext","gender","useDBMeta","toText","useCallback","key","charKeyToLocGenderedCharKey","chars","LocationToCharacterKey","toImg","characterKey","isFavorite","allTravelerKeys","charMeta","get","favorite","values","useMemo","label","Array","from","Set","keys","k","getCharSheet","map","charKeyToLocCharKey","v","alternateNames","undefined","sort","a","b","localeCompare","Suspense","fallback","variant","width","size","options","valueKey","onChange","weaponTypeHandler","handleMultiSelect","allWeaponTypeKeys","WeaponToggle","value","totals","props","theme","useTheme","xs","useMediaQuery","breakpoints","up","exclusive","wt","sx","p","minWidth","display","gap","onClick","src","imgAssets","sideMargin","WeaponSelectionModal","React","WeaponEditor","lazy","columns","sm","md","lg","xl","numToShowMap","sortKeys","Object","weaponSortMap","PageWeapon","state","setState","useState","displayWeapon","useEffect","follow","r","dbMeta","newWeaponModalShow","setnewWeaponModalShow","dbDirty","forceUpdate","useForceUpdate","invScrollRef","useRef","pageIndex","setPageIndex","ReactGA","hitType","page","weapons","followAny","brPt","useMediaQueryUp","maxNumToDisplay","deleteWeapon","async","weapon","name","window","confirm","remove","editWeaponId","set","editWeapon","newWeapon","weaponKey","new","initialWeapon","searchTerm","setSearchTerm","deferredSearchTerm","useDeferredValue","sortType","ascending","weaponType","rarity","weaponIdList","totalWeaponNum","length","filterFunction","weaponFilterConfigs","sortFunction","weaponSortConfigs","id","weaponIdsToShow","numPages","currentPageIndex","Math","ceil","clamp","slice","totalShowing","setPage","_","current","scrollIntoView","behavior","resetEditWeapon","weaponTotals","catTotal","ct","entries","data","forEach","wtk","getWeaponSheet","total","includes","weaponRarityTotals","allRarityKeys","wr","my","flexDirection","show","onHide","onSelect","weaponId","footer","onClose","ref","flexWrap","alignItems","height","flexGrow","autoFocus","e","target","InputProps","justifyContent","count","ShowingWeapon","numShowing","onChangeAsc","minHeight","fullWidth","color","startIcon","container","spacing","item","onDelete","onEdit","canEquip","i18nKey","useWeapon","weaponID","setWeapon","bulkCatTotal","catTotals","cb","ctMap","objMap","catTotalObj","catTotalToStringObj","fromEntries","tot","_interopRequireDefault","exports","_createSvgIcon","_jsxRuntime","_default","default","jsx","d"],"sourceRoot":""}