{"version":3,"file":"965.78de437be40f0323.js","mappings":"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","sources":["webpack:///./src/app/Components/Artifact/ArtifactRarityDropdown.tsx","webpack:///./src/app/Components/Artifact/ArtifactSlotDropdown.tsx","webpack:///./src/app/Components/CustomNumberTextField.tsx","webpack:///../../libs/gi-good/src/randomizeArtifact.ts","webpack:///./src/app/PageArtifact/ArtifactEditor/Components/SubstatEfficiencyDisplayCard.tsx","webpack:///./src/app/PageArtifact/ArtifactEditor/Components/SubstatInput.tsx","webpack:///./src/app/PageArtifact/ArtifactEditor/Components/UploadExplainationModal.tsx","webpack:///./src/app/PageArtifact/ScanningUtil.tsx","webpack:///./src/app/PageArtifact/BorrowManager.ts","webpack:///./src/app/PageArtifact/ArtifactEditor.tsx"],"sourcesContent":["import type { ButtonProps } from '@mui/material'\nimport { MenuItem } from '@mui/material'\nimport { useTranslation } from 'react-i18next'\nimport type { ArtifactRarity } from '@genshin-optimizer/consts'\nimport DropdownButton from '../DropdownMenu/DropdownButton'\nimport { StarsDisplay } from '../StarDisplay'\n\ntype props = ButtonProps & {\n  rarity?: ArtifactRarity\n  onChange: (rarity: ArtifactRarity) => void\n  filter: (ArtifactRarity) => boolean\n}\n\nexport default function ArtifactRarityDropdown({\n  rarity,\n  onChange,\n  filter,\n  ...props\n}: props) {\n  const { t } = useTranslation('artifact')\n  return (\n    <DropdownButton\n      {...props}\n      title={rarity ? <StarsDisplay stars={rarity} inline /> : t`editor.rarity`}\n      color={rarity ? 'success' : 'primary'}\n    >\n      {([5, 4, 3] as ArtifactRarity[]).map((rarity) => (\n        <MenuItem\n          key={rarity}\n          disabled={!filter(rarity)}\n          onClick={() => onChange(rarity)}\n        >\n          <StarsDisplay stars={rarity} inline />\n        </MenuItem>\n      ))}\n    </DropdownButton>\n  )\n}\n","import type { ArtifactSlotKey } from '@genshin-optimizer/consts'\nimport { allArtifactSlotKeys } from '@genshin-optimizer/consts'\nimport { Replay } from '@mui/icons-material'\nimport type { ButtonProps } from '@mui/material'\nimport { Divider, ListItemIcon, ListItemText, MenuItem } from '@mui/material'\nimport { useTranslation } from 'react-i18next'\nimport DropdownButton from '../DropdownMenu/DropdownButton'\nimport SlotIcon from './SlotIcon'\n\ntype ArtifactSlotDropdownProps = ButtonProps & {\n  slotKey?: ArtifactSlotKey | ''\n  onChange: (slotKey: ArtifactSlotKey | '') => void\n  hasUnselect?: boolean\n}\n\nexport default function ArtifactSlotDropdown({\n  slotKey = '',\n  onChange,\n  hasUnselect = false,\n  ...props\n}: ArtifactSlotDropdownProps) {\n  const { t } = useTranslation(['artifact', 'ui'])\n  return (\n    <DropdownButton\n      title={slotKey ? t(`artifact:slotName:${slotKey}`) : t('artifact:slot')}\n      color={slotKey ? 'success' : 'primary'}\n      startIcon={slotKey ? <SlotIcon slotKey={slotKey} /> : undefined}\n      {...props}\n    >\n      {hasUnselect && (\n        <MenuItem\n          selected={slotKey === ''}\n          disabled={slotKey === ''}\n          onClick={() => onChange('')}\n        >\n          <ListItemIcon>\n            <Replay />\n          </ListItemIcon>\n          <ListItemText>{t`ui:unselect`}</ListItemText>\n        </MenuItem>\n      )}\n      {hasUnselect && <Divider />}\n      {allArtifactSlotKeys.map((key) => (\n        <MenuItem\n          key={key}\n          selected={slotKey === key}\n          disabled={slotKey === key}\n          onClick={() => onChange(key)}\n        >\n          <ListItemIcon>\n            <SlotIcon slotKey={key} />\n          </ListItemIcon>\n          <ListItemText>{t(`artifact:slotName:${key}`)}</ListItemText>\n        </MenuItem>\n      ))}\n    </DropdownButton>\n  )\n}\n","import type { TextFieldProps } from '@mui/material'\nimport { TextField } from '@mui/material'\nimport { useCallback, useEffect, useState } from 'react'\ntype props = TextFieldProps & {\n  value?: number | undefined\n  onChange: (newValue: number | undefined) => void\n  disabled?: boolean\n  float?: boolean\n  allowEmpty?: boolean\n}\nexport default function CustomNumberTextField({\n  value,\n  onChange,\n  disabled = false,\n  float = false,\n  ...props\n}: props) {\n  const [state, setState] = useState('')\n  const sendChange = useCallback(() => {\n    if (state === '') return onChange(0)\n    const parseFunc = float ? parseFloat : parseInt\n    onChange(parseFunc(state))\n  }, [onChange, state, float])\n  useEffect(() => setState(value?.toString() ?? ''), [value, setState]) // update value on value change\n\n  return (\n    <TextField\n      value={state}\n      aria-label=\"custom-input\"\n      type=\"number\"\n      onChange={(e: any) => setState(e.target.value)}\n      onBlur={sendChange}\n      disabled={disabled}\n      onKeyDown={(e: any) => e.key === 'Enter' && sendChange()}\n      {...props}\n    />\n  )\n}\n","import type {\n  ArtifactRarity,\n  ArtifactSlotKey,\n  MainStatKey,\n  RarityKey,\n  SubstatKey,\n} from '@genshin-optimizer/consts'\nimport {\n  allArtifactRarityKeys,\n  allArtifactSetKeys,\n  allSubstatKeys,\n  artMaxLevel,\n  artSlotsData,\n  artSubstatRollData,\n} from '@genshin-optimizer/consts'\nimport { allStats } from '@genshin-optimizer/gi-stats'\nimport {\n  artDisplayValue,\n  getSubstatValuesPercent,\n} from '@genshin-optimizer/gi-util'\nimport {\n  getRandomElementFromArray,\n  getRandomIntInclusive,\n  unit,\n} from '@genshin-optimizer/util'\nimport type { IArtifact, ISubstat } from './IArtifact'\n\n// do not randomize Prayers since they don't have all slots\nconst artSets = allArtifactSetKeys.filter((k) => !k.startsWith('Prayers'))\nexport function randomizeArtifact(base: Partial<IArtifact> = {}): IArtifact {\n  const setKey = base.setKey ?? getRandomElementFromArray(artSets)\n  const data = allStats.art.data[setKey]\n\n  const rarity = (base.rarity ??\n    getRandomElementFromArray(\n      data.rarities.filter((r: number) =>\n        // GO only supports artifacts from 3 to 5 stars\n        allArtifactRarityKeys.includes(r as ArtifactRarity)\n      )\n    )) as ArtifactRarity\n  const slot: ArtifactSlotKey =\n    base.slotKey ?? getRandomElementFromArray(data.slots)\n  const mainStatKey: MainStatKey =\n    base.mainStatKey ?? getRandomElementFromArray(artSlotsData[slot].stats)\n  const level =\n    base.level ?? getRandomIntInclusive(0, artMaxLevel[rarity as RarityKey])\n  const substats: ISubstat[] = [0, 1, 2, 3].map(() => ({ key: '', value: 0 }))\n\n  const { low, high } = artSubstatRollData[rarity]\n  const totRolls = Math.floor(level / 4) + getRandomIntInclusive(low, high)\n  const numOfInitialSubstats = Math.min(totRolls, 4)\n  const numUpgradesOrUnlocks = totRolls - numOfInitialSubstats\n\n  const RollStat = (substat: SubstatKey): number =>\n    getRandomElementFromArray(getSubstatValuesPercent(substat, rarity))\n\n  let remainingSubstats = allSubstatKeys.filter((key) => mainStatKey !== key)\n  for (const substat of substats.slice(0, numOfInitialSubstats)) {\n    substat.key = getRandomElementFromArray(remainingSubstats)\n    substat.value = RollStat(substat.key as SubstatKey)\n    remainingSubstats = remainingSubstats.filter((key) => key !== substat.key)\n  }\n  for (let i = 0; i < numUpgradesOrUnlocks; i++) {\n    const substat = getRandomElementFromArray(substats)\n    substat.value += RollStat(substat.key as any)\n  }\n  for (const substat of substats)\n    if (substat.key) {\n      const value = artDisplayValue(substat.value, unit(substat.key))\n      substat.value = parseFloat(\n        allStats.art.subRollCorrection[rarity]?.[substat.key]?.[value] ?? value\n      )\n    }\n\n  return {\n    setKey,\n    rarity,\n    slotKey: slot,\n    mainStatKey,\n    level,\n    substats,\n    location: base.location ?? '',\n    lock: false,\n  }\n}\n","import { Grid, Typography } from '@mui/material'\nimport React from 'react'\nimport { Trans } from 'react-i18next'\nimport CardLight from '../../../Components/Card/CardLight'\nimport InfoTooltip from '../../../Components/InfoTooltip'\nimport PercentBadge from '../../../Components/PercentBadge'\n\nexport default function SubstatEfficiencyDisplayCard({\n  efficiency,\n  max = false,\n  t,\n  valid,\n}) {\n  const eff = max ? 'maxSubEff' : 'curSubEff'\n  return (\n    <CardLight sx={{ py: 1, px: 2 }}>\n      <Grid container spacing={1}>\n        <Grid item>{t(`editor.${eff}`)}</Grid>\n        <Grid item flexGrow={1}>\n          <InfoTooltip\n            title={\n              <span>\n                <Typography variant=\"h6\">{t(`editor.${eff}`)}</Typography>\n                <Typography>\n                  <Trans t={t} i18nKey={`editor.${eff}Desc`} />\n                </Typography>\n              </span>\n            }\n          />\n        </Grid>\n        <Grid item xs=\"auto\">\n          <PercentBadge\n            valid={valid}\n            max={900}\n            value={valid ? efficiency : 'ERR'}\n          />\n        </Grid>\n      </Grid>\n    </CardLight>\n  )\n}\n","import { allSubstatKeys, artSubstatRollData } from '@genshin-optimizer/consts'\nimport type { ISubstat } from '@genshin-optimizer/gi-good'\nimport { allStats } from '@genshin-optimizer/gi-stats'\nimport {\n  artDisplayValue,\n  getSubstatSummedRolls,\n  getSubstatValuesPercent,\n} from '@genshin-optimizer/gi-util'\nimport { clamp } from '@genshin-optimizer/util'\nimport {\n  Box,\n  Button,\n  ButtonGroup,\n  Grid,\n  ListItemIcon,\n  ListItemText,\n  MenuItem,\n  Slider,\n  Typography,\n} from '@mui/material'\nimport { useEffect, useMemo, useState } from 'react'\nimport { Trans, useTranslation } from 'react-i18next'\nimport { ArtifactStatWithUnit } from '../../../Components/Artifact/ArtifactStatKeyDisplay'\nimport CardLight from '../../../Components/Card/CardLight'\nimport CustomNumberInput, {\n  CustomNumberInputButtonGroupWrapper,\n} from '../../../Components/CustomNumberInput'\nimport DropdownButton from '../../../Components/DropdownMenu/DropdownButton'\nimport PercentBadge from '../../../Components/PercentBadge'\nimport SqBadge from '../../../Components/SqBadge'\nimport TextButton from '../../../Components/TextButton'\nimport KeyMap from '../../../KeyMap'\nimport StatIcon from '../../../KeyMap/StatIcon'\nimport type { ICachedArtifact } from '../../../Types/artifact'\nimport type { RollColorKey } from '../../../Types/consts'\n\nexport default function SubstatInput({\n  index,\n  artifact,\n  setSubstat,\n}: {\n  index: number\n  artifact: ICachedArtifact | undefined\n  setSubstat: (index: number, substat: ISubstat) => void\n}) {\n  const { t } = useTranslation('artifact')\n  const { mainStatKey = '', rarity = 5 } = artifact ?? {}\n  const {\n    key = '',\n    value = 0,\n    rolls = [],\n    efficiency = 0,\n  } = artifact?.substats[index] ?? {}\n\n  const accurateValue = rolls.reduce((a, b) => a + b, 0)\n  const unit = KeyMap.unit(key),\n    rollNum = rolls.length\n\n  let error = '',\n    rollData: readonly number[] = [],\n    allowedRolls = 0\n\n  if (artifact) {\n    // Account for the rolls it will need to fill all 4 substates, +1 for its base roll\n    const rarity = artifact.rarity\n    const { numUpgrades, high } = artSubstatRollData[rarity]\n    const maxRollNum = numUpgrades + high - 3\n    allowedRolls = maxRollNum - rollNum\n    rollData = key ? getSubstatValuesPercent(key, rarity) : []\n  }\n  const rollOffset = 7 - rollData.length\n\n  if (!rollNum && key && value) error = error || t`editor.substat.error.noCalc`\n  if (allowedRolls < 0)\n    error =\n      error ||\n      t('editor.substat.error.noOverRoll', { value: allowedRolls + rollNum })\n\n  const marks = useMemo(\n    () =>\n      key\n        ? [\n            { value: 0 },\n            ...getSubstatSummedRolls(rarity, key).map((v) => ({ value: v })),\n          ]\n        : [{ value: 0 }],\n    [key, rarity]\n  )\n\n  return (\n    <CardLight>\n      <Box sx={{ display: 'flex' }}>\n        <ButtonGroup size=\"small\" sx={{ width: '100%', display: 'flex' }}>\n          <DropdownButton\n            startIcon={key ? <StatIcon statKey={key} /> : undefined}\n            title={\n              key ? (\n                <ArtifactStatWithUnit statKey={key} />\n              ) : (\n                t('editor.substat.substatFormat', { value: index + 1 })\n              )\n            }\n            disabled={!artifact}\n            color={key ? 'success' : 'primary'}\n            sx={{ whiteSpace: 'nowrap' }}\n          >\n            {key && (\n              <MenuItem\n                onClick={() => setSubstat(index, { key: '', value: 0 })}\n              >{t`editor.substat.noSubstat`}</MenuItem>\n            )}\n            {allSubstatKeys\n              .filter((key) => mainStatKey !== key)\n              .map((k) => (\n                <MenuItem\n                  key={k}\n                  selected={key === k}\n                  disabled={key === k}\n                  onClick={() => setSubstat(index, { key: k, value: 0 })}\n                >\n                  <ListItemIcon>\n                    <StatIcon statKey={k} />\n                  </ListItemIcon>\n                  <ListItemText>\n                    <ArtifactStatWithUnit statKey={k} />\n                  </ListItemText>\n                </MenuItem>\n              ))}\n          </DropdownButton>\n          <CustomNumberInputButtonGroupWrapper\n            sx={{ flexBasis: 30, flexGrow: 1 }}\n          >\n            <CustomNumberInput\n              float={unit === '%'}\n              placeholder={t`editor.substat.selectSub`}\n              value={key ? value : undefined}\n              onChange={(value) =>\n                setSubstat(index, { key, value: value ?? 0 })\n              }\n              disabled={!key}\n              error={!!error}\n              sx={{\n                px: 1,\n              }}\n              inputProps={{\n                sx: { textAlign: 'right' },\n              }}\n            />\n          </CustomNumberInputButtonGroupWrapper>\n          {!!rollData.length && (\n            <TextButton>{t`editor.substat.nextRolls`}</TextButton>\n          )}\n          {rollData.map((v, i) => {\n            let newValue = artDisplayValue(accurateValue + v, unit)\n            newValue =\n              allStats.art.subRollCorrection[rarity]?.[key]?.[newValue] ??\n              newValue\n            return (\n              <Button\n                key={i}\n                color={`roll${clamp(rollOffset + i, 1, 6)}` as any}\n                disabled={(value && !rollNum) || allowedRolls <= 0}\n                onClick={() =>\n                  setSubstat(index, { key, value: parseFloat(newValue) })\n                }\n              >\n                {newValue}\n              </Button>\n            )\n          })}\n        </ButtonGroup>\n      </Box>\n      <Box px={2}>\n        <SliderWrapper\n          value={value}\n          marks={marks}\n          setValue={(v) =>\n            setSubstat(index, { key, value: (v as number) ?? 0 })\n          }\n          disabled={!key}\n        />\n      </Box>\n      <Box sx={{ px: 1, pb: 1 }}>\n        {error ? (\n          <SqBadge color=\"error\">{t`ui:error`}</SqBadge>\n        ) : (\n          <Grid container>\n            <Grid item>\n              <SqBadge\n                color={\n                  rollNum === 0\n                    ? 'secondary'\n                    : (`roll${clamp(rollNum, 1, 6)}` as RollColorKey)\n                }\n              >\n                {rollNum\n                  ? t('editor.substat.RollCount', { count: rollNum })\n                  : t`editor.substat.noRoll`}\n              </SqBadge>\n            </Grid>\n            <Grid item flexGrow={1}>\n              {!!rolls.length &&\n                [...rolls].sort().map((val, i) => (\n                  <Typography\n                    component=\"span\"\n                    key={`${i}.${val}`}\n                    color={`roll${clamp(\n                      rollOffset + rollData.indexOf(val),\n                      1,\n                      6\n                    )}.main`}\n                    sx={{ ml: 1 }}\n                  >\n                    {artDisplayValue(val, unit)}\n                  </Typography>\n                ))}\n            </Grid>\n            <Grid item xs=\"auto\" flexShrink={1}>\n              <Typography>\n                <Trans\n                  t={t}\n                  i18nKey=\"editor.substat.eff\"\n                  color=\"text.secondary\"\n                >\n                  {'Efficiency: '}\n                  <PercentBadge\n                    valid={true}\n                    max={rollNum * 100}\n                    value={\n                      efficiency\n                        ? efficiency\n                        : (t`editor.substat.noStat` as string)\n                    }\n                  />\n                </Trans>\n              </Typography>\n            </Grid>\n          </Grid>\n        )}\n      </Box>\n    </CardLight>\n  )\n}\nfunction SliderWrapper({\n  value,\n  setValue,\n  marks,\n  disabled = false,\n}: {\n  value: number\n  setValue: (v: number) => void\n  marks: Array<{ value: number }>\n  disabled: boolean\n}) {\n  const [innerValue, setinnerValue] = useState(value)\n  useEffect(() => setinnerValue(value), [value])\n  return (\n    <Slider\n      value={innerValue}\n      step={null}\n      disabled={disabled}\n      marks={marks}\n      min={0}\n      max={marks[marks.length - 1]?.value ?? 0}\n      onChange={(e, v) => setinnerValue(v as number)}\n      onChangeCommitted={(e, v) => setValue(v as number)}\n      valueLabelDisplay=\"auto\"\n    />\n  )\n}\n","import {\n  Alert,\n  Box,\n  CardContent,\n  Divider,\n  Grid,\n  Typography,\n} from '@mui/material'\nimport CardDark from '../../../Components/Card/CardDark'\nimport CloseButton from '../../../Components/CloseButton'\nimport ModalWrapper from '../../../Components/ModalWrapper'\nimport scan_art_main from './imgs/scan_art_main.png'\nimport Snippet from './imgs/snippet.png'\nexport default function UploadExplainationModal({\n  modalShow,\n  hide,\n}: {\n  modalShow: boolean\n  hide: () => void\n}) {\n  return (\n    <ModalWrapper open={modalShow} onClose={hide}>\n      <CardDark>\n        <CardContent sx={{ py: 1 }}>\n          <Grid container>\n            <Grid item flexGrow={1}>\n              <Typography variant=\"subtitle1\">\n                How do Upload Screenshots for parsing\n              </Typography>\n            </Grid>\n            <Grid item>\n              <CloseButton onClick={hide} />\n            </Grid>\n          </Grid>\n        </CardContent>\n        <Divider />\n        <CardContent>\n          <Alert variant=\"outlined\" severity=\"warning\">\n            NOTE: Artifact Scanning currently only works for\n            <strong>ENGLISH</strong> artifacts.\n          </Alert>\n          <Grid container spacing={1} mt={1}>\n            <Grid item xs={8} md={4}>\n              <Box\n                component=\"img\"\n                alt=\"snippet of the screen to take\"\n                src={Snippet}\n                width=\"100%\"\n                height=\"auto\"\n              />\n            </Grid>\n            <Grid item xs={12} md={8}>\n              <Typography gutterBottom>\n                Using screenshots can dramatically decrease the amount of time\n                you manually input in stats on the Genshin Optimizer.\n              </Typography>\n              <Typography variant=\"h5\">\n                Where to snip the screenshot.\n              </Typography>\n              <Typography gutterBottom>\n                In game, Open your bag, and navigate to the artifacts tab.\n                Select the artifact you want to scan with Genshin Optimizer.{' '}\n                <b>Only artifact from this screen can be scanned.</b>\n              </Typography>\n              <Typography variant=\"h6\">Single artifact</Typography>\n              <Typography gutterBottom>\n                To take a screenshot, in Windows, the shortcut is{' '}\n                <strong>Shift + WindowsKey + S</strong>. Once you selected the\n                region, the image is automatically included in your clipboard.\n              </Typography>\n              <Typography variant=\"h6\">Multiple artifacts</Typography>\n              <Typography gutterBottom>\n                To take advantage of batch uploads, you can use a tool like{' '}\n                <a href=\"https://picpick.app/\" target=\"_blank\" rel=\"noreferrer\">\n                  PicPick\n                </a>{' '}\n                to create a macro to easily to screenshot a region to screenshot\n                multiple artifacts at once.\n              </Typography>\n              <Typography variant=\"h5\">\n                What to include in the screenshot.\n              </Typography>\n              <Typography>\n                As shown in the Image, starting from the top with the artifact\n                name, all the way to the set name(the text in green).{' '}\n              </Typography>\n            </Grid>\n            <Grid item xs={12} md={7}>\n              <Typography variant=\"h5\">\n                Adding Screenshot to Genshin Optimizer\n              </Typography>\n              <Typography>\n                At this point, you should have the artifact snippet either saved\n                to your harddrive, or in your clipboard.\n              </Typography>\n              <Typography gutterBottom>\n                You can click on the box next to \"Browse\" to browse the files in\n                your harddrive for multiple screenshots.\n              </Typography>\n              <Typography>\n                For single screenshots from the snippets, just press{' '}\n                <strong>Ctrl + V</strong> to paste from your clipboard.\n              </Typography>\n              <Typography gutterBottom>\n                You should be able to see a Preview of your artifact snippet,\n                and after waiting a few seconds, the artifact set and the\n                substats will be filled in in the <b>Artifact Editor</b>.\n              </Typography>\n              <Typography variant=\"h5\">Finishing the Artifact</Typography>\n              <Typography>\n                Unfortunately, computer vision is not 100%. There will always be\n                cases where something is not scanned properly. You should always\n                double check the scanned artifact values! Once the artifact has\n                been filled, Click on <strong>Add Artifact</strong> to finish\n                editing the artifact.\n              </Typography>\n            </Grid>\n            <Grid item xs={8} md={5}>\n              <Box\n                component=\"img\"\n                alt=\"main screen after importing stats\"\n                src={scan_art_main}\n                width=\"100%\"\n                height=\"auto\"\n              />\n            </Grid>\n          </Grid>\n        </CardContent>\n        <Divider />\n        <CardContent sx={{ py: 1 }}>\n          <CloseButton large onClick={hide} />\n        </CardContent>\n      </CardDark>\n    </ModalWrapper>\n  )\n}\n","import type {\n  ArtifactRarity,\n  ArtifactSetKey,\n  ArtifactSlotKey,\n  MainStatKey,\n  RarityKey,\n  SubstatKey,\n} from '@genshin-optimizer/consts'\nimport {\n  allArtifactRarityKeys,\n  allArtifactSetKeys,\n  allArtifactSlotKeys,\n  allMainStatKeys,\n  allSubstatKeys,\n  artSlotsData,\n} from '@genshin-optimizer/consts'\nimport type { IArtifact, ISubstat } from '@genshin-optimizer/gi-good'\nimport {\n  artDisplayValue,\n  getMainStatDisplayValue,\n  getMainStatDisplayValues,\n  getSubstatRolls,\n} from '@genshin-optimizer/gi-util'\nimport { clamp, hammingDistance, objKeyMap } from '@genshin-optimizer/util'\nimport type { RecognizeResult, Scheduler } from 'tesseract.js'\nimport { createScheduler, createWorker } from 'tesseract.js'\nimport ColorText from '../Components/ColoredText'\nimport { getArtSheet } from '../Data/Artifacts'\nimport KeyMap from '../KeyMap'\nimport type { ICachedArtifact } from '../Types/artifact'\nimport { BorrowManager } from './BorrowManager'\n\nconst starColor = { r: 255, g: 204, b: 50 } //#FFCC32\nconst workerCount = 2\n\nconst schedulers = new BorrowManager(\n  async (language): Promise<Scheduler> => {\n    const scheduler = createScheduler()\n    const promises = Array(workerCount)\n      .fill(0)\n      .map(async (_) => {\n        const worker = await createWorker({\n          errorHandler: console.error,\n        })\n\n        await worker.load()\n        await worker.loadLanguage(language)\n        await worker.initialize(language)\n        scheduler.addWorker(worker)\n      })\n\n    await Promise.any(promises)\n    return scheduler\n  },\n  (_language, value) => {\n    value.then((value) => value.terminate())\n  }\n)\n\nexport type ProcessedEntry = {\n  fileName: string\n  imageURL: string\n  artifact: IArtifact\n  texts: Dict<keyof ICachedArtifact, Displayable>\n}\nexport type OutstandingEntry = {\n  file: File\n  fileName: string\n  imageURL?: Promise<string>\n  result?: Promise<{ file: File; result: ProcessedEntry }>\n}\ntype Queue = { processed: ProcessedEntry[]; outstanding: OutstandingEntry[] }\ntype UploadMessage = { type: 'upload'; files: OutstandingEntry[] }\ntype ProcessingMessage = { type: 'processing' }\ntype ProcessedMessage = {\n  type: 'processed'\n  file: File\n  result: ProcessedEntry\n}\ntype PopMessage = { type: 'pop' }\ntype ClearMessage = { type: 'clear' }\ntype Color = [number, number, number] // RGB\nexport const queueReducer = (\n  queue: Queue,\n  message:\n    | UploadMessage\n    | ProcessingMessage\n    | ProcessedMessage\n    | PopMessage\n    | ClearMessage\n): Queue => {\n  switch (message.type) {\n    case 'upload':\n      return {\n        processed: queue.processed,\n        outstanding: [...queue.outstanding, ...message.files],\n      }\n    case 'processing': // Processing `outstanding` head. Refresh\n      return { processed: queue.processed, outstanding: [...queue.outstanding] }\n    case 'processed':\n      if (queue.outstanding[0].file === message.file)\n        return {\n          processed: [...queue.processed, message.result],\n          outstanding: queue.outstanding.slice(1),\n        }\n      return queue // Not in the list, ignored\n    case 'pop':\n      return {\n        processed: queue.processed.slice(1),\n        outstanding: queue.outstanding,\n      }\n    case 'clear':\n      return { processed: [], outstanding: [] }\n  }\n}\n\nexport function processEntry(entry: OutstandingEntry) {\n  if (entry.result) return\n\n  const { file, fileName } = entry\n  entry.imageURL = fileToURL(file)\n  entry.result = entry.imageURL.then(async (imageURL) => {\n    const ocrResult = await ocr(imageURL)\n\n    const [artifact, texts] = findBestArtifact(\n      ocrResult.rarities,\n      parseSetKeys(ocrResult.artifactSetTexts),\n      parseSlotKeys(ocrResult.whiteTexts),\n      parseSubstats(ocrResult.substatTexts),\n      parseMainStatKeys(ocrResult.whiteTexts),\n      parseMainStatValues(ocrResult.whiteTexts)\n    )\n\n    return { file, result: { fileName, imageURL, artifact, texts } }\n  })\n}\n\nconst fileToURL = (file: File): Promise<string> =>\n  new Promise((resolve) => {\n    const reader = new FileReader()\n    reader.onloadend = ({ target }) => resolve(target!.result as string)\n    reader.readAsDataURL(file)\n  })\nconst urlToImageData = (urlFile: string): Promise<ImageData> =>\n  new Promise((resolve) => {\n    const img = new Image()\n    img.onload = ({ target }) =>\n      resolve(imageToImageData(target as HTMLImageElement))\n    img.src = urlFile\n  })\nfunction imageToImageData(image: HTMLImageElement): ImageData {\n  const canvas = document.createElement('canvas'),\n    context = canvas.getContext('2d')!\n  canvas.width = image.width\n  canvas.height = image.height\n  context.drawImage(image, 0, 0, image.width, image.height)\n  return context.getImageData(0, 0, image.width, image.height) as ImageData // TODO: May be undefined\n}\nfunction imageDataToCanvas(imageData: ImageData) {\n  // create off-screen canvas element\n  const canvas = document.createElement('canvas')\n  canvas.width = imageData.width\n  canvas.height = imageData.height\n\n  // update canvas with new data\n  canvas.getContext('2d')!.putImageData(imageData, 0, 0)\n  return canvas // produces a PNG file\n}\n\nasync function ocr(imageURL: string): Promise<{\n  artifactSetTexts: string[]\n  substatTexts: string[]\n  whiteTexts: string[]\n  rarities: Set<RarityKey>\n}> {\n  const imageData = await urlToImageData(imageURL)\n\n  const width = imageData.width,\n    halfHeight = Math.floor(imageData.height / 2)\n  const bottomOpts = {\n    rectangle: { top: halfHeight, left: 0, width, height: halfHeight },\n  }\n\n  const awaits = [\n    textsFromImage(\n      bandPass(imageData, [140, 140, 140], [255, 255, 255], {\n        mode: 'bw',\n        region: 'top',\n      })\n    ), // slotkey, mainStatValue, level\n    textsFromImage(\n      bandPass(imageData, [30, 50, 80], [160, 160, 160], { region: 'bot' }),\n      bottomOpts\n    ), // substats\n    textsFromImage(\n      bandPass(imageData, [30, 160, 30], [200, 255, 200], {\n        mode: 'bw',\n        region: 'bot',\n      }),\n      bottomOpts\n    ), // artifact set, look for greenish texts\n  ]\n\n  const rarities = parseRarities(\n    imageData.data,\n    imageData.width,\n    imageData.height\n  )\n  const [whiteTexts, substatTexts, artifactSetTexts] = await Promise.all(awaits)\n  return { whiteTexts, substatTexts, artifactSetTexts, rarities }\n}\nasync function textsFromImage(\n  imageData: ImageData,\n  options: object | undefined = undefined\n): Promise<string[]> {\n  const canvas = imageDataToCanvas(imageData)\n  const rec = await schedulers.borrow(\n    'eng',\n    async (scheduler) =>\n      (await (\n        await scheduler\n      ).addJob('recognize', canvas, options)) as RecognizeResult\n  )\n  return rec.data.lines.map((line) => line.text)\n}\n\nexport function findBestArtifact(\n  rarities: Set<number>,\n  textSetKeys: Set<ArtifactSetKey>,\n  slotKeys: Set<ArtifactSlotKey>,\n  substats: ISubstat[],\n  mainStatKeys: Set<MainStatKey>,\n  mainStatValues: { mainStatValue: number; unit?: string }[]\n): [IArtifact, Dict<keyof ICachedArtifact, Displayable>] {\n  // const relevantSetKey = [...new Set<ArtifactSetKey>([...textSetKeys, \"Adventurer\", \"ArchaicPetra\"])]\n  // TODO: restore\n  const relevantSetKey = [\n    ...new Set<ArtifactSetKey>([...textSetKeys, 'EmblemOfSeveredFate']),\n  ]\n\n  let bestScore = -1,\n    bestArtifacts: IArtifact[] = [\n      {\n        // setKey: \"Adventurer\", rarity: 3, level: 0, slotKey: \"flower\", mainStatKey: \"hp\", substats: [],\n        // TODO: restore\n        setKey: 'EmblemOfSeveredFate',\n        rarity: 3,\n        level: 0,\n        slotKey: 'flower',\n        mainStatKey: 'hp',\n        substats: [],\n        location: '',\n        lock: false,\n      },\n    ]\n\n  // Rate each rarity\n  const rarityRates = objKeyMap(allArtifactRarityKeys, (rarity) => {\n    let score = 0\n    if (textSetKeys.size) {\n      const count = [...textSetKeys].reduce(\n        (count, set) =>\n          count + (getArtSheet(set).rarity.includes(rarity) ? 1 : 0),\n        0\n      )\n      score += count / textSetKeys.size\n    }\n    if (substats.length) {\n      const count = substats.reduce(\n        (count, substat) =>\n          count +\n          (getSubstatRolls(substat.key as SubstatKey, substat.value, rarity)\n            .length\n            ? 1\n            : 0),\n        0\n      )\n      score += (count / substats.length) * 2\n    }\n    return score\n  })\n\n  // Test all *probable* combinations\n  for (const slotKey of allArtifactSlotKeys) {\n    for (const mainStatKey of artSlotsData[slotKey].stats) {\n      const mainStatScore =\n        (slotKeys.has(slotKey) ? 1 : 0) +\n        (mainStatKeys.has(mainStatKey) ? 1 : 0)\n      const relevantMainStatValues = mainStatValues\n        .filter(\n          (value) => value.unit !== '%' || KeyMap.unit(mainStatKey) === '%'\n        ) // Ignore \"%\" text if key isn't \"%\"\n        .map((value) => value.mainStatValue)\n\n      for (const [rarityString, rarityIndividualScore] of Object.entries(\n        rarityRates\n      )) {\n        const rarity = parseInt(rarityString) as ArtifactRarity\n        const setKeys = relevantSetKey.filter((setKey) =>\n          getArtSheet(setKey).rarity.includes(rarity)\n        )\n        const rarityScore = mainStatScore + rarityIndividualScore\n\n        if (rarityScore + 2 < bestScore) continue // Early bail out\n\n        for (const minimumMainStatValue of relevantMainStatValues) {\n          const values = getMainStatDisplayValues(rarity, mainStatKey)\n          const level = Math.max(\n            0,\n            values.findIndex((level) => level >= minimumMainStatValue)\n          )\n          const mainStatVal = values[level]\n          const mainStatValScore =\n            rarityScore + (mainStatVal === minimumMainStatValue ? 1 : 0)\n\n          for (const setKey of setKeys) {\n            const score = mainStatValScore + (textSetKeys.has(setKey) ? 1 : 0)\n            if (score >= bestScore) {\n              if (score > bestScore) bestArtifacts = []\n              bestScore = score\n              bestArtifacts.push({\n                setKey,\n                rarity,\n                level,\n                slotKey,\n                mainStatKey,\n                substats: [],\n                location: '',\n                lock: false,\n              })\n            }\n          }\n        }\n        if (rarityScore >= bestScore) {\n          const level = 0\n          for (const setKey of setKeys) {\n            const score = rarityScore + (textSetKeys.has(setKey) ? 1 : 0)\n\n            if (score > bestScore) bestArtifacts = []\n            bestScore = score\n            bestArtifacts.push({\n              setKey,\n              rarity,\n              level,\n              slotKey,\n              mainStatKey,\n              substats: [],\n              location: '',\n              lock: false,\n            })\n          }\n        }\n      }\n    }\n  }\n\n  const texts = {} as Dict<keyof ICachedArtifact, Displayable>\n  const chosen = {\n    setKey: new Set(),\n    rarity: new Set(),\n    level: new Set(),\n    slotKey: new Set(),\n    mainStatKey: new Set(),\n    mainStatVal: new Set(),\n  } as Dict<keyof ICachedArtifact, Set<string>>\n\n  const result = bestArtifacts[0],\n    resultMainStatVal = getMainStatDisplayValue(\n      result.mainStatKey,\n      result.rarity,\n      result.level\n    )!\n  result.substats = substats.filter(\n    (substat, i) =>\n      substat.key !== result.mainStatKey &&\n      substats.slice(0, i).every((other) => other.key !== substat.key)\n  )\n  for (let i = result.substats.length; i < 4; i++)\n    result.substats.push({ key: '', value: 0 })\n\n  for (const other of bestArtifacts) {\n    chosen.setKey!.add(other.setKey)\n    chosen.rarity!.add(other.rarity as any)\n    chosen.level!.add(other.level as any)\n    chosen.slotKey!.add(other.slotKey)\n    chosen.mainStatKey!.add(other.mainStatKey)\n  }\n\n  function unknownText<T>(\n    value: T,\n    name: Displayable,\n    text: (arg: T) => Displayable\n  ) {\n    return (\n      <>\n        Unknown {name} : Set to{' '}\n        <ColorText color=\"error\">{text(value)}</ColorText>\n      </>\n    )\n  }\n  function ambiguousText<T>(\n    value: T,\n    available: T[],\n    name: Displayable,\n    text: (arg: T) => Displayable\n  ) {\n    return (\n      <>\n        Ambiguous {name} <ColorText color=\"error\">{text(value)}</ColorText> :\n        May also be{' '}\n        {available\n          .filter((v) => v !== value)\n          .map((value, index) => (\n            <>\n              <b>{index > 0 ? '/' : ''}</b>\n              <ColorText color=\"warning\">{text(value)}</ColorText>\n            </>\n          ))}\n      </>\n    )\n  }\n  function detectedText<T>(\n    value: T,\n    name: Displayable,\n    text: (arg: T) => Displayable\n  ) {\n    return (\n      <>\n        Detected {name} <ColorText color=\"success\">{text(value)}</ColorText>\n      </>\n    )\n  }\n  function inferredText<T>(\n    value: T,\n    name: Displayable,\n    text: (arg: T) => Displayable\n  ) {\n    return (\n      <>\n        Inferred {name} <ColorText color=\"warning\">{text(value)}</ColorText>\n      </>\n    )\n  }\n\n  function addText(\n    key: keyof ICachedArtifact,\n    available: Set<any>,\n    name: Displayable,\n    text: (value) => Displayable\n  ) {\n    const recommended = new Set(\n      [...chosen[key]!].filter((value) => available.has(value))\n    )\n    if (recommended.size > 1)\n      texts[key] = ambiguousText(result[key], [...available], name, text)\n    else if (recommended.size === 1)\n      texts[key] = detectedText(result[key], name, text)\n    else if (chosen[key]!.size > 1)\n      texts[key] = unknownText(result[key], name, text)\n    else texts[key] = inferredText(result[key], name, text)\n  }\n\n  addText('setKey', textSetKeys, 'Set', (value) => getArtSheet(value).name)\n  addText('rarity', rarities, 'Rarity', (value) => (\n    <>\n      {value} {value !== 1 ? 'Stars' : 'Star'}\n    </>\n  ))\n  addText(\n    'slotKey',\n    slotKeys,\n    'Slot',\n    (value: ArtifactSlotKey) => artSlotsData[value].name\n  )\n  addText('mainStatKey', mainStatKeys, 'Main Stat', (value) => (\n    <>{KeyMap.getStr(value)}</>\n  ))\n  texts.substats = (\n    <>\n      {result.substats\n        .filter((substat) => substat.key !== '')\n        .map((substat, i) => (\n          <div key={i}>\n            {detectedText(substat, 'Sub Stat', (value) => (\n              <>\n                {KeyMap.getStr(value.key)}+\n                {artDisplayValue(value.value, KeyMap.unit(value.key))}\n                {KeyMap.unit(value.key)}\n              </>\n            ))}\n          </div>\n        ))}\n    </>\n  )\n\n  const valueStrFunc = (value) => (\n    <>\n      {artDisplayValue(value, KeyMap.unit(result.mainStatKey))}\n      {KeyMap.unit(result.mainStatKey)}\n    </>\n  )\n  if (\n    mainStatValues.find((value) => value.mainStatValue === resultMainStatVal)\n  ) {\n    if (mainStatKeys.has(result.mainStatKey)) {\n      texts.level = detectedText(result.level, 'Level', (value) => '+' + value)\n      texts.mainStatVal = detectedText(\n        resultMainStatVal,\n        'Main Stat value',\n        valueStrFunc\n      )\n    } else {\n      texts.level = inferredText(result.level, 'Level', (value) => '+' + value)\n      texts.mainStatVal = inferredText(\n        resultMainStatVal,\n        'Main Stat value',\n        valueStrFunc\n      )\n    }\n  } else {\n    texts.level = unknownText(result.level, 'Level', (value) => '+' + value)\n    texts.mainStatVal = unknownText(\n      resultMainStatVal,\n      'Main Stat value',\n      valueStrFunc\n    )\n  }\n\n  return [result, texts]\n}\n\nfunction parseSetKeys(texts: string[]): Set<ArtifactSetKey> {\n  const results = new Set<ArtifactSetKey>([])\n  for (const text of texts)\n    for (const key of allArtifactSetKeys)\n      if (\n        hammingDistance(\n          text.replace(/\\W/g, ''),\n          getArtSheet(key).nameRaw.replace(/\\W/g, '')\n        ) <= 2\n      )\n        results.add(key)\n  return results\n}\nfunction parseRarities(\n  pixels: Uint8ClampedArray,\n  width: number,\n  height: number\n): Set<RarityKey> {\n  const d = pixels\n  let lastRowNum = 0,\n    rowsWithNumber = 0\n  const results = new Set<RarityKey>([])\n  for (let y = 0; y < height; y++) {\n    let star = 0,\n      onStar = false\n    for (let x = 0; x < width; x++) {\n      const i = (y * width + x) * 4\n      const r = d[i],\n        g = d[i + 1],\n        b = d[i + 2]\n      if (colorCloseEnough({ r, g, b }, starColor)) {\n        if (!onStar) {\n          onStar = true\n          star++\n        }\n      } else {\n        onStar = false\n      }\n    }\n\n    if (lastRowNum !== star) {\n      lastRowNum = star\n      rowsWithNumber = 1\n    } else if (lastRowNum) {\n      rowsWithNumber++\n      if (rowsWithNumber >= 10)\n        results.add(clamp(lastRowNum, 3, 5) as RarityKey)\n    }\n  }\n  return results\n}\nfunction colorCloseEnough(color1, color2, threshold = 5) {\n  const intCloseEnough = (a, b) => Math.abs(a - b) <= threshold\n  return (\n    intCloseEnough(color1.r, color2.r) &&\n    intCloseEnough(color1.g, color2.g) &&\n    intCloseEnough(color1.b, color2.b)\n  )\n}\nfunction parseSlotKeys(texts: string[]): Set<ArtifactSlotKey> {\n  const results = new Set<ArtifactSlotKey>()\n  for (const text of texts)\n    for (const key of allArtifactSlotKeys)\n      if (\n        hammingDistance(\n          text.replace(/\\W/g, ''),\n          artSlotsData[key].name.replace(/\\W/g, '')\n        ) <= 2\n      )\n        results.add(key)\n  return results\n}\nfunction parseMainStatKeys(texts: string[]): Set<MainStatKey> {\n  const results = new Set<MainStatKey>([])\n  for (const text of texts)\n    for (const key of allMainStatKeys) {\n      if (text.toLowerCase().includes(KeyMap.getStr(key)?.toLowerCase() ?? ''))\n        results.add(key)\n      //use fuzzy compare on the ... Bonus texts. heal_ is included.\n      if (\n        key.includes('_bonu') &&\n        hammingDistance(\n          text.replace(/\\W/g, ''),\n          (KeyMap.getStr(key) ?? '').replace(/\\W/g, '')\n        ) <= 1\n      )\n        results.add(key)\n    }\n  return results\n}\nfunction parseMainStatValues(\n  texts: string[]\n): { mainStatValue: number; unit?: string }[] {\n  const results: { mainStatValue: number; unit?: string }[] = []\n  for (const text of texts) {\n    let regex = /(\\d+[,|\\\\.]+\\d)%/\n    let match = regex.exec(text)\n    if (match)\n      results.push({\n        mainStatValue: parseFloat(\n          match[1].replace(/,/g, '.').replace(/\\.{2,}/g, '.')\n        ),\n        unit: '%',\n      })\n    regex = /(\\d+[,|\\\\.]\\d{3}|\\d{2,3})/\n    match = regex.exec(text)\n    if (match)\n      results.push({\n        mainStatValue: parseInt(match[1].replace(/[,|\\\\.]+/g, '')),\n      })\n  }\n  return results\n}\nfunction parseSubstats(texts: string[]): ISubstat[] {\n  const matches: ISubstat[] = []\n  for (let text of texts) {\n    text = text.replace(/^[\\W]+/, '').replace(/\\n/, '')\n    //parse substats\n    allSubstatKeys.forEach((key) => {\n      const name = KeyMap.getStr(key)\n      const regex =\n        KeyMap.unit(key) === '%'\n          ? new RegExp(name + '\\\\s*\\\\+\\\\s*(\\\\d+[\\\\.|,]+\\\\d)%', 'im')\n          : new RegExp(name + '\\\\s*\\\\+\\\\s*(\\\\d+,\\\\d+|\\\\d+)($|\\\\s)', 'im')\n      const match = regex.exec(text)\n      if (match)\n        matches.push({\n          key,\n          value: parseFloat(\n            match[1].replace(/,/g, '.').replace(/\\.{2,}/g, '.')\n          ),\n        })\n    })\n  }\n  return matches.slice(0, 4)\n}\n\nfunction bandPass(\n  pixelData: ImageData,\n  color1: Color,\n  color2: Color,\n  options: { region?: 'top' | 'bot' | 'all'; mode?: 'bw' | 'color' | 'invert' }\n) {\n  const { region = 'all', mode = 'color' } = options\n  const d = Uint8ClampedArray.from(pixelData.data)\n  const top = region === 'top',\n    bot = region === 'bot',\n    all = region === 'all'\n  const bw = mode === 'bw',\n    invert = mode === 'invert'\n  const halfInd = Math.floor(pixelData.width * (pixelData.height / 2) * 4)\n  for (let i = 0; i < d.length; i += 4) {\n    const r = d[i],\n      g = d[i + 1],\n      b = d[i + 2]\n    if (\n      (all || (top && i < halfInd) || (bot && i > halfInd)) &&\n      r >= color1[0] &&\n      r <= color2[0] &&\n      g >= color1[1] &&\n      g <= color2[1] &&\n      b >= color1[2] &&\n      b <= color2[2]\n    ) {\n      if (bw) d[i] = d[i + 1] = d[i + 2] = 0\n      else if (invert) {\n        d[i] = 255 - r\n        d[i + 1] = 255 - g\n        d[i + 2] = 255 - b\n      } // else orignal color\n    } else {\n      d[i] = d[i + 1] = d[i + 2] = 255\n    }\n  }\n  return new ImageData(d, pixelData.width, pixelData.height)\n}\n","export class BorrowManager<T> {\n  data: Dict<string, { value: T; refCount: number }> = {}\n  init: (key: string) => T\n  deinit: (key: string, value: T) => void\n\n  constructor(\n    init: (key: string) => T,\n    deinit: (key: string, value: T) => void\n  ) {\n    this.init = init\n    this.deinit = deinit\n  }\n\n  /**\n   * Borrow the object corresponding to `key`, creating the object as necessary.\n   * The borrowing ends when `callback`'s promise is fulfilled.\n   * When the last borrowing ends, `deinit` the object.\n   *\n   * Do not use `arg` after the `callback`'s promise is fulfilled.\n   */\n  async borrow<R>(key: string, callback: (arg: T) => Promise<R>): Promise<R> {\n    if (!this.data[key]) {\n      this.data[key] = { value: this.init(key), refCount: 0 }\n    }\n\n    const box = this.data[key]!\n    box.refCount += 1\n    const result = await callback(box.value)\n    box.refCount -= 1\n    if (!box.refCount) {\n      // Last user. Cleaning up\n      delete this.data[key]\n      this.deinit(key, box.value)\n    }\n    return result\n  }\n}\n","import type {\n  ArtifactRarity,\n  ArtifactSetKey,\n  ArtifactSlotKey,\n  MainStatKey,\n} from '@genshin-optimizer/consts'\nimport {\n  allElementWithPhyKeys,\n  allSubstatKeys,\n  artSlotsData,\n} from '@genshin-optimizer/consts'\nimport { artifactAsset } from '@genshin-optimizer/gi-assets'\nimport type { IArtifact, ISubstat } from '@genshin-optimizer/gi-good'\nimport { getMainStatDisplayStr } from '@genshin-optimizer/gi-util'\nimport { useForceUpdate, usePromise } from '@genshin-optimizer/react-util'\nimport { clamp } from '@genshin-optimizer/util'\nimport {\n  Add,\n  ChevronRight,\n  PhotoCamera,\n  Replay,\n  Shuffle,\n  Update,\n} from '@mui/icons-material'\nimport HelpIcon from '@mui/icons-material/Help'\nimport {\n  Alert,\n  Box,\n  Button,\n  ButtonGroup,\n  CardContent,\n  CardHeader,\n  CircularProgress,\n  Grid,\n  MenuItem,\n  Skeleton,\n  styled,\n  Typography,\n  useMediaQuery,\n  useTheme,\n} from '@mui/material'\nimport type { ChangeEvent } from 'react'\nimport {\n  Suspense,\n  useCallback,\n  useContext,\n  useEffect,\n  useMemo,\n  useReducer,\n  useState,\n} from 'react'\nimport { Trans, useTranslation } from 'react-i18next'\nimport ArtifactRarityDropdown from '../Components/Artifact/ArtifactRarityDropdown'\nimport ArtifactSetAutocomplete from '../Components/Artifact/ArtifactSetAutocomplete'\nimport ArtifactSlotDropdown from '../Components/Artifact/ArtifactSlotDropdown'\nimport {\n  ArtifactColoredIconStatWithUnit,\n  ArtifactStatWithUnit,\n} from '../Components/Artifact/ArtifactStatKeyDisplay'\nimport CardDark from '../Components/Card/CardDark'\nimport CardLight from '../Components/Card/CardLight'\nimport CloseButton from '../Components/CloseButton'\nimport CustomNumberTextField from '../Components/CustomNumberTextField'\nimport DropdownButton from '../Components/DropdownMenu/DropdownButton'\nimport ImgIcon from '../Components/Image/ImgIcon'\nimport ModalWrapper from '../Components/ModalWrapper'\nimport { getArtSheet } from '../Data/Artifacts'\nimport Artifact from '../Data/Artifacts/Artifact'\nimport { DatabaseContext } from '../Database/Database'\nimport {\n  cachedArtifact,\n  validateArtifact,\n} from '../Database/DataManagers/ArtifactData'\nimport StatIcon from '../KeyMap/StatIcon'\nimport type { ICachedArtifact } from '../Types/artifact'\nimport { randomizeArtifact } from '@genshin-optimizer/gi-good'\nimport ArtifactCard from './ArtifactCard'\nimport SubstatEfficiencyDisplayCard from './ArtifactEditor/Components/SubstatEfficiencyDisplayCard'\nimport SubstatInput from './ArtifactEditor/Components/SubstatInput'\nimport UploadExplainationModal from './ArtifactEditor/Components/UploadExplainationModal'\nimport type { OutstandingEntry, ProcessedEntry } from './ScanningUtil'\nimport { processEntry, queueReducer } from './ScanningUtil'\n\nconst maxProcessingCount = 3,\n  maxProcessedCount = 16\nconst allSubstatFilter = new Set(allSubstatKeys)\ntype ResetMessage = { type: 'reset' }\ntype SubstatMessage = { type: 'substat'; index: number; substat: ISubstat }\ntype OverwriteMessage = { type: 'overwrite'; artifact: IArtifact }\ntype UpdateMessage = { type: 'update'; artifact: Partial<IArtifact> }\ntype Message = ResetMessage | SubstatMessage | OverwriteMessage | UpdateMessage\ninterface IEditorArtifact {\n  setKey: ArtifactSetKey\n  slotKey: ArtifactSlotKey\n  level: number\n  rarity: ArtifactRarity\n  mainStatKey: MainStatKey\n  substats: ISubstat[]\n}\nfunction artifactReducer(\n  state: IEditorArtifact | undefined,\n  action: Message\n): IEditorArtifact | undefined {\n  switch (action.type) {\n    case 'reset':\n      return\n    case 'substat': {\n      const { index, substat } = action\n      const oldIndex = substat.key\n        ? state!.substats.findIndex((current) => current.key === substat.key)\n        : -1\n      if (oldIndex === -1 || oldIndex === index)\n        state!.substats[index] = substat\n      // Already in used, swap the items instead\n      else\n        [state!.substats[index], state!.substats[oldIndex]] = [\n          state!.substats[oldIndex],\n          state!.substats[index],\n        ]\n      return { ...state! }\n    }\n    case 'overwrite':\n      return action.artifact\n    case 'update':\n      return { ...state!, ...action.artifact }\n  }\n}\n\nconst InputInvis = styled('input')({\n  display: 'none',\n})\nexport type ArtifactEditorProps = {\n  artifactIdToEdit?: string\n  cancelEdit: () => void\n  allowUpload?: boolean\n  allowEmpty?: boolean\n  disableSet?: boolean\n  disableSlot?: boolean\n}\nexport default function ArtifactEditor({\n  artifactIdToEdit = '',\n  cancelEdit,\n  allowUpload = false,\n  allowEmpty = false,\n  disableSet = false,\n  disableSlot = false,\n}: ArtifactEditorProps) {\n  const { t } = useTranslation('artifact')\n\n  const { database } = useContext(DatabaseContext)\n\n  const [show, setShow] = useState(false)\n\n  const [dirtyDatabase, setDirtyDatabase] = useForceUpdate()\n  useEffect(\n    () => database.arts.followAny(setDirtyDatabase),\n    [database, setDirtyDatabase]\n  )\n\n  const [editorArtifact, artifactDispatch] = useReducer(\n    artifactReducer,\n    undefined\n  )\n  const artifact = useMemo(\n    () => editorArtifact && validateArtifact(editorArtifact, true),\n    [editorArtifact]\n  )\n\n  const [modalShow, setModalShow] = useState(false)\n\n  const [{ processed, outstanding }, dispatchQueue] = useReducer(queueReducer, {\n    processed: [],\n    outstanding: [],\n  })\n  const firstProcessed = processed[0] as ProcessedEntry | undefined\n  const firstOutstanding = outstanding[0] as OutstandingEntry | undefined\n\n  const processingImageURL = usePromise(\n    () => firstOutstanding?.imageURL,\n    [firstOutstanding?.imageURL]\n  )\n  const processingResult = usePromise(\n    () => firstOutstanding?.result,\n    [firstOutstanding?.result]\n  )\n\n  const remaining = processed.length + outstanding.length\n\n  const image = firstProcessed?.imageURL ?? processingImageURL\n  const { artifact: artifactProcessed, texts } = firstProcessed ?? {}\n  // const fileName = firstProcessed?.fileName ?? firstOutstanding?.fileName ?? \"Click here to upload Artifact screenshot files\"\n\n  const disableEditSlot = !!artifact?.location || disableSlot\n\n  useEffect(() => {\n    if (!artifact && artifactProcessed)\n      artifactDispatch({ type: 'overwrite', artifact: artifactProcessed })\n  }, [artifact, artifactProcessed, artifactDispatch])\n\n  useEffect(() => {\n    const numProcessing = Math.min(\n      maxProcessedCount - processed.length,\n      maxProcessingCount,\n      outstanding.length\n    )\n    const processingCurrent = numProcessing && !outstanding[0].result\n    outstanding.slice(0, numProcessing).forEach(processEntry)\n    if (processingCurrent) dispatchQueue({ type: 'processing' })\n  }, [processed.length, outstanding])\n\n  useEffect(() => {\n    if (processingResult)\n      dispatchQueue({ type: 'processed', ...processingResult })\n  }, [processingResult, dispatchQueue])\n\n  const uploadFiles = useCallback(\n    (files?: FileList | null) => {\n      if (!files) return\n      setShow(true)\n      dispatchQueue({\n        type: 'upload',\n        files: Array.from(files).map((file) => ({ file, fileName: file.name })),\n      })\n    },\n    [dispatchQueue, setShow]\n  )\n  const clearQueue = useCallback(\n    () => dispatchQueue({ type: 'clear' }),\n    [dispatchQueue]\n  )\n\n  useEffect(() => {\n    const pasteFunc = (e: Event) =>\n      uploadFiles((e as ClipboardEvent).clipboardData?.files)\n    allowUpload && window.addEventListener('paste', pasteFunc)\n    return () => {\n      if (allowUpload) window.removeEventListener('paste', pasteFunc)\n    }\n  }, [uploadFiles, allowUpload])\n\n  const onUpload = useCallback(\n    (e: ChangeEvent<HTMLInputElement>) => {\n      if (!e.target) return\n      uploadFiles(e.target.files)\n      e.target.value = '' // reset the value so the same file can be uploaded again...\n    },\n    [uploadFiles]\n  )\n\n  const {\n    old,\n    oldType,\n  }: {\n    old: ICachedArtifact | undefined\n    oldType: 'edit' | 'duplicate' | 'upgrade' | ''\n  } = useMemo(() => {\n    const databaseArtifact =\n      dirtyDatabase && artifactIdToEdit && database.arts.get(artifactIdToEdit)\n    if (databaseArtifact) return { old: databaseArtifact, oldType: 'edit' }\n    if (artifact === undefined) return { old: undefined, oldType: '' }\n    const { duplicated, upgraded } =\n      dirtyDatabase && database.arts.findDups(artifact)\n    return {\n      old: duplicated[0] ?? upgraded[0],\n      oldType: duplicated.length !== 0 ? 'duplicate' : 'upgrade',\n    }\n  }, [artifact, artifactIdToEdit, database, dirtyDatabase])\n\n  const { artifact: cArtifact, errors } = useMemo(() => {\n    if (!artifact) return { artifact: undefined, errors: [] as Displayable[] }\n    const validated = cachedArtifact(artifact, artifactIdToEdit)\n    if (old) validated.artifact.location = old.location\n    return validated\n  }, [artifact, artifactIdToEdit, old])\n\n  // Overwriting using a different function from `databaseArtifact` because `useMemo` does not\n  // guarantee to trigger *only when* dependencies change, which is necessary in this case.\n  useEffect(() => {\n    if (artifactIdToEdit === 'new') {\n      setShow(true)\n      artifactDispatch({ type: 'reset' })\n    }\n    const databaseArtifact =\n      artifactIdToEdit && dirtyDatabase && database.arts.get(artifactIdToEdit)\n    if (databaseArtifact) {\n      setShow(true)\n      artifactDispatch({\n        type: 'overwrite',\n        artifact: structuredClone(databaseArtifact),\n      })\n    }\n  }, [artifactIdToEdit, database, dirtyDatabase])\n\n  const sheet = artifact ? getArtSheet(artifact.setKey) : undefined\n  const reset = useCallback(() => {\n    cancelEdit?.()\n    dispatchQueue({ type: 'pop' })\n    artifactDispatch({ type: 'reset' })\n  }, [cancelEdit, artifactDispatch])\n  const update = useCallback(\n    (newValue: Partial<IArtifact>) => {\n      const newSheet = newValue.setKey ? getArtSheet(newValue.setKey) : sheet!\n\n      function pick<T>(\n        value: T | undefined,\n        available: readonly T[],\n        prefer?: T\n      ): T {\n        return value && available.includes(value)\n          ? value\n          : prefer ?? available[0]\n      }\n\n      if (newValue.setKey) {\n        newValue.rarity = pick(\n          artifact?.rarity,\n          newSheet.rarity,\n          Math.max(...newSheet.rarity) as ArtifactRarity\n        )\n        newValue.slotKey = pick(artifact?.slotKey, newSheet.slots)\n      }\n      if (newValue.rarity) newValue.level = artifact?.level ?? 0\n      if (newValue.level)\n        newValue.level = clamp(\n          newValue.level,\n          0,\n          4 * (newValue.rarity ?? artifact!.rarity)\n        )\n      if (newValue.slotKey)\n        newValue.mainStatKey = pick(\n          artifact?.mainStatKey,\n          artSlotsData[newValue.slotKey].stats\n        )\n\n      if (newValue.mainStatKey) {\n        newValue.substats = [0, 1, 2, 3].map((i) =>\n          artifact && artifact.substats[i].key !== newValue.mainStatKey\n            ? artifact!.substats[i]\n            : { key: '', value: 0 }\n        )\n      }\n      artifactDispatch({ type: 'update', artifact: newValue })\n    },\n    [artifact, sheet, artifactDispatch]\n  )\n  const setSubstat = useCallback(\n    (index: number, substat: ISubstat) => {\n      artifactDispatch({ type: 'substat', index, substat })\n    },\n    [artifactDispatch]\n  )\n  const isValid = !errors.length\n  const canClearArtifact = (): boolean =>\n    window.confirm(t`editor.clearPrompt` as string)\n  const { rarity = 5, level = 0, slotKey = 'flower' } = artifact ?? {}\n  const { currentEfficiency = 0, maxEfficiency = 0 } = cArtifact\n    ? Artifact.getArtifactEfficiency(cArtifact, allSubstatFilter)\n    : {}\n  const preventClosing = processed.length || outstanding.length\n  const onClose = useCallback(\n    (e) => {\n      if (preventClosing) e.preventDefault()\n      setShow(false)\n      cancelEdit()\n    },\n    [preventClosing, setShow, cancelEdit]\n  )\n\n  const theme = useTheme()\n  const grmd = useMediaQuery(theme.breakpoints.up('md'))\n\n  const element = artifact\n    ? allElementWithPhyKeys.find((ele) => artifact.mainStatKey.includes(ele))\n    : undefined\n  const color = artifact ? element ?? 'success' : 'primary'\n\n  const updateSetKey = useCallback(\n    (setKey: ArtifactSetKey | '') =>\n      update({ setKey: setKey as ArtifactSetKey }),\n    [update]\n  )\n  const setACDisable = useCallback(\n    (key: ArtifactSetKey | '') => {\n      if (key === '') return true\n      //Disable being able to select any of the prayer set unless the current slotkey is circlet\n      if (\n        disableEditSlot &&\n        slotKey !== 'circlet' &&\n        (key === 'PrayersForDestiny' ||\n          key === 'PrayersForIllumination' ||\n          key === 'PrayersForWisdom' ||\n          key === 'PrayersToSpringtime')\n      )\n        return true\n      return false\n    },\n    [disableEditSlot, slotKey]\n  )\n\n  return (\n    <ModalWrapper open={show} onClose={onClose}>\n      <Suspense\n        fallback={\n          <Skeleton\n            variant=\"rectangular\"\n            sx={{ width: '100%', height: show ? '100%' : 64 }}\n          />\n        }\n      >\n        <CardDark>\n          <UploadExplainationModal\n            modalShow={modalShow}\n            hide={() => setModalShow(false)}\n          />\n          <CardHeader\n            title={\n              <Trans t={t} i18nKey=\"editor.title\">\n                Artifact Editor\n              </Trans>\n            }\n            action={\n              <CloseButton disabled={!!preventClosing} onClick={onClose} />\n            }\n          />\n          <CardContent\n            sx={{ display: 'flex', flexDirection: 'column', gap: 1 }}\n          >\n            <Grid container spacing={1} columns={{ xs: 1, md: 2 }}>\n              {/* Left column */}\n              <Grid item xs={1} display=\"flex\" flexDirection=\"column\" gap={1}>\n                {/* set & rarity */}\n                <Box sx={{ display: 'flex', gap: 1 }}>\n                  {/* Artifact Set */}\n                  <ArtifactSetAutocomplete\n                    disabled={disableSet}\n                    size=\"small\"\n                    artSetKey={artifact?.setKey ?? ''}\n                    setArtSetKey={updateSetKey}\n                    sx={{ flexGrow: 1 }}\n                    label={artifact?.setKey ? '' : t('editor.unknownSetName')}\n                    getOptionDisabled={({ key }) => setACDisable(key)}\n                  />\n                  {/* rarity dropdown */}\n                  <ArtifactRarityDropdown\n                    rarity={artifact ? rarity : undefined}\n                    onChange={(r) => update({ rarity: r })}\n                    filter={(r) => !!sheet?.rarity?.includes?.(r)}\n                    disabled={!sheet}\n                  />\n                </Box>\n\n                {/* level */}\n                <Box component=\"div\" display=\"flex\">\n                  <CustomNumberTextField\n                    id=\"filled-basic\"\n                    label=\"Level\"\n                    variant=\"filled\"\n                    sx={{ flexShrink: 1, flexGrow: 1, mr: 1, my: 0 }}\n                    margin=\"dense\"\n                    size=\"small\"\n                    value={level}\n                    disabled={!sheet}\n                    placeholder={`0~${rarity * 4}`}\n                    onChange={(l) => update({ level: l })}\n                  />\n                  <ButtonGroup>\n                    <Button\n                      onClick={() => update({ level: level - 1 })}\n                      disabled={!sheet || level === 0}\n                    >\n                      -\n                    </Button>\n                    {rarity\n                      ? [...Array(rarity + 1).keys()]\n                          .map((i) => 4 * i)\n                          .map((i) => (\n                            <Button\n                              key={i}\n                              onClick={() => update({ level: i })}\n                              disabled={!sheet || level === i}\n                            >\n                              {i}\n                            </Button>\n                          ))\n                      : null}\n                    <Button\n                      onClick={() => update({ level: level + 1 })}\n                      disabled={!sheet || level === rarity * 4}\n                    >\n                      +\n                    </Button>\n                  </ButtonGroup>\n                </Box>\n\n                {/* slot */}\n                <Box component=\"div\" display=\"flex\">\n                  <ArtifactSlotDropdown\n                    disabled={disableEditSlot || !sheet}\n                    slotKey={slotKey}\n                    onChange={(slotKey) => update({ slotKey })}\n                  />\n                  <CardLight sx={{ p: 1, ml: 1, flexGrow: 1 }}>\n                    <Suspense fallback={<Skeleton width=\"60%\" />}>\n                      <Typography color=\"text.secondary\">\n                        {artifact && sheet?.getSlotName(artifact!.slotKey) ? (\n                          <span>\n                            <ImgIcon\n                              size={2}\n                              src={artifactAsset(\n                                artifact.setKey,\n                                artifact.slotKey\n                              )}\n                            />\n                            {sheet?.getSlotName(artifact!.slotKey)}\n                          </span>\n                        ) : (\n                          t`editor.unknownPieceName`\n                        )}\n                      </Typography>\n                    </Suspense>\n                  </CardLight>\n                </Box>\n\n                {/* main stat */}\n                <Box component=\"div\" display=\"flex\">\n                  <DropdownButton\n                    startIcon={\n                      artifact?.mainStatKey ? (\n                        <StatIcon statKey={artifact.mainStatKey} />\n                      ) : undefined\n                    }\n                    title={\n                      <b>\n                        {artifact ? (\n                          <ArtifactStatWithUnit\n                            statKey={artifact.mainStatKey}\n                          />\n                        ) : (\n                          t`mainStat`\n                        )}\n                      </b>\n                    }\n                    disabled={!sheet}\n                    color={color}\n                  >\n                    {artSlotsData[slotKey].stats.map((mainStatK) => (\n                      <MenuItem\n                        key={mainStatK}\n                        selected={artifact?.mainStatKey === mainStatK}\n                        disabled={artifact?.mainStatKey === mainStatK}\n                        onClick={() => update({ mainStatKey: mainStatK })}\n                      >\n                        <ArtifactColoredIconStatWithUnit statKey={mainStatK} />\n                      </MenuItem>\n                    ))}\n                  </DropdownButton>\n                  <CardLight sx={{ p: 1, ml: 1, flexGrow: 1 }}>\n                    <Typography color=\"text.secondary\">\n                      {artifact\n                        ? getMainStatDisplayStr(\n                            artifact.mainStatKey,\n                            rarity,\n                            level\n                          )\n                        : t`mainStat`}\n                    </Typography>\n                  </CardLight>\n                </Box>\n\n                {/* Current/Max Substats Efficiency */}\n                <SubstatEfficiencyDisplayCard\n                  valid={isValid}\n                  efficiency={currentEfficiency}\n                  t={t}\n                />\n                {currentEfficiency !== maxEfficiency && (\n                  <SubstatEfficiencyDisplayCard\n                    max\n                    valid={isValid}\n                    efficiency={maxEfficiency}\n                    t={t}\n                  />\n                )}\n\n                {/* Image OCR */}\n                {allowUpload && (\n                  <CardLight>\n                    <CardContent\n                      sx={{ display: 'flex', flexDirection: 'column', gap: 1 }}\n                    >\n                      {/* TODO: artifactDispatch not overwrite */}\n                      <Suspense\n                        fallback={<Skeleton width=\"100%\" height=\"100\" />}\n                      >\n                        <Grid container spacing={1} alignItems=\"center\">\n                          <Grid item flexGrow={1}>\n                            <label htmlFor=\"contained-button-file\">\n                              <InputInvis\n                                accept=\"image/*\"\n                                id=\"contained-button-file\"\n                                multiple\n                                type=\"file\"\n                                onChange={onUpload}\n                              />\n                              <Button\n                                component=\"span\"\n                                startIcon={<PhotoCamera />}\n                              >\n                                Upload Screenshot (or Ctrl-V)\n                              </Button>\n                            </label>\n                          </Grid>\n                          <Grid item>\n                            <Button\n                              color=\"info\"\n                              sx={{ px: 2, minWidth: 0 }}\n                              onClick={() => setModalShow(true)}\n                            >\n                              <HelpIcon />\n                            </Button>\n                          </Grid>\n                        </Grid>\n                        {image && (\n                          <Box display=\"flex\" justifyContent=\"center\">\n                            <Box\n                              component=\"img\"\n                              src={image}\n                              width=\"100%\"\n                              maxWidth={350}\n                              height=\"auto\"\n                              alt=\"Screenshot to parse for artifact values\"\n                            />\n                          </Box>\n                        )}\n                        {remaining > 0 && (\n                          <CardDark sx={{ pl: 2 }}>\n                            <Grid container spacing={1} alignItems=\"center\">\n                              {!firstProcessed && firstOutstanding && (\n                                <Grid item>\n                                  <CircularProgress size=\"1em\" />\n                                </Grid>\n                              )}\n                              <Grid item flexGrow={1}>\n                                <Typography>\n                                  <span>\n                                    Screenshots in file-queue:\n                                    <b>{remaining}</b>\n                                    {/* {process.env.NODE_ENV === \"development\" && ` (Debug: Processed ${processed.length}/${maxProcessedCount}, Processing: ${outstanding.filter(entry => entry.result).length}/${maxProcessingCount}, Outstanding: ${outstanding.length})`} */}\n                                  </span>\n                                </Typography>\n                              </Grid>\n                              <Grid item>\n                                <Button\n                                  size=\"small\"\n                                  color=\"error\"\n                                  onClick={clearQueue}\n                                >\n                                  Clear file-queue\n                                </Button>\n                              </Grid>\n                            </Grid>\n                          </CardDark>\n                        )}\n                      </Suspense>\n                    </CardContent>\n                  </CardLight>\n                )}\n              </Grid>\n\n              {/* Right column */}\n              <Grid item xs={1} display=\"flex\" flexDirection=\"column\" gap={1}>\n                {/* substat selections */}\n                {[0, 1, 2, 3].map((index) => (\n                  <SubstatInput\n                    key={index}\n                    index={index}\n                    artifact={cArtifact}\n                    setSubstat={setSubstat}\n                  />\n                ))}\n                {texts && (\n                  <CardLight>\n                    <CardContent>\n                      <div>{texts.slotKey}</div>\n                      <div>{texts.mainStatKey}</div>\n                      <div>{texts.mainStatVal}</div>\n                      <div>{texts.rarity}</div>\n                      <div>{texts.level}</div>\n                      <div>{texts.substats}</div>\n                      <div>{texts.setKey}</div>\n                    </CardContent>\n                  </CardLight>\n                )}\n              </Grid>\n            </Grid>\n\n            {/* Duplicate/Updated/Edit UI */}\n            {old && (\n              <Grid\n                container\n                sx={{ justifyContent: 'space-around' }}\n                spacing={1}\n              >\n                <Grid item xs={12} md={5.5} lg={4}>\n                  <CardLight>\n                    <Typography\n                      sx={{ textAlign: 'center' }}\n                      py={1}\n                      variant=\"h6\"\n                      color=\"text.secondary\"\n                    >\n                      {oldType !== 'edit'\n                        ? oldType === 'duplicate'\n                          ? t`editor.dupArt`\n                          : t`editor.upArt`\n                        : t`editor.beforeEdit`}\n                    </Typography>\n                    <ArtifactCard artifactObj={old} />\n                  </CardLight>\n                </Grid>\n                {grmd && (\n                  <Grid\n                    item\n                    md={1}\n                    display=\"flex\"\n                    alignItems=\"center\"\n                    justifyContent=\"center\"\n                  >\n                    <CardLight sx={{ display: 'flex' }}>\n                      <ChevronRight sx={{ fontSize: 40 }} />\n                    </CardLight>\n                  </Grid>\n                )}\n                <Grid item xs={12} md={5.5} lg={4}>\n                  <CardLight>\n                    <Typography\n                      sx={{ textAlign: 'center' }}\n                      py={1}\n                      variant=\"h6\"\n                      color=\"text.secondary\"\n                    >{t`editor.preview`}</Typography>\n                    <ArtifactCard artifactObj={cArtifact} />\n                  </CardLight>\n                </Grid>\n              </Grid>\n            )}\n\n            {/* Error alert */}\n            {!isValid && (\n              <Alert variant=\"filled\" severity=\"error\">\n                {errors.map((e, i) => (\n                  <div key={i}>{e}</div>\n                ))}\n              </Alert>\n            )}\n\n            {/* Buttons */}\n            <Grid container spacing={2}>\n              <Grid item>\n                {oldType === 'edit' ? (\n                  <Button\n                    startIcon={<Add />}\n                    onClick={() => {\n                      database.arts.set(old!.id, editorArtifact!)\n                      if (allowEmpty) reset()\n                      else {\n                        setShow(false)\n                        cancelEdit()\n                      }\n                    }}\n                    disabled={!editorArtifact || !isValid}\n                    color=\"primary\"\n                  >\n                    {t`editor.btnSave`}\n                  </Button>\n                ) : (\n                  <Button\n                    startIcon={<Add />}\n                    onClick={() => {\n                      database.arts.new(artifact!)\n                      if (allowEmpty) reset()\n                      else {\n                        setShow(false)\n                        cancelEdit()\n                      }\n                    }}\n                    disabled={!artifact || !isValid}\n                    color={oldType === 'duplicate' ? 'warning' : 'primary'}\n                  >\n                    {t`editor.btnAdd`}\n                  </Button>\n                )}\n              </Grid>\n              <Grid item flexGrow={1}>\n                {allowEmpty && (\n                  <Button\n                    startIcon={<Replay />}\n                    disabled={!artifact}\n                    onClick={() => {\n                      canClearArtifact() && reset()\n                    }}\n                    color=\"error\"\n                  >{t`editor.btnClear`}</Button>\n                )}\n              </Grid>\n              <Grid item>\n                {process.env.NODE_ENV === 'development' && (\n                  <Button\n                    color=\"info\"\n                    startIcon={<Shuffle />}\n                    onClick={() =>\n                      artifactDispatch({\n                        type: 'overwrite',\n                        artifact: randomizeArtifact(),\n                      })\n                    }\n                  >{t`editor.btnRandom`}</Button>\n                )}\n              </Grid>\n              {old && oldType !== 'edit' && (\n                <Grid item>\n                  <Button\n                    startIcon={<Update />}\n                    onClick={() => {\n                      database.arts.set(old.id, {\n                        ...editorArtifact,\n                        location: old.location,\n                      })\n                      allowEmpty ? reset() : setShow(false)\n                    }}\n                    disabled={!editorArtifact || !isValid}\n                    color=\"success\"\n                  >{t`editor.btnUpdate`}</Button>\n                </Grid>\n              )}\n            </Grid>\n          </CardContent>\n        </CardDark>\n      </Suspense>\n    </ModalWrapper>\n  )\n}\n"],"names":["ArtifactRarityDropdown","rarity","onChange","filter","props","t","useTranslation","DropdownButton","title","stars","inline","color","map","MenuItem","disabled","onClick","ArtifactSlotDropdown","slotKey","hasUnselect","startIcon","SlotIcon","undefined","selected","ListItemIcon","Replay","ListItemText","Divider","allArtifactSlotKeys","key","CustomNumberTextField","value","float","state","setState","useState","sendChange","useCallback","parseFunc","parseFloat","parseInt","useEffect","toString","TextField","type","e","target","onBlur","onKeyDown","allArtifactSetKeys","k","startsWith","SubstatEfficiencyDisplayCard","efficiency","max","valid","eff","CardLight","sx","py","px","Grid","container","spacing","item","flexGrow","InfoTooltip","Typography","variant","i18nKey","xs","PercentBadge","SubstatInput","index","artifact","setSubstat","mainStatKey","rolls","substats","accurateValue","reduce","a","b","unit","KeyMap","rollNum","length","error","rollData","allowedRolls","numUpgrades","high","artSubstatRollData","getSubstatValuesPercent","rollOffset","marks","useMemo","getSubstatSummedRolls","v","Box","display","ButtonGroup","size","width","StatIcon","statKey","whiteSpace","allSubstatKeys","CustomNumberInput","flexBasis","placeholder","inputProps","textAlign","TextButton","i","newValue","artDisplayValue","allStats","art","subRollCorrection","Button","clamp","SliderWrapper","setValue","pb","SqBadge","count","sort","val","component","indexOf","ml","flexShrink","innerValue","setinnerValue","Slider","step","min","onChangeCommitted","valueLabelDisplay","UploadExplainationModal","modalShow","hide","ModalWrapper","open","onClose","CardDark","CardContent","CloseButton","Alert","severity","mt","md","alt","src","Snippet","height","gutterBottom","href","rel","scan_art_main","large","starColor","r","g","schedulers","constructor","init","deinit","data","this","async","callback","refCount","box","result","scheduler","createScheduler","promises","Array","fill","worker","createWorker","errorHandler","console","load","loadLanguage","language","initialize","addWorker","Promise","any","_language","then","terminate","queueReducer","queue","message","processed","outstanding","files","file","slice","processEntry","entry","fileName","imageURL","fileToURL","ocrResult","imageData","urlFile","resolve","img","Image","onload","image","canvas","document","createElement","context","getContext","drawImage","getImageData","imageToImageData","halfHeight","Math","floor","bottomOpts","rectangle","top","left","awaits","textsFromImage","bandPass","mode","region","rarities","pixels","d","lastRowNum","rowsWithNumber","results","Set","y","star","onStar","x","colorCloseEnough","add","parseRarities","whiteTexts","substatTexts","artifactSetTexts","all","ocr","texts","textSetKeys","slotKeys","mainStatKeys","mainStatValues","relevantSetKey","bestScore","bestArtifacts","setKey","level","location","lock","rarityRates","objKeyMap","allArtifactRarityKeys","score","set","getArtSheet","includes","substat","getSubstatRolls","artSlotsData","stats","mainStatScore","has","relevantMainStatValues","mainStatValue","rarityString","rarityIndividualScore","Object","entries","setKeys","rarityScore","minimumMainStatValue","values","getMainStatDisplayValues","findIndex","mainStatValScore","push","chosen","mainStatVal","resultMainStatVal","getMainStatDisplayValue","every","other","unknownText","name","text","ambiguousText","available","detectedText","inferredText","addText","recommended","getStr","valueStrFunc","find","findBestArtifact","hammingDistance","replace","nameRaw","parseSetKeys","parseSlotKeys","matches","forEach","match","RegExp","exec","parseSubstats","allMainStatKeys","toLowerCase","parseMainStatKeys","regex","parseMainStatValues","reader","FileReader","onloadend","readAsDataURL","options","putImageData","imageDataToCanvas","borrow","addJob","lines","line","color1","color2","threshold","intCloseEnough","abs","pixelData","Uint8ClampedArray","from","bot","bw","invert","halfInd","ImageData","allSubstatFilter","artifactReducer","action","oldIndex","current","InputInvis","styled","ArtifactEditor","artifactIdToEdit","cancelEdit","allowUpload","allowEmpty","disableSet","disableSlot","database","useContext","DatabaseContext","show","setShow","dirtyDatabase","setDirtyDatabase","useForceUpdate","arts","followAny","editorArtifact","artifactDispatch","useReducer","validateArtifact","setModalShow","dispatchQueue","firstProcessed","firstOutstanding","processingImageURL","usePromise","processingResult","remaining","artifactProcessed","disableEditSlot","numProcessing","processingCurrent","uploadFiles","clearQueue","pasteFunc","clipboardData","window","addEventListener","removeEventListener","onUpload","old","oldType","databaseArtifact","get","duplicated","upgraded","findDups","cArtifact","errors","validated","cachedArtifact","structuredClone","sheet","reset","update","newSheet","pick","prefer","slots","isValid","currentEfficiency","maxEfficiency","Artifact","getArtifactEfficiency","preventClosing","preventDefault","theme","useTheme","grmd","useMediaQuery","breakpoints","up","element","allElementWithPhyKeys","ele","updateSetKey","setACDisable","Suspense","fallback","Skeleton","CardHeader","flexDirection","gap","columns","ArtifactSetAutocomplete","artSetKey","setArtSetKey","label","getOptionDisabled","id","mr","my","margin","l","keys","p","getSlotName","ImgIcon","artifactAsset","mainStatK","getMainStatDisplayStr","alignItems","htmlFor","accept","multiple","PhotoCamera","minWidth","Help","justifyContent","maxWidth","pl","CircularProgress","lg","ArtifactCard","artifactObj","ChevronRight","fontSize","Add","new","confirm","process","Update"],"sourceRoot":""}