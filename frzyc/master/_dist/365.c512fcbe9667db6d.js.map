{"version":3,"file":"365.c512fcbe9667db6d.js","mappings":"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","sources":["webpack:///./src/app/Components/Character/LocationAutocomplete.tsx","webpack:///./src/app/Components/ToggleButton/WeaponToggle.tsx","webpack:///./src/app/PageWeapon/index.tsx","webpack:///./src/app/ReactHooks/useWeapon.tsx","webpack:///./src/app/Util/totalUtils.ts","webpack:///../../node_modules/@mui/icons-material/Edit.js","webpack:///../../node_modules/@mui/icons-material/esm/Add.js","webpack:///../../node_modules/@mui/icons-material/esm/Lock.js","webpack:///../../node_modules/@mui/icons-material/esm/LockOpen.js"],"sourcesContent":["import type {\n  LocationCharacterKey,\n  LocationKey,\n} from '@genshin-optimizer/consts'\nimport {\n  allTravelerKeys,\n  charKeyToLocCharKey,\n  charKeyToLocGenderedCharKey,\n} from '@genshin-optimizer/consts'\nimport { BusinessCenter } from '@mui/icons-material'\nimport type { AutocompleteProps } from '@mui/material'\nimport { Skeleton } from '@mui/material'\nimport { Suspense, useCallback, useContext, useMemo } from 'react'\nimport { useTranslation } from 'react-i18next'\nimport { SillyContext } from '../../Context/SillyContext'\nimport { getCharSheet } from '../../Data/Characters'\nimport type CharacterSheet from '../../Data/Characters/CharacterSheet'\nimport { DatabaseContext } from '../../Database/Database'\nimport useDBMeta from '../../ReactHooks/useDBMeta'\nimport type { GeneralAutocompleteOption } from '../GeneralAutocomplete'\nimport { GeneralAutocomplete } from '../GeneralAutocomplete'\nimport CharIconSide from '../Image/CharIconSide'\ntype LocationAutocompleteProps = {\n  location: LocationKey\n  setLocation: (v: LocationKey) => void\n  filter?: (v: CharacterSheet) => void\n  autoCompleteProps?: Omit<\n    AutocompleteProps<\n      GeneralAutocompleteOption<LocationKey>,\n      false,\n      false,\n      false\n    >,\n    'renderInput' | 'onChange' | 'options'\n  >\n}\nexport function LocationAutocomplete({\n  location,\n  setLocation,\n  filter = () => true,\n  autoCompleteProps = {},\n}: LocationAutocompleteProps) {\n  const { t } = useTranslation([\n    'ui',\n    'artifact',\n    'sillyWisher_charNames',\n    'charNames_gen',\n  ])\n  const { silly } = useContext(SillyContext)\n  const { database } = useContext(DatabaseContext)\n  const { gender } = useDBMeta()\n  const toText = useCallback(\n    (silly: boolean) =>\n      (key: LocationCharacterKey): string =>\n        t(\n          `${\n            silly ? 'sillyWisher_charNames' : 'charNames_gen'\n          }:${charKeyToLocGenderedCharKey(\n            database.chars.LocationToCharacterKey(key),\n            gender\n          )}`\n        ),\n    [database, gender, t]\n  )\n  const toImg = useCallback(\n    (key: LocationKey) =>\n      key === '' ? (\n        <BusinessCenter />\n      ) : (\n        <CharIconSide\n          characterKey={database.chars.LocationToCharacterKey(key)}\n        />\n      ),\n    [database]\n  )\n  const isFavorite = useCallback(\n    (key: LocationCharacterKey) =>\n      key === 'Traveler'\n        ? allTravelerKeys.some((key) => database.charMeta.get(key).favorite)\n        : key\n        ? database.charMeta.get(key).favorite\n        : false,\n    [database]\n  )\n\n  const values: GeneralAutocompleteOption<LocationKey>[] = useMemo(\n    () => [\n      {\n        key: '',\n        label: t`artifact:filterLocation.inventory`,\n      },\n      ...Array.from(\n        new Set(\n          database.chars.keys\n            .filter((k) =>\n              getCharSheet(k, gender) ? filter(getCharSheet(k, gender)) : true\n            )\n            .map((k) => charKeyToLocCharKey(k))\n        )\n      )\n        .map(\n          (v): GeneralAutocompleteOption<LocationKey> => ({\n            key: v,\n            label: toText(silly)(v),\n            favorite: isFavorite(v),\n            alternateNames: silly ? [toText(!silly)(v)] : undefined,\n          })\n        )\n        .sort((a, b) => {\n          if (a.favorite && !b.favorite) return -1\n          if (!a.favorite && b.favorite) return 1\n          return a.label.localeCompare(b.label)\n        }),\n    ],\n    [t, database.chars.keys, gender, filter, toText, silly, isFavorite]\n  )\n  return (\n    <Suspense fallback={<Skeleton variant=\"text\" width={100} />}>\n      <GeneralAutocomplete\n        size=\"small\"\n        options={values}\n        valueKey={location}\n        onChange={(k) => setLocation(k ?? '')}\n        toImg={toImg}\n        {...autoCompleteProps}\n      />\n    </Suspense>\n  )\n}\n","import type { WeaponTypeKey } from '@genshin-optimizer/consts'\nimport { allWeaponTypeKeys } from '@genshin-optimizer/consts'\nimport { imgAssets } from '@genshin-optimizer/gi-assets'\nimport { Chip, ToggleButton, useMediaQuery, useTheme } from '@mui/material'\nimport { handleMultiSelect } from '../../Util/MultiSelect'\nimport ImgIcon from '../Image/ImgIcon'\nimport type { SolidToggleButtonGroupProps } from '../SolidToggleButtonGroup'\nimport SolidToggleButtonGroup from '../SolidToggleButtonGroup'\ntype WeaponToggleProps = Omit<\n  SolidToggleButtonGroupProps,\n  'onChange' | 'value'\n> & {\n  onChange: (value: WeaponTypeKey[]) => void\n  value: WeaponTypeKey[]\n  totals: Record<WeaponTypeKey, Displayable>\n}\n\nconst weaponTypeHandler = handleMultiSelect([...allWeaponTypeKeys])\nexport default function WeaponToggle({\n  value,\n  totals,\n  onChange,\n  ...props\n}: WeaponToggleProps) {\n  const theme = useTheme()\n  const xs = !useMediaQuery(theme.breakpoints.up('sm'))\n  return (\n    <SolidToggleButtonGroup exclusive value={value} {...props}>\n      {allWeaponTypeKeys.map((wt) => (\n        <ToggleButton\n          key={wt}\n          value={wt}\n          sx={{\n            p: xs ? 1 : undefined,\n            minWidth: xs ? 0 : '7em',\n            display: 'flex',\n            gap: xs ? 0 : 1,\n          }}\n          onClick={() => onChange(weaponTypeHandler(value, wt))}\n        >\n          <ImgIcon src={imgAssets.weaponTypes?.[wt]} size={2} sideMargin />\n          <Chip label={totals[wt]} size=\"small\" />\n        </ToggleButton>\n      ))}\n    </SolidToggleButtonGroup>\n  )\n}\n","import type { WeaponKey } from '@genshin-optimizer/consts'\nimport { allRarityKeys, allWeaponTypeKeys } from '@genshin-optimizer/consts'\nimport { useForceUpdate, useMediaQueryUp } from '@genshin-optimizer/react-util'\nimport { clamp, filterFunction, sortFunction } from '@genshin-optimizer/util'\nimport { Add } from '@mui/icons-material'\nimport {\n  Box,\n  Button,\n  CardContent,\n  Grid,\n  Pagination,\n  Skeleton,\n  TextField,\n  Typography,\n} from '@mui/material'\nimport type { ChangeEvent } from 'react'\nimport React, {\n  lazy,\n  Suspense,\n  useCallback,\n  useContext,\n  useDeferredValue,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'react'\nimport ReactGA from 'react-ga4'\nimport { Trans, useTranslation } from 'react-i18next'\nimport CardDark from '../Components/Card/CardDark'\nimport SortByButton from '../Components/SortByButton'\nimport RarityToggle from '../Components/ToggleButton/RarityToggle'\nimport WeaponToggle from '../Components/ToggleButton/WeaponToggle'\nimport { getWeaponSheet } from '../Data/Weapons'\nimport { DatabaseContext } from '../Database/Database'\nimport { catTotal } from '../Util/totalUtils'\nimport {\n  weaponFilterConfigs,\n  weaponSortConfigs,\n  weaponSortMap,\n} from '../Util/WeaponSort'\nimport { initialWeapon } from '../Util/WeaponUtil'\nimport WeaponCard from './WeaponCard'\nconst WeaponSelectionModal = React.lazy(\n  () => import('../Components/Weapon/WeaponSelectionModal')\n)\n// Lazy load the weapon display\nconst WeaponEditor = lazy(() => import('./WeaponEditor'))\n\nconst columns = { xs: 1, sm: 2, md: 3, lg: 3, xl: 4 }\nconst numToShowMap = { xs: 10, sm: 12, md: 24, lg: 24, xl: 24 }\n\nconst sortKeys = Object.keys(weaponSortMap)\nexport default function PageWeapon() {\n  const { t } = useTranslation(['page_weapon', 'ui', 'weaponNames_gen'])\n  const { database } = useContext(DatabaseContext)\n  const [state, setState] = useState(database.displayWeapon.get())\n  useEffect(\n    () => database.displayWeapon.follow((r, dbMeta) => setState(dbMeta)),\n    [database]\n  )\n\n  const [newWeaponModalShow, setnewWeaponModalShow] = useState(false)\n  const [dbDirty, forceUpdate] = useForceUpdate()\n  const invScrollRef = useRef<HTMLDivElement>(null)\n  const [pageIndex, setPageIndex] = useState(0)\n  //set follow, should run only once\n  useEffect(() => {\n    ReactGA.send({ hitType: 'pageview', page: '/weapon' })\n    return database.weapons.followAny(\n      (k, r) => (r === 'new' || r === 'remove') && forceUpdate()\n    )\n  }, [forceUpdate, database])\n\n  const brPt = useMediaQueryUp()\n  const maxNumToDisplay = numToShowMap[brPt]\n\n  const deleteWeapon = useCallback(\n    async (key: string) => {\n      const weapon = database.weapons.get(key)\n      if (!weapon) return\n      const name = t(`weaponNames_gen:${weapon.key}`)\n\n      if (!window.confirm(t('removeWeapon', { value: name }))) return\n      database.weapons.remove(key)\n      if (state.editWeaponId === key)\n        database.displayWeapon.set({ editWeaponId: '' })\n    },\n    [state.editWeaponId, database, t]\n  )\n\n  const editWeapon = useCallback(\n    (key: string | undefined) => {\n      database.displayWeapon.set({ editWeaponId: key })\n    },\n    [database]\n  )\n\n  const newWeapon = useCallback(\n    (weaponKey: WeaponKey) => {\n      editWeapon(database.weapons.new(initialWeapon(weaponKey)))\n    },\n    [database, editWeapon]\n  )\n\n  const [searchTerm, setSearchTerm] = useState('')\n  const deferredSearchTerm = useDeferredValue(searchTerm)\n\n  const { sortType, ascending, weaponType, rarity } = state\n  const { weaponIdList, totalWeaponNum } = useMemo(() => {\n    const weapons = database.weapons.values\n    const totalWeaponNum = weapons.length\n    const weaponIdList = weapons\n      .filter(\n        filterFunction(\n          { weaponType, rarity, name: deferredSearchTerm },\n          weaponFilterConfigs()\n        )\n      )\n      .sort(\n        sortFunction(\n          weaponSortMap[sortType] ?? [],\n          ascending,\n          weaponSortConfigs()\n        )\n      )\n      .map((weapon) => weapon.id)\n    return dbDirty && { weaponIdList, totalWeaponNum }\n  }, [\n    dbDirty,\n    database,\n    sortType,\n    ascending,\n    rarity,\n    weaponType,\n    deferredSearchTerm,\n  ])\n\n  const { weaponIdsToShow, numPages, currentPageIndex } = useMemo(() => {\n    const numPages = Math.ceil(weaponIdList.length / maxNumToDisplay)\n    const currentPageIndex = clamp(pageIndex, 0, numPages - 1)\n    return {\n      weaponIdsToShow: weaponIdList.slice(\n        currentPageIndex * maxNumToDisplay,\n        (currentPageIndex + 1) * maxNumToDisplay\n      ),\n      numPages,\n      currentPageIndex,\n    }\n  }, [weaponIdList, pageIndex, maxNumToDisplay])\n\n  // Pagination\n  const totalShowing =\n    weaponIdList.length !== totalWeaponNum\n      ? `${weaponIdList.length}/${totalWeaponNum}`\n      : `${totalWeaponNum}`\n  const setPage = useCallback(\n    (_: ChangeEvent<unknown>, value: number) => {\n      invScrollRef.current?.scrollIntoView({ behavior: 'smooth' })\n      setPageIndex(value - 1)\n    },\n    [setPageIndex, invScrollRef]\n  )\n\n  const resetEditWeapon = useCallback(\n    () => database.displayWeapon.set({ editWeaponId: '' }),\n    [database]\n  )\n\n  const { editWeaponId } = state\n\n  // Validate weaponId to be an actual weapon\n  useEffect(() => {\n    if (!editWeaponId) return\n    if (!database.weapons.get(editWeaponId)) resetEditWeapon()\n  }, [database, editWeaponId, resetEditWeapon])\n\n  const weaponTotals = useMemo(\n    () =>\n      catTotal(allWeaponTypeKeys, (ct) =>\n        Object.entries(database.weapons.data).forEach(([id, weapon]) => {\n          const wtk = getWeaponSheet(weapon.key).weaponType\n          ct[wtk].total++\n          if (weaponIdList.includes(id)) ct[wtk].current++\n        })\n      ),\n    [database, weaponIdList]\n  )\n\n  const weaponRarityTotals = useMemo(\n    () =>\n      catTotal(allRarityKeys, (ct) =>\n        Object.entries(database.weapons.data).forEach(([id, weapon]) => {\n          const wr = getWeaponSheet(weapon.key).rarity\n          ct[wr].total++\n          if (weaponIdList.includes(id)) ct[wr].current++\n        })\n      ),\n    [database, weaponIdList]\n  )\n\n  return (\n    <Box my={1} display=\"flex\" flexDirection=\"column\" gap={1}>\n      <Suspense fallback={false}>\n        <WeaponSelectionModal\n          show={newWeaponModalShow}\n          onHide={() => setnewWeaponModalShow(false)}\n          onSelect={newWeapon}\n        />\n      </Suspense>\n      {/* Editor/character detail display */}\n      <Suspense fallback={false}>\n        <WeaponEditor\n          weaponId={editWeaponId}\n          footer\n          onClose={resetEditWeapon}\n        />\n      </Suspense>\n\n      <CardDark ref={invScrollRef}>\n        <CardContent sx={{ display: 'flex', flexDirection: 'column', gap: 1 }}>\n          <Box display=\"flex\" flexWrap=\"wrap\" gap={1} alignItems=\"stretch\">\n            <WeaponToggle\n              onChange={(weaponType) =>\n                database.displayWeapon.set({ weaponType })\n              }\n              value={weaponType}\n              totals={weaponTotals}\n              size=\"small\"\n            />\n            <RarityToggle\n              sx={{ height: '100%' }}\n              onChange={(rarity) => database.displayWeapon.set({ rarity })}\n              value={rarity}\n              totals={weaponRarityTotals}\n              size=\"small\"\n            />\n            <Box flexGrow={1} />\n            <TextField\n              autoFocus\n              size=\"small\"\n              value={searchTerm}\n              onChange={(e: ChangeEvent<HTMLTextAreaElement>) =>\n                setSearchTerm(e.target.value)\n              }\n              label={t('weaponName')}\n              sx={{ height: '100%' }}\n              InputProps={{\n                sx: { height: '100%' },\n              }}\n            />\n          </Box>\n          <Box\n            display=\"flex\"\n            justifyContent=\"space-between\"\n            alignItems=\"flex-end\"\n            flexWrap=\"wrap\"\n          >\n            <Pagination\n              count={numPages}\n              page={currentPageIndex + 1}\n              onChange={setPage}\n            />\n            <ShowingWeapon\n              numShowing={weaponIdsToShow.length}\n              total={totalShowing}\n              t={t}\n            />\n            <SortByButton\n              sx={{ height: '100%' }}\n              sortKeys={sortKeys}\n              value={sortType}\n              onChange={(sortType) => database.displayWeapon.set({ sortType })}\n              ascending={ascending}\n              onChangeAsc={(ascending) =>\n                database.displayWeapon.set({ ascending })\n              }\n            />\n          </Box>\n        </CardContent>\n      </CardDark>\n      <Suspense\n        fallback={\n          <Skeleton\n            variant=\"rectangular\"\n            sx={{ width: '100%', height: '100%', minHeight: 500 }}\n          />\n        }\n      >\n        <Button\n          fullWidth\n          onClick={() => setnewWeaponModalShow(true)}\n          color=\"info\"\n          startIcon={<Add />}\n        >\n          {t('page_weapon:addWeapon')}\n        </Button>\n        <Grid container spacing={1} columns={columns}>\n          {weaponIdsToShow.map((weaponId) => (\n            <Grid item key={weaponId} xs={1}>\n              <WeaponCard\n                weaponId={weaponId}\n                onDelete={deleteWeapon}\n                onEdit={editWeapon}\n                canEquip\n              />\n            </Grid>\n          ))}\n        </Grid>\n      </Suspense>\n      {numPages > 1 && (\n        <CardDark>\n          <CardContent>\n            <Grid container alignItems=\"flex-end\">\n              <Grid item flexGrow={1}>\n                <Pagination\n                  count={numPages}\n                  page={currentPageIndex + 1}\n                  onChange={setPage}\n                />\n              </Grid>\n              <Grid item>\n                <ShowingWeapon\n                  numShowing={weaponIdsToShow.length}\n                  total={totalShowing}\n                  t={t}\n                />\n              </Grid>\n            </Grid>\n          </CardContent>\n        </CardDark>\n      )}\n    </Box>\n  )\n}\nfunction ShowingWeapon({ numShowing, total, t }) {\n  return (\n    <Typography color=\"text.secondary\">\n      <Trans t={t} i18nKey=\"showingNum\" count={numShowing} value={total}>\n        Showing <b>{{ count: numShowing } as TransObject}</b> out of{' '}\n        {{ value: total }} Weapons\n      </Trans>\n    </Typography>\n  )\n}\n","import { useContext, useEffect, useState } from 'react'\nimport { DatabaseContext } from '../Database/Database'\n\nexport default function useWeapon(weaponID: string | undefined = '') {\n  const { database } = useContext(DatabaseContext)\n  const [weapon, setWeapon] = useState(database.weapons.get(weaponID))\n  useEffect(\n    () => setWeapon(database.weapons.get(weaponID)),\n    [database, weaponID]\n  )\n  useEffect(\n    () =>\n      weaponID\n        ? database.weapons.follow(\n            weaponID,\n            (k, r, v) => r === 'update' && setWeapon(v)\n          )\n        : undefined,\n    [weaponID, setWeapon, database]\n  )\n  return weapon\n}\n","import { objMap } from '@genshin-optimizer/util'\ntype Entry = {\n  total: number\n  current: number\n}\ntype CatTotalKey = string | number | symbol\n// A helper function to generate multiple `current/total` formated string object with categories using a single callback\nexport function bulkCatTotal(\n  catTotals: Record<CatTotalKey, readonly CatTotalKey[]>,\n  cb: (ctMap: Record<CatTotalKey, Record<CatTotalKey, Entry>>) => void\n) {\n  const ctMap = objMap(catTotals, (keys) => catTotalObj(keys))\n  cb(ctMap)\n  return objMap(ctMap, (ct) => catTotalToStringObj(ct))\n}\n// A helper function to generate a `current/total` formated string object with categories\nexport function catTotal<T extends CatTotalKey>(\n  keys: readonly T[],\n  cb: (ct: Record<T, Entry>) => void\n) {\n  const ct = catTotalObj(keys)\n  cb(ct)\n  return catTotalToStringObj(ct)\n}\n\nfunction catTotalObj<T extends CatTotalKey>(\n  keys: readonly T[]\n): Record<T, Entry> {\n  return Object.fromEntries(\n    keys.map((k) => [k, { total: 0, current: 0 }])\n  ) as Record<T, Entry>\n}\n\nfunction catTotalToStringObj<T extends CatTotalKey>(tot: Record<T, Entry>) {\n  return objMap(tot, ({ total, current }) =>\n    current === total ? `${total}` : `${current}/${total}`\n  ) as Record<T, string>\n}\n","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z\"\n}), 'Edit');\nexports.default = _default;","import createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z\"\n}), 'Add');","import createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z\"\n}), 'Lock');","import createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M12 17c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm6-9h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6h1.9c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm0 12H6V10h12v10z\"\n}), 'LockOpen');"],"names":["LocationAutocomplete","location","setLocation","filter","autoCompleteProps","t","useTranslation","silly","useContext","SillyContext","database","DatabaseContext","gender","useDBMeta","toText","useCallback","key","charKeyToLocGenderedCharKey","chars","LocationToCharacterKey","toImg","characterKey","isFavorite","allTravelerKeys","some","charMeta","get","favorite","values","useMemo","label","Array","from","Set","keys","k","getCharSheet","map","charKeyToLocCharKey","v","alternateNames","undefined","sort","a","b","localeCompare","Suspense","fallback","variant","width","size","options","valueKey","onChange","weaponTypeHandler","handleMultiSelect","allWeaponTypeKeys","WeaponToggle","value","totals","props","theme","useTheme","xs","useMediaQuery","breakpoints","up","exclusive","wt","sx","p","minWidth","display","gap","onClick","src","imgAssets","weaponTypes","sideMargin","WeaponSelectionModal","React","WeaponEditor","lazy","columns","sm","md","lg","xl","numToShowMap","sortKeys","Object","weaponSortMap","PageWeapon","state","setState","useState","displayWeapon","useEffect","follow","r","dbMeta","newWeaponModalShow","setnewWeaponModalShow","dbDirty","forceUpdate","useForceUpdate","invScrollRef","useRef","pageIndex","setPageIndex","ReactGA","send","hitType","page","weapons","followAny","brPt","useMediaQueryUp","maxNumToDisplay","deleteWeapon","async","weapon","name","window","confirm","remove","editWeaponId","set","editWeapon","newWeapon","weaponKey","new","initialWeapon","searchTerm","setSearchTerm","deferredSearchTerm","useDeferredValue","sortType","ascending","weaponType","rarity","weaponIdList","totalWeaponNum","length","filterFunction","weaponFilterConfigs","sortFunction","weaponSortConfigs","id","weaponIdsToShow","numPages","currentPageIndex","Math","ceil","clamp","slice","totalShowing","setPage","_","current","scrollIntoView","behavior","resetEditWeapon","weaponTotals","catTotal","ct","entries","data","forEach","wtk","getWeaponSheet","total","includes","weaponRarityTotals","allRarityKeys","wr","my","flexDirection","show","onHide","onSelect","weaponId","footer","onClose","ref","flexWrap","alignItems","height","flexGrow","autoFocus","e","target","InputProps","justifyContent","count","ShowingWeapon","numShowing","onChangeAsc","minHeight","fullWidth","color","startIcon","container","spacing","item","onDelete","onEdit","canEquip","i18nKey","useWeapon","weaponID","setWeapon","bulkCatTotal","catTotals","cb","ctMap","objMap","catTotalObj","catTotalToStringObj","fromEntries","tot","_interopRequireDefault","exports","_createSvgIcon","_jsxRuntime","_default","default","jsx","d"],"sourceRoot":""}