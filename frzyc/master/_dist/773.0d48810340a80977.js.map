{"version":3,"file":"773.0d48810340a80977.js","mappings":"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","sources":["webpack:///./src/app/Components/Artifact/ArtifactRarityDropdown.tsx","webpack:///./src/app/Components/Artifact/ArtifactSlotDropdown.tsx","webpack:///./src/app/Components/CustomNumberTextField.tsx","webpack:///../../libs/gi-good/src/randomizeArtifact.ts","webpack:///./src/app/PageArtifact/ArtifactEditor/Components/SubstatEfficiencyDisplayCard.tsx","webpack:///./src/app/PageArtifact/ArtifactEditor/Components/SubstatInput.tsx","webpack:///./src/app/PageArtifact/ArtifactEditor/Components/UploadExplainationModal.tsx","webpack:///./src/app/PageArtifact/ScanningUtil.tsx","webpack:///./src/app/PageArtifact/BorrowManager.ts","webpack:///./src/app/PageArtifact/ArtifactEditor.tsx"],"sourcesContent":["import type { ButtonProps } from '@mui/material'\nimport { MenuItem } from '@mui/material'\nimport { useTranslation } from 'react-i18next'\nimport type { ArtifactRarity } from '@genshin-optimizer/consts'\nimport DropdownButton from '../DropdownMenu/DropdownButton'\nimport { StarsDisplay } from '../StarDisplay'\n\ntype props = ButtonProps & {\n  rarity?: ArtifactRarity\n  onChange: (rarity: ArtifactRarity) => void\n  filter: (ArtifactRarity) => boolean\n}\n\nexport default function ArtifactRarityDropdown({\n  rarity,\n  onChange,\n  filter,\n  ...props\n}: props) {\n  const { t } = useTranslation('artifact')\n  return (\n    <DropdownButton\n      {...props}\n      title={rarity ? <StarsDisplay stars={rarity} inline /> : t`editor.rarity`}\n      color={rarity ? 'success' : 'primary'}\n    >\n      {([5, 4, 3] as ArtifactRarity[]).map((rarity) => (\n        <MenuItem\n          key={rarity}\n          disabled={!filter(rarity)}\n          onClick={() => onChange(rarity)}\n        >\n          <StarsDisplay stars={rarity} inline />\n        </MenuItem>\n      ))}\n    </DropdownButton>\n  )\n}\n","import type { ArtifactSlotKey } from '@genshin-optimizer/consts'\nimport { allArtifactSlotKeys } from '@genshin-optimizer/consts'\nimport { Replay } from '@mui/icons-material'\nimport type { ButtonProps } from '@mui/material'\nimport { Divider, ListItemIcon, ListItemText, MenuItem } from '@mui/material'\nimport { useTranslation } from 'react-i18next'\nimport DropdownButton from '../DropdownMenu/DropdownButton'\nimport SlotIcon from './SlotIcon'\n\ntype ArtifactSlotDropdownProps = ButtonProps & {\n  slotKey?: ArtifactSlotKey | ''\n  onChange: (slotKey: ArtifactSlotKey | '') => void\n  hasUnselect?: boolean\n}\n\nexport default function ArtifactSlotDropdown({\n  slotKey = '',\n  onChange,\n  hasUnselect = false,\n  ...props\n}: ArtifactSlotDropdownProps) {\n  const { t } = useTranslation(['artifact', 'ui'])\n  return (\n    <DropdownButton\n      title={slotKey ? t(`artifact:slotName:${slotKey}`) : t('artifact:slot')}\n      color={slotKey ? 'success' : 'primary'}\n      startIcon={slotKey ? <SlotIcon slotKey={slotKey} /> : undefined}\n      {...props}\n    >\n      {hasUnselect && (\n        <MenuItem\n          selected={slotKey === ''}\n          disabled={slotKey === ''}\n          onClick={() => onChange('')}\n        >\n          <ListItemIcon>\n            <Replay />\n          </ListItemIcon>\n          <ListItemText>{t`ui:unselect`}</ListItemText>\n        </MenuItem>\n      )}\n      {hasUnselect && <Divider />}\n      {allArtifactSlotKeys.map((key) => (\n        <MenuItem\n          key={key}\n          selected={slotKey === key}\n          disabled={slotKey === key}\n          onClick={() => onChange(key)}\n        >\n          <ListItemIcon>\n            <SlotIcon slotKey={key} />\n          </ListItemIcon>\n          <ListItemText>{t(`artifact:slotName:${key}`)}</ListItemText>\n        </MenuItem>\n      ))}\n    </DropdownButton>\n  )\n}\n","import type { TextFieldProps } from '@mui/material'\nimport { TextField } from '@mui/material'\nimport { useCallback, useEffect, useState } from 'react'\ntype props = TextFieldProps & {\n  value?: number | undefined\n  onChange: (newValue: number | undefined) => void\n  disabled?: boolean\n  float?: boolean\n  allowEmpty?: boolean\n}\nexport default function CustomNumberTextField({\n  value,\n  onChange,\n  disabled = false,\n  float = false,\n  ...props\n}: props) {\n  const [state, setState] = useState('')\n  const sendChange = useCallback(() => {\n    if (state === '') return onChange(0)\n    const parseFunc = float ? parseFloat : parseInt\n    onChange(parseFunc(state))\n  }, [onChange, state, float])\n  useEffect(() => setState(value?.toString() ?? ''), [value, setState]) // update value on value change\n\n  return (\n    <TextField\n      value={state}\n      aria-label=\"custom-input\"\n      type=\"number\"\n      onChange={(e: any) => setState(e.target.value)}\n      onBlur={sendChange}\n      disabled={disabled}\n      onKeyDown={(e: any) => e.key === 'Enter' && sendChange()}\n      {...props}\n    />\n  )\n}\n","import type {\n  ArtifactRarity,\n  ArtifactSlotKey,\n  MainStatKey,\n  RarityKey,\n  SubstatKey,\n} from '@genshin-optimizer/consts'\nimport {\n  allArtifactRarityKeys,\n  allArtifactSetKeys,\n  allSubstatKeys,\n  artMaxLevel,\n  artSlotsData,\n  artSubstatRollData,\n} from '@genshin-optimizer/consts'\nimport { allStats } from '@genshin-optimizer/gi-stats'\nimport {\n  artDisplayValue,\n  getSubstatValuesPercent,\n} from '@genshin-optimizer/gi-util'\nimport {\n  getRandomElementFromArray,\n  getRandomIntInclusive,\n  unit,\n} from '@genshin-optimizer/util'\nimport type { IArtifact, ISubstat } from './IArtifact'\n\n// do not randomize Prayers since they don't have all slots\nconst artSets = allArtifactSetKeys.filter((k) => !k.startsWith('Prayers'))\nexport function randomizeArtifact(base: Partial<IArtifact> = {}): IArtifact {\n  const setKey = base.setKey ?? getRandomElementFromArray(artSets)\n  const data = allStats.art.data[setKey]\n\n  const rarity = (base.rarity ??\n    getRandomElementFromArray(\n      data.rarities.filter((r: number) =>\n        // GO only supports artifacts from 3 to 5 stars\n        allArtifactRarityKeys.includes(r as ArtifactRarity)\n      )\n    )) as ArtifactRarity\n  const slot: ArtifactSlotKey =\n    base.slotKey ?? getRandomElementFromArray(data.slots)\n  const mainStatKey: MainStatKey =\n    base.mainStatKey ?? getRandomElementFromArray(artSlotsData[slot].stats)\n  const level =\n    base.level ?? getRandomIntInclusive(0, artMaxLevel[rarity as RarityKey])\n  const substats: ISubstat[] = [0, 1, 2, 3].map(() => ({ key: '', value: 0 }))\n\n  const { low, high } = artSubstatRollData[rarity]\n  const totRolls = Math.floor(level / 4) + getRandomIntInclusive(low, high)\n  const numOfInitialSubstats = Math.min(totRolls, 4)\n  const numUpgradesOrUnlocks = totRolls - numOfInitialSubstats\n\n  const RollStat = (substat: SubstatKey): number =>\n    getRandomElementFromArray(getSubstatValuesPercent(substat, rarity))\n\n  let remainingSubstats = allSubstatKeys.filter((key) => mainStatKey !== key)\n  for (const substat of substats.slice(0, numOfInitialSubstats)) {\n    substat.key = getRandomElementFromArray(remainingSubstats)\n    substat.value = RollStat(substat.key as SubstatKey)\n    remainingSubstats = remainingSubstats.filter((key) => key !== substat.key)\n  }\n  for (let i = 0; i < numUpgradesOrUnlocks; i++) {\n    const substat = getRandomElementFromArray(substats)\n    substat.value += RollStat(substat.key as any)\n  }\n  for (const substat of substats)\n    if (substat.key) {\n      const value = artDisplayValue(substat.value, unit(substat.key))\n      substat.value = parseFloat(\n        allStats.art.subRollCorrection[rarity]?.[substat.key]?.[value] ?? value\n      )\n    }\n\n  return {\n    setKey,\n    rarity,\n    slotKey: slot,\n    mainStatKey,\n    level,\n    substats,\n    location: base.location ?? '',\n    lock: false,\n  }\n}\n","import { Grid, Typography } from '@mui/material'\nimport React from 'react'\nimport { Trans } from 'react-i18next'\nimport CardLight from '../../../Components/Card/CardLight'\nimport InfoTooltip from '../../../Components/InfoTooltip'\nimport PercentBadge from '../../../Components/PercentBadge'\n\nexport default function SubstatEfficiencyDisplayCard({\n  efficiency,\n  max = false,\n  t,\n  valid,\n}) {\n  const eff = max ? 'maxSubEff' : 'curSubEff'\n  return (\n    <CardLight sx={{ py: 1, px: 2 }}>\n      <Grid container spacing={1}>\n        <Grid item>{t(`editor.${eff}`)}</Grid>\n        <Grid item flexGrow={1}>\n          <InfoTooltip\n            title={\n              <span>\n                <Typography variant=\"h6\">{t(`editor.${eff}`)}</Typography>\n                <Typography>\n                  <Trans t={t} i18nKey={`editor.${eff}Desc`} />\n                </Typography>\n              </span>\n            }\n          />\n        </Grid>\n        <Grid item xs=\"auto\">\n          <PercentBadge\n            valid={valid}\n            max={900}\n            value={valid ? efficiency : 'ERR'}\n          />\n        </Grid>\n      </Grid>\n    </CardLight>\n  )\n}\n","import { allSubstatKeys, artSubstatRollData } from '@genshin-optimizer/consts'\nimport type { ISubstat } from '@genshin-optimizer/gi-good'\nimport { allStats } from '@genshin-optimizer/gi-stats'\nimport {\n  artDisplayValue,\n  getSubstatSummedRolls,\n  getSubstatValuesPercent,\n} from '@genshin-optimizer/gi-util'\nimport { clamp } from '@genshin-optimizer/util'\nimport {\n  Box,\n  Button,\n  ButtonGroup,\n  Grid,\n  ListItemIcon,\n  ListItemText,\n  MenuItem,\n  Slider,\n  Typography,\n} from '@mui/material'\nimport { useEffect, useMemo, useState } from 'react'\nimport { Trans, useTranslation } from 'react-i18next'\nimport { ArtifactStatWithUnit } from '../../../Components/Artifact/ArtifactStatKeyDisplay'\nimport CardLight from '../../../Components/Card/CardLight'\nimport CustomNumberInput, {\n  CustomNumberInputButtonGroupWrapper,\n} from '../../../Components/CustomNumberInput'\nimport DropdownButton from '../../../Components/DropdownMenu/DropdownButton'\nimport PercentBadge from '../../../Components/PercentBadge'\nimport SqBadge from '../../../Components/SqBadge'\nimport TextButton from '../../../Components/TextButton'\nimport KeyMap from '../../../KeyMap'\nimport StatIcon from '../../../KeyMap/StatIcon'\nimport type { ICachedArtifact } from '../../../Types/artifact'\nimport type { RollColorKey } from '../../../Types/consts'\n\nexport default function SubstatInput({\n  index,\n  artifact,\n  setSubstat,\n}: {\n  index: number\n  artifact: ICachedArtifact | undefined\n  setSubstat: (index: number, substat: ISubstat) => void\n}) {\n  const { t } = useTranslation('artifact')\n  const { mainStatKey = '', rarity = 5 } = artifact ?? {}\n  const {\n    key = '',\n    value = 0,\n    rolls = [],\n    efficiency = 0,\n  } = artifact?.substats[index] ?? {}\n\n  const accurateValue = rolls.reduce((a, b) => a + b, 0)\n  const unit = KeyMap.unit(key),\n    rollNum = rolls.length\n\n  let error = '',\n    rollData: readonly number[] = [],\n    allowedRolls = 0\n\n  if (artifact) {\n    // Account for the rolls it will need to fill all 4 substates, +1 for its base roll\n    const rarity = artifact.rarity\n    const { numUpgrades, high } = artSubstatRollData[rarity]\n    const maxRollNum = numUpgrades + high - 3\n    allowedRolls = maxRollNum - rollNum\n    rollData = key ? getSubstatValuesPercent(key, rarity) : []\n  }\n  const rollOffset = 7 - rollData.length\n\n  if (!rollNum && key && value) error = error || t`editor.substat.error.noCalc`\n  if (allowedRolls < 0)\n    error =\n      error ||\n      t('editor.substat.error.noOverRoll', { value: allowedRolls + rollNum })\n\n  const marks = useMemo(\n    () =>\n      key\n        ? [\n            { value: 0 },\n            ...getSubstatSummedRolls(rarity, key).map((v) => ({ value: v })),\n          ]\n        : [{ value: 0 }],\n    [key, rarity]\n  )\n\n  return (\n    <CardLight>\n      <Box sx={{ display: 'flex' }}>\n        <ButtonGroup size=\"small\" sx={{ width: '100%', display: 'flex' }}>\n          <DropdownButton\n            startIcon={key ? <StatIcon statKey={key} /> : undefined}\n            title={\n              key ? (\n                <ArtifactStatWithUnit statKey={key} />\n              ) : (\n                t('editor.substat.substatFormat', { value: index + 1 })\n              )\n            }\n            disabled={!artifact}\n            color={key ? 'success' : 'primary'}\n            sx={{ whiteSpace: 'nowrap' }}\n          >\n            {key && (\n              <MenuItem\n                onClick={() => setSubstat(index, { key: '', value: 0 })}\n              >{t`editor.substat.noSubstat`}</MenuItem>\n            )}\n            {allSubstatKeys\n              .filter((key) => mainStatKey !== key)\n              .map((k) => (\n                <MenuItem\n                  key={k}\n                  selected={key === k}\n                  disabled={key === k}\n                  onClick={() => setSubstat(index, { key: k, value: 0 })}\n                >\n                  <ListItemIcon>\n                    <StatIcon statKey={k} />\n                  </ListItemIcon>\n                  <ListItemText>\n                    <ArtifactStatWithUnit statKey={k} />\n                  </ListItemText>\n                </MenuItem>\n              ))}\n          </DropdownButton>\n          <CustomNumberInputButtonGroupWrapper\n            sx={{ flexBasis: 30, flexGrow: 1 }}\n          >\n            <CustomNumberInput\n              float={unit === '%'}\n              placeholder={t`editor.substat.selectSub`}\n              value={key ? value : undefined}\n              onChange={(value) =>\n                setSubstat(index, { key, value: value ?? 0 })\n              }\n              disabled={!key}\n              error={!!error}\n              sx={{\n                px: 1,\n              }}\n              inputProps={{\n                sx: { textAlign: 'right' },\n              }}\n            />\n          </CustomNumberInputButtonGroupWrapper>\n          {!!rollData.length && (\n            <TextButton>{t`editor.substat.nextRolls`}</TextButton>\n          )}\n          {rollData.map((v, i) => {\n            let newValue = artDisplayValue(accurateValue + v, unit)\n            newValue =\n              allStats.art.subRollCorrection[rarity]?.[key]?.[newValue] ??\n              newValue\n            return (\n              <Button\n                key={i}\n                color={`roll${clamp(rollOffset + i, 1, 6)}` as any}\n                disabled={(value && !rollNum) || allowedRolls <= 0}\n                onClick={() =>\n                  setSubstat(index, { key, value: parseFloat(newValue) })\n                }\n              >\n                {newValue}\n              </Button>\n            )\n          })}\n        </ButtonGroup>\n      </Box>\n      <Box px={2}>\n        <SliderWrapper\n          value={value}\n          marks={marks}\n          setValue={(v) =>\n            setSubstat(index, { key, value: (v as number) ?? 0 })\n          }\n          disabled={!key}\n        />\n      </Box>\n      <Box sx={{ px: 1, pb: 1 }}>\n        {error ? (\n          <SqBadge color=\"error\">{t`ui:error`}</SqBadge>\n        ) : (\n          <Grid container>\n            <Grid item>\n              <SqBadge\n                color={\n                  rollNum === 0\n                    ? 'secondary'\n                    : (`roll${clamp(rollNum, 1, 6)}` as RollColorKey)\n                }\n              >\n                {rollNum\n                  ? t('editor.substat.RollCount', { count: rollNum })\n                  : t`editor.substat.noRoll`}\n              </SqBadge>\n            </Grid>\n            <Grid item flexGrow={1}>\n              {!!rolls.length &&\n                [...rolls].sort().map((val, i) => (\n                  <Typography\n                    component=\"span\"\n                    key={`${i}.${val}`}\n                    color={`roll${clamp(\n                      rollOffset + rollData.indexOf(val),\n                      1,\n                      6\n                    )}.main`}\n                    sx={{ ml: 1 }}\n                  >\n                    {artDisplayValue(val, unit)}\n                  </Typography>\n                ))}\n            </Grid>\n            <Grid item xs=\"auto\" flexShrink={1}>\n              <Typography>\n                <Trans\n                  t={t}\n                  i18nKey=\"editor.substat.eff\"\n                  color=\"text.secondary\"\n                >\n                  {'Efficiency: '}\n                  <PercentBadge\n                    valid={true}\n                    max={rollNum * 100}\n                    value={\n                      efficiency\n                        ? efficiency\n                        : (t`editor.substat.noStat` as string)\n                    }\n                  />\n                </Trans>\n              </Typography>\n            </Grid>\n          </Grid>\n        )}\n      </Box>\n    </CardLight>\n  )\n}\nfunction SliderWrapper({\n  value,\n  setValue,\n  marks,\n  disabled = false,\n}: {\n  value: number\n  setValue: (v: number) => void\n  marks: Array<{ value: number }>\n  disabled: boolean\n}) {\n  const [innerValue, setinnerValue] = useState(value)\n  useEffect(() => setinnerValue(value), [value])\n  return (\n    <Slider\n      value={innerValue}\n      step={null}\n      disabled={disabled}\n      marks={marks}\n      min={0}\n      max={marks[marks.length - 1]?.value ?? 0}\n      onChange={(e, v) => setinnerValue(v as number)}\n      onChangeCommitted={(e, v) => setValue(v as number)}\n      valueLabelDisplay=\"auto\"\n    />\n  )\n}\n","import {\n  Alert,\n  Box,\n  CardContent,\n  Divider,\n  Grid,\n  Typography,\n} from '@mui/material'\nimport CardDark from '../../../Components/Card/CardDark'\nimport CloseButton from '../../../Components/CloseButton'\nimport ModalWrapper from '../../../Components/ModalWrapper'\nimport scan_art_main from './imgs/scan_art_main.png'\nimport Snippet from './imgs/snippet.png'\nexport default function UploadExplainationModal({\n  modalShow,\n  hide,\n}: {\n  modalShow: boolean\n  hide: () => void\n}) {\n  return (\n    <ModalWrapper open={modalShow} onClose={hide}>\n      <CardDark>\n        <CardContent sx={{ py: 1 }}>\n          <Grid container>\n            <Grid item flexGrow={1}>\n              <Typography variant=\"subtitle1\">\n                How do Upload Screenshots for parsing\n              </Typography>\n            </Grid>\n            <Grid item>\n              <CloseButton onClick={hide} />\n            </Grid>\n          </Grid>\n        </CardContent>\n        <Divider />\n        <CardContent>\n          <Alert variant=\"outlined\" severity=\"warning\">\n            NOTE: Artifact Scanning currently only work for{' '}\n            <strong>ENGLISH</strong> artifacts.\n          </Alert>\n          <Grid container spacing={1} mt={1}>\n            <Grid item xs={8} md={4}>\n              <Box\n                component=\"img\"\n                alt=\"snippet of the screen to take\"\n                src={Snippet}\n                width=\"100%\"\n                height=\"auto\"\n              />\n            </Grid>\n            <Grid item xs={12} md={8}>\n              <Typography gutterBottom>\n                Using screenshots can dramatically decrease the amount of time\n                you manually input in stats on the Genshin Optimizer.\n              </Typography>\n              <Typography variant=\"h5\">\n                Where to snip the screenshot.\n              </Typography>\n              <Typography gutterBottom>\n                In game, Open your bag, and navigate to the artifacts tab.\n                Select the artifact you want to scan with Genshin Optimizer.{' '}\n                <b>Only artifact from this screen can be scanned.</b>\n              </Typography>\n              <Typography variant=\"h6\">Single artifact</Typography>\n              <Typography gutterBottom>\n                To take a screenshot, in Windows, the shortcut is{' '}\n                <strong>Shift + WindowsKey + S</strong>. Once you selected the\n                region, the image is automatically included in your clipboard.\n              </Typography>\n              <Typography variant=\"h6\">Multiple artifacts</Typography>\n              <Typography gutterBottom>\n                To take advantage of batch uploads, you can use a tool like{' '}\n                <a href=\"https://picpick.app/\" target=\"_blank\" rel=\"noreferrer\">\n                  PicPick\n                </a>{' '}\n                to create a macro to easily to screenshot a region to screenshot\n                multiple artifacts at once.\n              </Typography>\n              <Typography variant=\"h5\">\n                What to include in the screenshot.\n              </Typography>\n              <Typography>\n                As shown in the Image, starting from the top with the artifact\n                name, all the way to the set name(the text in green).{' '}\n              </Typography>\n            </Grid>\n            <Grid item xs={12} md={7}>\n              <Typography variant=\"h5\">\n                Adding Screenshot to Genshin Optimizer\n              </Typography>\n              <Typography>\n                At this point, you should have the artifact snippet either saved\n                to your harddrive, or in your clipboard.\n              </Typography>\n              <Typography gutterBottom>\n                You can click on the box next to \"Browse\" to browse the files in\n                your harddrive for multiple screenshots.\n              </Typography>\n              <Typography>\n                For single screenshots from the snippets, just press{' '}\n                <strong>Ctrl + V</strong> to paste from your clipboard.\n              </Typography>\n              <Typography gutterBottom>\n                You should be able to see a Preview of your artifact snippet,\n                and after waiting a few seconds, the artifact set and the\n                substats will be filled in in the <b>Artifact Editor</b>.\n              </Typography>\n              <Typography variant=\"h5\">Finishing the Artifact</Typography>\n              <Typography>\n                Unfortunately, computer vision is not 100%. There will always be\n                cases where something is not scanned properly. You should always\n                double check the scanned artifact values! Once the artifact has\n                been filled, Click on <strong>Add Artifact</strong> to finish\n                editing the artifact.\n              </Typography>\n            </Grid>\n            <Grid item xs={8} md={5}>\n              <Box\n                component=\"img\"\n                alt=\"main screen after importing stats\"\n                src={scan_art_main}\n                width=\"100%\"\n                height=\"auto\"\n              />\n            </Grid>\n          </Grid>\n        </CardContent>\n        <Divider />\n        <CardContent sx={{ py: 1 }}>\n          <CloseButton large onClick={hide} />\n        </CardContent>\n      </CardDark>\n    </ModalWrapper>\n  )\n}\n","import type {\n  ArtifactRarity,\n  ArtifactSetKey,\n  ArtifactSlotKey,\n  MainStatKey,\n  RarityKey,\n  SubstatKey,\n} from '@genshin-optimizer/consts'\nimport {\n  allArtifactRarityKeys,\n  allArtifactSetKeys,\n  allArtifactSlotKeys,\n  allMainStatKeys,\n  allSubstatKeys,\n  artSlotsData,\n} from '@genshin-optimizer/consts'\nimport type { IArtifact, ISubstat } from '@genshin-optimizer/gi-good'\nimport {\n  artDisplayValue,\n  getMainStatDisplayValue,\n  getMainStatDisplayValues,\n  getSubstatRolls,\n} from '@genshin-optimizer/gi-util'\nimport { clamp, hammingDistance, objKeyMap } from '@genshin-optimizer/util'\nimport type { RecognizeResult, Scheduler } from 'tesseract.js'\nimport { createScheduler, createWorker } from 'tesseract.js'\nimport ColorText from '../Components/ColoredText'\nimport { getArtSheet } from '../Data/Artifacts'\nimport KeyMap from '../KeyMap'\nimport type { ICachedArtifact } from '../Types/artifact'\nimport { BorrowManager } from './BorrowManager'\n\nconst starColor = { r: 255, g: 204, b: 50 } //#FFCC32\nconst workerCount = 2\n\nconst schedulers = new BorrowManager(\n  async (language): Promise<Scheduler> => {\n    const scheduler = createScheduler()\n    const promises = Array(workerCount)\n      .fill(0)\n      .map(async (_) => {\n        const worker = await createWorker({\n          errorHandler: console.error,\n        })\n\n        await worker.load()\n        await worker.loadLanguage(language)\n        await worker.initialize(language)\n        scheduler.addWorker(worker)\n      })\n\n    await Promise.any(promises)\n    return scheduler\n  },\n  (_language, value) => {\n    value.then((value) => value.terminate())\n  }\n)\n\nexport type ProcessedEntry = {\n  fileName: string\n  imageURL: string\n  artifact: IArtifact\n  texts: Dict<keyof ICachedArtifact, Displayable>\n}\nexport type OutstandingEntry = {\n  file: File\n  fileName: string\n  imageURL?: Promise<string>\n  result?: Promise<{ file: File; result: ProcessedEntry }>\n}\ntype Queue = { processed: ProcessedEntry[]; outstanding: OutstandingEntry[] }\ntype UploadMessage = { type: 'upload'; files: OutstandingEntry[] }\ntype ProcessingMessage = { type: 'processing' }\ntype ProcessedMessage = {\n  type: 'processed'\n  file: File\n  result: ProcessedEntry\n}\ntype PopMessage = { type: 'pop' }\ntype ClearMessage = { type: 'clear' }\ntype Color = [number, number, number] // RGB\nexport const queueReducer = (\n  queue: Queue,\n  message:\n    | UploadMessage\n    | ProcessingMessage\n    | ProcessedMessage\n    | PopMessage\n    | ClearMessage\n): Queue => {\n  switch (message.type) {\n    case 'upload':\n      return {\n        processed: queue.processed,\n        outstanding: [...queue.outstanding, ...message.files],\n      }\n    case 'processing': // Processing `outstanding` head. Refresh\n      return { processed: queue.processed, outstanding: [...queue.outstanding] }\n    case 'processed':\n      if (queue.outstanding[0].file === message.file)\n        return {\n          processed: [...queue.processed, message.result],\n          outstanding: queue.outstanding.slice(1),\n        }\n      return queue // Not in the list, ignored\n    case 'pop':\n      return {\n        processed: queue.processed.slice(1),\n        outstanding: queue.outstanding,\n      }\n    case 'clear':\n      return { processed: [], outstanding: [] }\n  }\n}\n\nexport function processEntry(entry: OutstandingEntry) {\n  if (entry.result) return\n\n  const { file, fileName } = entry\n  entry.imageURL = fileToURL(file)\n  entry.result = entry.imageURL.then(async (imageURL) => {\n    const ocrResult = await ocr(imageURL)\n\n    const [artifact, texts] = findBestArtifact(\n      ocrResult.rarities,\n      parseSetKeys(ocrResult.artifactSetTexts),\n      parseSlotKeys(ocrResult.whiteTexts),\n      parseSubstats(ocrResult.substatTexts),\n      parseMainStatKeys(ocrResult.whiteTexts),\n      parseMainStatValues(ocrResult.whiteTexts)\n    )\n\n    return { file, result: { fileName, imageURL, artifact, texts } }\n  })\n}\n\nconst fileToURL = (file: File): Promise<string> =>\n  new Promise((resolve) => {\n    const reader = new FileReader()\n    reader.onloadend = ({ target }) => resolve(target!.result as string)\n    reader.readAsDataURL(file)\n  })\nconst urlToImageData = (urlFile: string): Promise<ImageData> =>\n  new Promise((resolve) => {\n    const img = new Image()\n    img.onload = ({ target }) =>\n      resolve(imageToImageData(target as HTMLImageElement))\n    img.src = urlFile\n  })\nfunction imageToImageData(image: HTMLImageElement): ImageData {\n  const canvas = document.createElement('canvas'),\n    context = canvas.getContext('2d')!\n  canvas.width = image.width\n  canvas.height = image.height\n  context.drawImage(image, 0, 0, image.width, image.height)\n  return context.getImageData(0, 0, image.width, image.height) as ImageData // TODO: May be undefined\n}\nfunction imageDataToCanvas(imageData: ImageData) {\n  // create off-screen canvas element\n  const canvas = document.createElement('canvas')\n  canvas.width = imageData.width\n  canvas.height = imageData.height\n\n  // update canvas with new data\n  canvas.getContext('2d')!.putImageData(imageData, 0, 0)\n  return canvas // produces a PNG file\n}\n\nasync function ocr(imageURL: string): Promise<{\n  artifactSetTexts: string[]\n  substatTexts: string[]\n  whiteTexts: string[]\n  rarities: Set<RarityKey>\n}> {\n  const imageData = await urlToImageData(imageURL)\n\n  const width = imageData.width,\n    halfHeight = Math.floor(imageData.height / 2)\n  const bottomOpts = {\n    rectangle: { top: halfHeight, left: 0, width, height: halfHeight },\n  }\n\n  const awaits = [\n    textsFromImage(\n      bandPass(imageData, [140, 140, 140], [255, 255, 255], {\n        mode: 'bw',\n        region: 'top',\n      })\n    ), // slotkey, mainStatValue, level\n    textsFromImage(\n      bandPass(imageData, [30, 50, 80], [160, 160, 160], { region: 'bot' }),\n      bottomOpts\n    ), // substats\n    textsFromImage(\n      bandPass(imageData, [30, 160, 30], [200, 255, 200], {\n        mode: 'bw',\n        region: 'bot',\n      }),\n      bottomOpts\n    ), // artifact set, look for greenish texts\n  ]\n\n  const rarities = parseRarities(\n    imageData.data,\n    imageData.width,\n    imageData.height\n  )\n  const [whiteTexts, substatTexts, artifactSetTexts] = await Promise.all(awaits)\n  return { whiteTexts, substatTexts, artifactSetTexts, rarities }\n}\nasync function textsFromImage(\n  imageData: ImageData,\n  options: object | undefined = undefined\n): Promise<string[]> {\n  const canvas = imageDataToCanvas(imageData)\n  const rec = await schedulers.borrow(\n    'eng',\n    async (scheduler) =>\n      (await (\n        await scheduler\n      ).addJob('recognize', canvas, options)) as RecognizeResult\n  )\n  return rec.data.lines.map((line) => line.text)\n}\n\nexport function findBestArtifact(\n  rarities: Set<number>,\n  textSetKeys: Set<ArtifactSetKey>,\n  slotKeys: Set<ArtifactSlotKey>,\n  substats: ISubstat[],\n  mainStatKeys: Set<MainStatKey>,\n  mainStatValues: { mainStatValue: number; unit?: string }[]\n): [IArtifact, Dict<keyof ICachedArtifact, Displayable>] {\n  // const relevantSetKey = [...new Set<ArtifactSetKey>([...textSetKeys, \"Adventurer\", \"ArchaicPetra\"])]\n  // TODO: restore\n  const relevantSetKey = [\n    ...new Set<ArtifactSetKey>([...textSetKeys, 'EmblemOfSeveredFate']),\n  ]\n\n  let bestScore = -1,\n    bestArtifacts: IArtifact[] = [\n      {\n        // setKey: \"Adventurer\", rarity: 3, level: 0, slotKey: \"flower\", mainStatKey: \"hp\", substats: [],\n        // TODO: restore\n        setKey: 'EmblemOfSeveredFate',\n        rarity: 3,\n        level: 0,\n        slotKey: 'flower',\n        mainStatKey: 'hp',\n        substats: [],\n        location: '',\n        lock: false,\n      },\n    ]\n\n  // Rate each rarity\n  const rarityRates = objKeyMap(allArtifactRarityKeys, (rarity) => {\n    let score = 0\n    if (textSetKeys.size) {\n      const count = [...textSetKeys].reduce(\n        (count, set) =>\n          count + (getArtSheet(set).rarity.includes(rarity) ? 1 : 0),\n        0\n      )\n      score += count / textSetKeys.size\n    }\n    if (substats.length) {\n      const count = substats.reduce(\n        (count, substat) =>\n          count +\n          (getSubstatRolls(substat.key as SubstatKey, substat.value, rarity)\n            .length\n            ? 1\n            : 0),\n        0\n      )\n      score += (count / substats.length) * 2\n    }\n    return score\n  })\n\n  // Test all *probable* combinations\n  for (const slotKey of allArtifactSlotKeys) {\n    for (const mainStatKey of artSlotsData[slotKey].stats) {\n      const mainStatScore =\n        (slotKeys.has(slotKey) ? 1 : 0) +\n        (mainStatKeys.has(mainStatKey) ? 1 : 0)\n      const relevantMainStatValues = mainStatValues\n        .filter(\n          (value) => value.unit !== '%' || KeyMap.unit(mainStatKey) === '%'\n        ) // Ignore \"%\" text if key isn't \"%\"\n        .map((value) => value.mainStatValue)\n\n      for (const [rarityString, rarityIndividualScore] of Object.entries(\n        rarityRates\n      )) {\n        const rarity = parseInt(rarityString) as ArtifactRarity\n        const setKeys = relevantSetKey.filter((setKey) =>\n          getArtSheet(setKey).rarity.includes(rarity)\n        )\n        const rarityScore = mainStatScore + rarityIndividualScore\n\n        if (rarityScore + 2 < bestScore) continue // Early bail out\n\n        for (const minimumMainStatValue of relevantMainStatValues) {\n          const values = getMainStatDisplayValues(rarity, mainStatKey)\n          const level = Math.max(\n            0,\n            values.findIndex((level) => level >= minimumMainStatValue)\n          )\n          const mainStatVal = values[level]\n          const mainStatValScore =\n            rarityScore + (mainStatVal === minimumMainStatValue ? 1 : 0)\n\n          for (const setKey of setKeys) {\n            const score = mainStatValScore + (textSetKeys.has(setKey) ? 1 : 0)\n            if (score >= bestScore) {\n              if (score > bestScore) bestArtifacts = []\n              bestScore = score\n              bestArtifacts.push({\n                setKey,\n                rarity,\n                level,\n                slotKey,\n                mainStatKey,\n                substats: [],\n                location: '',\n                lock: false,\n              })\n            }\n          }\n        }\n        if (rarityScore >= bestScore) {\n          const level = 0\n          for (const setKey of setKeys) {\n            const score = rarityScore + (textSetKeys.has(setKey) ? 1 : 0)\n\n            if (score > bestScore) bestArtifacts = []\n            bestScore = score\n            bestArtifacts.push({\n              setKey,\n              rarity,\n              level,\n              slotKey,\n              mainStatKey,\n              substats: [],\n              location: '',\n              lock: false,\n            })\n          }\n        }\n      }\n    }\n  }\n\n  const texts = {} as Dict<keyof ICachedArtifact, Displayable>\n  const chosen = {\n    setKey: new Set(),\n    rarity: new Set(),\n    level: new Set(),\n    slotKey: new Set(),\n    mainStatKey: new Set(),\n    mainStatVal: new Set(),\n  } as Dict<keyof ICachedArtifact, Set<string>>\n\n  const result = bestArtifacts[0],\n    resultMainStatVal = getMainStatDisplayValue(\n      result.mainStatKey,\n      result.rarity,\n      result.level\n    )!\n  result.substats = substats.filter(\n    (substat, i) =>\n      substat.key !== result.mainStatKey &&\n      substats.slice(0, i).every((other) => other.key !== substat.key)\n  )\n  for (let i = result.substats.length; i < 4; i++)\n    result.substats.push({ key: '', value: 0 })\n\n  for (const other of bestArtifacts) {\n    chosen.setKey!.add(other.setKey)\n    chosen.rarity!.add(other.rarity as any)\n    chosen.level!.add(other.level as any)\n    chosen.slotKey!.add(other.slotKey)\n    chosen.mainStatKey!.add(other.mainStatKey)\n  }\n\n  function unknownText<T>(\n    value: T,\n    name: Displayable,\n    text: (arg: T) => Displayable\n  ) {\n    return (\n      <>\n        Unknown {name} : Set to{' '}\n        <ColorText color=\"error\">{text(value)}</ColorText>\n      </>\n    )\n  }\n  function ambiguousText<T>(\n    value: T,\n    available: T[],\n    name: Displayable,\n    text: (arg: T) => Displayable\n  ) {\n    return (\n      <>\n        Ambiguous {name} <ColorText color=\"error\">{text(value)}</ColorText> :\n        May also be{' '}\n        {available\n          .filter((v) => v !== value)\n          .map((value, index) => (\n            <>\n              <b>{index > 0 ? '/' : ''}</b>\n              <ColorText color=\"warning\">{text(value)}</ColorText>\n            </>\n          ))}\n      </>\n    )\n  }\n  function detectedText<T>(\n    value: T,\n    name: Displayable,\n    text: (arg: T) => Displayable\n  ) {\n    return (\n      <>\n        Detected {name} <ColorText color=\"success\">{text(value)}</ColorText>\n      </>\n    )\n  }\n  function inferredText<T>(\n    value: T,\n    name: Displayable,\n    text: (arg: T) => Displayable\n  ) {\n    return (\n      <>\n        Inferred {name} <ColorText color=\"warning\">{text(value)}</ColorText>\n      </>\n    )\n  }\n\n  function addText(\n    key: keyof ICachedArtifact,\n    available: Set<any>,\n    name: Displayable,\n    text: (value) => Displayable\n  ) {\n    const recommended = new Set(\n      [...chosen[key]!].filter((value) => available.has(value))\n    )\n    if (recommended.size > 1)\n      texts[key] = ambiguousText(result[key], [...available], name, text)\n    else if (recommended.size === 1)\n      texts[key] = detectedText(result[key], name, text)\n    else if (chosen[key]!.size > 1)\n      texts[key] = unknownText(result[key], name, text)\n    else texts[key] = inferredText(result[key], name, text)\n  }\n\n  addText('setKey', textSetKeys, 'Set', (value) => getArtSheet(value).name)\n  addText('rarity', rarities, 'Rarity', (value) => (\n    <>\n      {value} {value !== 1 ? 'Stars' : 'Star'}\n    </>\n  ))\n  addText(\n    'slotKey',\n    slotKeys,\n    'Slot',\n    (value: ArtifactSlotKey) => artSlotsData[value].name\n  )\n  addText('mainStatKey', mainStatKeys, 'Main Stat', (value) => (\n    <>{KeyMap.getStr(value)}</>\n  ))\n  texts.substats = (\n    <>\n      {result.substats\n        .filter((substat) => substat.key !== '')\n        .map((substat, i) => (\n          <div key={i}>\n            {detectedText(substat, 'Sub Stat', (value) => (\n              <>\n                {KeyMap.getStr(value.key)}+\n                {artDisplayValue(value.value, KeyMap.unit(value.key))}\n                {KeyMap.unit(value.key)}\n              </>\n            ))}\n          </div>\n        ))}\n    </>\n  )\n\n  const valueStrFunc = (value) => (\n    <>\n      {artDisplayValue(value, KeyMap.unit(result.mainStatKey))}\n      {KeyMap.unit(result.mainStatKey)}\n    </>\n  )\n  if (\n    mainStatValues.find((value) => value.mainStatValue === resultMainStatVal)\n  ) {\n    if (mainStatKeys.has(result.mainStatKey)) {\n      texts.level = detectedText(result.level, 'Level', (value) => '+' + value)\n      texts.mainStatVal = detectedText(\n        resultMainStatVal,\n        'Main Stat value',\n        valueStrFunc\n      )\n    } else {\n      texts.level = inferredText(result.level, 'Level', (value) => '+' + value)\n      texts.mainStatVal = inferredText(\n        resultMainStatVal,\n        'Main Stat value',\n        valueStrFunc\n      )\n    }\n  } else {\n    texts.level = unknownText(result.level, 'Level', (value) => '+' + value)\n    texts.mainStatVal = unknownText(\n      resultMainStatVal,\n      'Main Stat value',\n      valueStrFunc\n    )\n  }\n\n  return [result, texts]\n}\n\nfunction parseSetKeys(texts: string[]): Set<ArtifactSetKey> {\n  const results = new Set<ArtifactSetKey>([])\n  for (const text of texts)\n    for (const key of allArtifactSetKeys)\n      if (\n        hammingDistance(\n          text.replace(/\\W/g, ''),\n          getArtSheet(key).nameRaw.replace(/\\W/g, '')\n        ) <= 2\n      )\n        results.add(key)\n  return results\n}\nfunction parseRarities(\n  pixels: Uint8ClampedArray,\n  width: number,\n  height: number\n): Set<RarityKey> {\n  const d = pixels\n  let lastRowNum = 0,\n    rowsWithNumber = 0\n  const results = new Set<RarityKey>([])\n  for (let y = 0; y < height; y++) {\n    let star = 0,\n      onStar = false\n    for (let x = 0; x < width; x++) {\n      const i = (y * width + x) * 4\n      const r = d[i],\n        g = d[i + 1],\n        b = d[i + 2]\n      if (colorCloseEnough({ r, g, b }, starColor)) {\n        if (!onStar) {\n          onStar = true\n          star++\n        }\n      } else {\n        onStar = false\n      }\n    }\n\n    if (lastRowNum !== star) {\n      lastRowNum = star\n      rowsWithNumber = 1\n    } else if (lastRowNum) {\n      rowsWithNumber++\n      if (rowsWithNumber >= 10)\n        results.add(clamp(lastRowNum, 3, 5) as RarityKey)\n    }\n  }\n  return results\n}\nfunction colorCloseEnough(color1, color2, threshold = 5) {\n  const intCloseEnough = (a, b) => Math.abs(a - b) <= threshold\n  return (\n    intCloseEnough(color1.r, color2.r) &&\n    intCloseEnough(color1.g, color2.g) &&\n    intCloseEnough(color1.b, color2.b)\n  )\n}\nfunction parseSlotKeys(texts: string[]): Set<ArtifactSlotKey> {\n  const results = new Set<ArtifactSlotKey>()\n  for (const text of texts)\n    for (const key of allArtifactSlotKeys)\n      if (\n        hammingDistance(\n          text.replace(/\\W/g, ''),\n          artSlotsData[key].name.replace(/\\W/g, '')\n        ) <= 2\n      )\n        results.add(key)\n  return results\n}\nfunction parseMainStatKeys(texts: string[]): Set<MainStatKey> {\n  const results = new Set<MainStatKey>([])\n  for (const text of texts)\n    for (const key of allMainStatKeys) {\n      if (text.toLowerCase().includes(KeyMap.getStr(key)?.toLowerCase() ?? ''))\n        results.add(key)\n      //use fuzzy compare on the ... Bonus texts. heal_ is included.\n      if (\n        key.includes('_bonu') &&\n        hammingDistance(\n          text.replace(/\\W/g, ''),\n          (KeyMap.getStr(key) ?? '').replace(/\\W/g, '')\n        ) <= 1\n      )\n        results.add(key)\n    }\n  return results\n}\nfunction parseMainStatValues(\n  texts: string[]\n): { mainStatValue: number; unit?: string }[] {\n  const results: { mainStatValue: number; unit?: string }[] = []\n  for (const text of texts) {\n    let regex = /(\\d+[,|\\\\.]+\\d)%/\n    let match = regex.exec(text)\n    if (match)\n      results.push({\n        mainStatValue: parseFloat(\n          match[1].replace(/,/g, '.').replace(/\\.{2,}/g, '.')\n        ),\n        unit: '%',\n      })\n    regex = /(\\d+[,|\\\\.]\\d{3}|\\d{2,3})/\n    match = regex.exec(text)\n    if (match)\n      results.push({\n        mainStatValue: parseInt(match[1].replace(/[,|\\\\.]+/g, '')),\n      })\n  }\n  return results\n}\nfunction parseSubstats(texts: string[]): ISubstat[] {\n  const matches: ISubstat[] = []\n  for (let text of texts) {\n    text = text.replace(/^[\\W]+/, '').replace(/\\n/, '')\n    //parse substats\n    allSubstatKeys.forEach((key) => {\n      const name = KeyMap.getStr(key)\n      const regex =\n        KeyMap.unit(key) === '%'\n          ? new RegExp(name + '\\\\s*\\\\+\\\\s*(\\\\d+[\\\\.|,]+\\\\d)%', 'im')\n          : new RegExp(name + '\\\\s*\\\\+\\\\s*(\\\\d+,\\\\d+|\\\\d+)($|\\\\s)', 'im')\n      const match = regex.exec(text)\n      if (match)\n        matches.push({\n          key,\n          value: parseFloat(\n            match[1].replace(/,/g, '.').replace(/\\.{2,}/g, '.')\n          ),\n        })\n    })\n  }\n  return matches.slice(0, 4)\n}\n\nfunction bandPass(\n  pixelData: ImageData,\n  color1: Color,\n  color2: Color,\n  options: { region?: 'top' | 'bot' | 'all'; mode?: 'bw' | 'color' | 'invert' }\n) {\n  const { region = 'all', mode = 'color' } = options\n  const d = Uint8ClampedArray.from(pixelData.data)\n  const top = region === 'top',\n    bot = region === 'bot',\n    all = region === 'all'\n  const bw = mode === 'bw',\n    invert = mode === 'invert'\n  const halfInd = Math.floor(pixelData.width * (pixelData.height / 2) * 4)\n  for (let i = 0; i < d.length; i += 4) {\n    const r = d[i],\n      g = d[i + 1],\n      b = d[i + 2]\n    if (\n      (all || (top && i < halfInd) || (bot && i > halfInd)) &&\n      r >= color1[0] &&\n      r <= color2[0] &&\n      g >= color1[1] &&\n      g <= color2[1] &&\n      b >= color1[2] &&\n      b <= color2[2]\n    ) {\n      if (bw) d[i] = d[i + 1] = d[i + 2] = 0\n      else if (invert) {\n        d[i] = 255 - r\n        d[i + 1] = 255 - g\n        d[i + 2] = 255 - b\n      } // else orignal color\n    } else {\n      d[i] = d[i + 1] = d[i + 2] = 255\n    }\n  }\n  return new ImageData(d, pixelData.width, pixelData.height)\n}\n","export class BorrowManager<T> {\n  data: Dict<string, { value: T; refCount: number }> = {}\n  init: (key: string) => T\n  deinit: (key: string, value: T) => void\n\n  constructor(\n    init: (key: string) => T,\n    deinit: (key: string, value: T) => void\n  ) {\n    this.init = init\n    this.deinit = deinit\n  }\n\n  /**\n   * Borrow the object corresponding to `key`, creating the object as necessary.\n   * The borrowing ends when `callback`'s promise is fulfilled.\n   * When the last borrowing ends, `deinit` the object.\n   *\n   * Do not use `arg` after the `callback`'s promise is fulfilled.\n   */\n  async borrow<R>(key: string, callback: (arg: T) => Promise<R>): Promise<R> {\n    if (!this.data[key]) {\n      this.data[key] = { value: this.init(key), refCount: 0 }\n    }\n\n    const box = this.data[key]!\n    box.refCount += 1\n    const result = await callback(box.value)\n    box.refCount -= 1\n    if (!box.refCount) {\n      // Last user. Cleaning up\n      delete this.data[key]\n      this.deinit(key, box.value)\n    }\n    return result\n  }\n}\n","import type {\n  ArtifactRarity,\n  ArtifactSetKey,\n  ArtifactSlotKey,\n  MainStatKey,\n} from '@genshin-optimizer/consts'\nimport {\n  allElementWithPhyKeys,\n  allSubstatKeys,\n  artSlotsData,\n} from '@genshin-optimizer/consts'\nimport { artifactAsset } from '@genshin-optimizer/g-assets'\nimport type { IArtifact, ISubstat } from '@genshin-optimizer/gi-good'\nimport { getMainStatDisplayStr } from '@genshin-optimizer/gi-util'\nimport { useForceUpdate, usePromise } from '@genshin-optimizer/react-util'\nimport { clamp } from '@genshin-optimizer/util'\nimport {\n  Add,\n  ChevronRight,\n  PhotoCamera,\n  Replay,\n  Shuffle,\n  Update,\n} from '@mui/icons-material'\nimport HelpIcon from '@mui/icons-material/Help'\nimport {\n  Alert,\n  Box,\n  Button,\n  ButtonGroup,\n  CardContent,\n  CardHeader,\n  CircularProgress,\n  Grid,\n  MenuItem,\n  Skeleton,\n  styled,\n  Typography,\n  useMediaQuery,\n  useTheme,\n} from '@mui/material'\nimport type { ChangeEvent } from 'react'\nimport {\n  Suspense,\n  useCallback,\n  useContext,\n  useEffect,\n  useMemo,\n  useReducer,\n  useState,\n} from 'react'\nimport { Trans, useTranslation } from 'react-i18next'\nimport ArtifactRarityDropdown from '../Components/Artifact/ArtifactRarityDropdown'\nimport ArtifactSetAutocomplete from '../Components/Artifact/ArtifactSetAutocomplete'\nimport ArtifactSlotDropdown from '../Components/Artifact/ArtifactSlotDropdown'\nimport {\n  ArtifactColoredIconStatWithUnit,\n  ArtifactStatWithUnit,\n} from '../Components/Artifact/ArtifactStatKeyDisplay'\nimport CardDark from '../Components/Card/CardDark'\nimport CardLight from '../Components/Card/CardLight'\nimport CloseButton from '../Components/CloseButton'\nimport CustomNumberTextField from '../Components/CustomNumberTextField'\nimport DropdownButton from '../Components/DropdownMenu/DropdownButton'\nimport ImgIcon from '../Components/Image/ImgIcon'\nimport ModalWrapper from '../Components/ModalWrapper'\nimport { getArtSheet } from '../Data/Artifacts'\nimport Artifact from '../Data/Artifacts/Artifact'\nimport { DatabaseContext } from '../Database/Database'\nimport {\n  cachedArtifact,\n  validateArtifact,\n} from '../Database/DataManagers/ArtifactData'\nimport StatIcon from '../KeyMap/StatIcon'\nimport type { ICachedArtifact } from '../Types/artifact'\nimport { randomizeArtifact } from '@genshin-optimizer/gi-good'\nimport ArtifactCard from './ArtifactCard'\nimport SubstatEfficiencyDisplayCard from './ArtifactEditor/Components/SubstatEfficiencyDisplayCard'\nimport SubstatInput from './ArtifactEditor/Components/SubstatInput'\nimport UploadExplainationModal from './ArtifactEditor/Components/UploadExplainationModal'\nimport type { OutstandingEntry, ProcessedEntry } from './ScanningUtil'\nimport { processEntry, queueReducer } from './ScanningUtil'\n\nconst maxProcessingCount = 3,\n  maxProcessedCount = 16\nconst allSubstatFilter = new Set(allSubstatKeys)\ntype ResetMessage = { type: 'reset' }\ntype SubstatMessage = { type: 'substat'; index: number; substat: ISubstat }\ntype OverwriteMessage = { type: 'overwrite'; artifact: IArtifact }\ntype UpdateMessage = { type: 'update'; artifact: Partial<IArtifact> }\ntype Message = ResetMessage | SubstatMessage | OverwriteMessage | UpdateMessage\ninterface IEditorArtifact {\n  setKey: ArtifactSetKey\n  slotKey: ArtifactSlotKey\n  level: number\n  rarity: ArtifactRarity\n  mainStatKey: MainStatKey\n  substats: ISubstat[]\n}\nfunction artifactReducer(\n  state: IEditorArtifact | undefined,\n  action: Message\n): IEditorArtifact | undefined {\n  switch (action.type) {\n    case 'reset':\n      return\n    case 'substat': {\n      const { index, substat } = action\n      const oldIndex = substat.key\n        ? state!.substats.findIndex((current) => current.key === substat.key)\n        : -1\n      if (oldIndex === -1 || oldIndex === index)\n        state!.substats[index] = substat\n      // Already in used, swap the items instead\n      else\n        [state!.substats[index], state!.substats[oldIndex]] = [\n          state!.substats[oldIndex],\n          state!.substats[index],\n        ]\n      return { ...state! }\n    }\n    case 'overwrite':\n      return action.artifact\n    case 'update':\n      return { ...state!, ...action.artifact }\n  }\n}\n\nconst InputInvis = styled('input')({\n  display: 'none',\n})\nexport type ArtifactEditorProps = {\n  artifactIdToEdit?: string\n  cancelEdit: () => void\n  allowUpload?: boolean\n  allowEmpty?: boolean\n  disableSet?: boolean\n  disableSlot?: boolean\n}\nexport default function ArtifactEditor({\n  artifactIdToEdit = '',\n  cancelEdit,\n  allowUpload = false,\n  allowEmpty = false,\n  disableSet = false,\n  disableSlot = false,\n}: ArtifactEditorProps) {\n  const { t } = useTranslation('artifact')\n\n  const { database } = useContext(DatabaseContext)\n\n  const [show, setShow] = useState(false)\n\n  const [dirtyDatabase, setDirtyDatabase] = useForceUpdate()\n  useEffect(\n    () => database.arts.followAny(setDirtyDatabase),\n    [database, setDirtyDatabase]\n  )\n\n  const [editorArtifact, artifactDispatch] = useReducer(\n    artifactReducer,\n    undefined\n  )\n  const artifact = useMemo(\n    () => editorArtifact && validateArtifact(editorArtifact, true),\n    [editorArtifact]\n  )\n\n  const [modalShow, setModalShow] = useState(false)\n\n  const [{ processed, outstanding }, dispatchQueue] = useReducer(queueReducer, {\n    processed: [],\n    outstanding: [],\n  })\n  const firstProcessed = processed[0] as ProcessedEntry | undefined\n  const firstOutstanding = outstanding[0] as OutstandingEntry | undefined\n\n  const processingImageURL = usePromise(\n    () => firstOutstanding?.imageURL,\n    [firstOutstanding?.imageURL]\n  )\n  const processingResult = usePromise(\n    () => firstOutstanding?.result,\n    [firstOutstanding?.result]\n  )\n\n  const remaining = processed.length + outstanding.length\n\n  const image = firstProcessed?.imageURL ?? processingImageURL\n  const { artifact: artifactProcessed, texts } = firstProcessed ?? {}\n  // const fileName = firstProcessed?.fileName ?? firstOutstanding?.fileName ?? \"Click here to upload Artifact screenshot files\"\n\n  const disableEditSlot = !!artifact?.location || disableSlot\n\n  useEffect(() => {\n    if (!artifact && artifactProcessed)\n      artifactDispatch({ type: 'overwrite', artifact: artifactProcessed })\n  }, [artifact, artifactProcessed, artifactDispatch])\n\n  useEffect(() => {\n    const numProcessing = Math.min(\n      maxProcessedCount - processed.length,\n      maxProcessingCount,\n      outstanding.length\n    )\n    const processingCurrent = numProcessing && !outstanding[0].result\n    outstanding.slice(0, numProcessing).forEach(processEntry)\n    if (processingCurrent) dispatchQueue({ type: 'processing' })\n  }, [processed.length, outstanding])\n\n  useEffect(() => {\n    if (processingResult)\n      dispatchQueue({ type: 'processed', ...processingResult })\n  }, [processingResult, dispatchQueue])\n\n  const uploadFiles = useCallback(\n    (files?: FileList | null) => {\n      if (!files) return\n      setShow(true)\n      dispatchQueue({\n        type: 'upload',\n        files: Array.from(files).map((file) => ({ file, fileName: file.name })),\n      })\n    },\n    [dispatchQueue, setShow]\n  )\n  const clearQueue = useCallback(\n    () => dispatchQueue({ type: 'clear' }),\n    [dispatchQueue]\n  )\n\n  useEffect(() => {\n    const pasteFunc = (e: Event) =>\n      uploadFiles((e as ClipboardEvent).clipboardData?.files)\n    allowUpload && window.addEventListener('paste', pasteFunc)\n    return () => {\n      if (allowUpload) window.removeEventListener('paste', pasteFunc)\n    }\n  }, [uploadFiles, allowUpload])\n\n  const onUpload = useCallback(\n    (e: ChangeEvent<HTMLInputElement>) => {\n      if (!e.target) return\n      uploadFiles(e.target.files)\n      e.target.value = '' // reset the value so the same file can be uploaded again...\n    },\n    [uploadFiles]\n  )\n\n  const {\n    old,\n    oldType,\n  }: {\n    old: ICachedArtifact | undefined\n    oldType: 'edit' | 'duplicate' | 'upgrade' | ''\n  } = useMemo(() => {\n    const databaseArtifact =\n      dirtyDatabase && artifactIdToEdit && database.arts.get(artifactIdToEdit)\n    if (databaseArtifact) return { old: databaseArtifact, oldType: 'edit' }\n    if (artifact === undefined) return { old: undefined, oldType: '' }\n    const { duplicated, upgraded } =\n      dirtyDatabase && database.arts.findDups(artifact)\n    return {\n      old: duplicated[0] ?? upgraded[0],\n      oldType: duplicated.length !== 0 ? 'duplicate' : 'upgrade',\n    }\n  }, [artifact, artifactIdToEdit, database, dirtyDatabase])\n\n  const { artifact: cArtifact, errors } = useMemo(() => {\n    if (!artifact) return { artifact: undefined, errors: [] as Displayable[] }\n    const validated = cachedArtifact(artifact, artifactIdToEdit)\n    if (old) validated.artifact.location = old.location\n    return validated\n  }, [artifact, artifactIdToEdit, old])\n\n  // Overwriting using a different function from `databaseArtifact` because `useMemo` does not\n  // guarantee to trigger *only when* dependencies change, which is necessary in this case.\n  useEffect(() => {\n    if (artifactIdToEdit === 'new') {\n      setShow(true)\n      artifactDispatch({ type: 'reset' })\n    }\n    const databaseArtifact =\n      artifactIdToEdit && dirtyDatabase && database.arts.get(artifactIdToEdit)\n    if (databaseArtifact) {\n      setShow(true)\n      artifactDispatch({\n        type: 'overwrite',\n        artifact: structuredClone(databaseArtifact),\n      })\n    }\n  }, [artifactIdToEdit, database, dirtyDatabase])\n\n  const sheet = artifact ? getArtSheet(artifact.setKey) : undefined\n  const reset = useCallback(() => {\n    cancelEdit?.()\n    dispatchQueue({ type: 'pop' })\n    artifactDispatch({ type: 'reset' })\n  }, [cancelEdit, artifactDispatch])\n  const update = useCallback(\n    (newValue: Partial<IArtifact>) => {\n      const newSheet = newValue.setKey ? getArtSheet(newValue.setKey) : sheet!\n\n      function pick<T>(\n        value: T | undefined,\n        available: readonly T[],\n        prefer?: T\n      ): T {\n        return value && available.includes(value)\n          ? value\n          : prefer ?? available[0]\n      }\n\n      if (newValue.setKey) {\n        newValue.rarity = pick(\n          artifact?.rarity,\n          newSheet.rarity,\n          Math.max(...newSheet.rarity) as ArtifactRarity\n        )\n        newValue.slotKey = pick(artifact?.slotKey, newSheet.slots)\n      }\n      if (newValue.rarity) newValue.level = artifact?.level ?? 0\n      if (newValue.level)\n        newValue.level = clamp(\n          newValue.level,\n          0,\n          4 * (newValue.rarity ?? artifact!.rarity)\n        )\n      if (newValue.slotKey)\n        newValue.mainStatKey = pick(\n          artifact?.mainStatKey,\n          artSlotsData[newValue.slotKey].stats\n        )\n\n      if (newValue.mainStatKey) {\n        newValue.substats = [0, 1, 2, 3].map((i) =>\n          artifact && artifact.substats[i].key !== newValue.mainStatKey\n            ? artifact!.substats[i]\n            : { key: '', value: 0 }\n        )\n      }\n      artifactDispatch({ type: 'update', artifact: newValue })\n    },\n    [artifact, sheet, artifactDispatch]\n  )\n  const setSubstat = useCallback(\n    (index: number, substat: ISubstat) => {\n      artifactDispatch({ type: 'substat', index, substat })\n    },\n    [artifactDispatch]\n  )\n  const isValid = !errors.length\n  const canClearArtifact = (): boolean =>\n    window.confirm(t`editor.clearPrompt` as string)\n  const { rarity = 5, level = 0, slotKey = 'flower' } = artifact ?? {}\n  const { currentEfficiency = 0, maxEfficiency = 0 } = cArtifact\n    ? Artifact.getArtifactEfficiency(cArtifact, allSubstatFilter)\n    : {}\n  const preventClosing = processed.length || outstanding.length\n  const onClose = useCallback(\n    (e) => {\n      if (preventClosing) e.preventDefault()\n      setShow(false)\n      cancelEdit()\n    },\n    [preventClosing, setShow, cancelEdit]\n  )\n\n  const theme = useTheme()\n  const grmd = useMediaQuery(theme.breakpoints.up('md'))\n\n  const element = artifact\n    ? allElementWithPhyKeys.find((ele) => artifact.mainStatKey.includes(ele))\n    : undefined\n  const color = artifact ? element ?? 'success' : 'primary'\n\n  const updateSetKey = useCallback(\n    (setKey: ArtifactSetKey | '') =>\n      update({ setKey: setKey as ArtifactSetKey }),\n    [update]\n  )\n  const setACDisable = useCallback(\n    (key: ArtifactSetKey | '') => {\n      if (key === '') return true\n      //Disable being able to select any of the prayer set unless the current slotkey is circlet\n      if (\n        disableEditSlot &&\n        slotKey !== 'circlet' &&\n        (key === 'PrayersForDestiny' ||\n          key === 'PrayersForIllumination' ||\n          key === 'PrayersForWisdom' ||\n          key === 'PrayersToSpringtime')\n      )\n        return true\n      return false\n    },\n    [disableEditSlot, slotKey]\n  )\n\n  return (\n    <ModalWrapper open={show} onClose={onClose}>\n      <Suspense\n        fallback={\n          <Skeleton\n            variant=\"rectangular\"\n            sx={{ width: '100%', height: show ? '100%' : 64 }}\n          />\n        }\n      >\n        <CardDark>\n          <UploadExplainationModal\n            modalShow={modalShow}\n            hide={() => setModalShow(false)}\n          />\n          <CardHeader\n            title={\n              <Trans t={t} i18nKey=\"editor.title\">\n                Artifact Editor\n              </Trans>\n            }\n            action={\n              <CloseButton disabled={!!preventClosing} onClick={onClose} />\n            }\n          />\n          <CardContent\n            sx={{ display: 'flex', flexDirection: 'column', gap: 1 }}\n          >\n            <Grid container spacing={1} columns={{ xs: 1, md: 2 }}>\n              {/* Left column */}\n              <Grid item xs={1} display=\"flex\" flexDirection=\"column\" gap={1}>\n                {/* set & rarity */}\n                <Box sx={{ display: 'flex', gap: 1 }}>\n                  {/* Artifact Set */}\n                  <ArtifactSetAutocomplete\n                    disabled={disableSet}\n                    size=\"small\"\n                    artSetKey={artifact?.setKey ?? ''}\n                    setArtSetKey={updateSetKey}\n                    sx={{ flexGrow: 1 }}\n                    label={artifact?.setKey ? '' : t('editor.unknownSetName')}\n                    getOptionDisabled={({ key }) => setACDisable(key)}\n                  />\n                  {/* rarity dropdown */}\n                  <ArtifactRarityDropdown\n                    rarity={artifact ? rarity : undefined}\n                    onChange={(r) => update({ rarity: r })}\n                    filter={(r) => !!sheet?.rarity?.includes?.(r)}\n                    disabled={!sheet}\n                  />\n                </Box>\n\n                {/* level */}\n                <Box component=\"div\" display=\"flex\">\n                  <CustomNumberTextField\n                    id=\"filled-basic\"\n                    label=\"Level\"\n                    variant=\"filled\"\n                    sx={{ flexShrink: 1, flexGrow: 1, mr: 1, my: 0 }}\n                    margin=\"dense\"\n                    size=\"small\"\n                    value={level}\n                    disabled={!sheet}\n                    placeholder={`0~${rarity * 4}`}\n                    onChange={(l) => update({ level: l })}\n                  />\n                  <ButtonGroup>\n                    <Button\n                      onClick={() => update({ level: level - 1 })}\n                      disabled={!sheet || level === 0}\n                    >\n                      -\n                    </Button>\n                    {rarity\n                      ? [...Array(rarity + 1).keys()]\n                          .map((i) => 4 * i)\n                          .map((i) => (\n                            <Button\n                              key={i}\n                              onClick={() => update({ level: i })}\n                              disabled={!sheet || level === i}\n                            >\n                              {i}\n                            </Button>\n                          ))\n                      : null}\n                    <Button\n                      onClick={() => update({ level: level + 1 })}\n                      disabled={!sheet || level === rarity * 4}\n                    >\n                      +\n                    </Button>\n                  </ButtonGroup>\n                </Box>\n\n                {/* slot */}\n                <Box component=\"div\" display=\"flex\">\n                  <ArtifactSlotDropdown\n                    disabled={disableEditSlot || !sheet}\n                    slotKey={slotKey}\n                    onChange={(slotKey) => update({ slotKey })}\n                  />\n                  <CardLight sx={{ p: 1, ml: 1, flexGrow: 1 }}>\n                    <Suspense fallback={<Skeleton width=\"60%\" />}>\n                      <Typography color=\"text.secondary\">\n                        {artifact && sheet?.getSlotName(artifact!.slotKey) ? (\n                          <span>\n                            <ImgIcon\n                              size={2}\n                              src={artifactAsset(\n                                artifact.setKey,\n                                artifact.slotKey\n                              )}\n                            />\n                            {sheet?.getSlotName(artifact!.slotKey)}\n                          </span>\n                        ) : (\n                          t`editor.unknownPieceName`\n                        )}\n                      </Typography>\n                    </Suspense>\n                  </CardLight>\n                </Box>\n\n                {/* main stat */}\n                <Box component=\"div\" display=\"flex\">\n                  <DropdownButton\n                    startIcon={\n                      artifact?.mainStatKey ? (\n                        <StatIcon statKey={artifact.mainStatKey} />\n                      ) : undefined\n                    }\n                    title={\n                      <b>\n                        {artifact ? (\n                          <ArtifactStatWithUnit\n                            statKey={artifact.mainStatKey}\n                          />\n                        ) : (\n                          t`mainStat`\n                        )}\n                      </b>\n                    }\n                    disabled={!sheet}\n                    color={color}\n                  >\n                    {artSlotsData[slotKey].stats.map((mainStatK) => (\n                      <MenuItem\n                        key={mainStatK}\n                        selected={artifact?.mainStatKey === mainStatK}\n                        disabled={artifact?.mainStatKey === mainStatK}\n                        onClick={() => update({ mainStatKey: mainStatK })}\n                      >\n                        <ArtifactColoredIconStatWithUnit statKey={mainStatK} />\n                      </MenuItem>\n                    ))}\n                  </DropdownButton>\n                  <CardLight sx={{ p: 1, ml: 1, flexGrow: 1 }}>\n                    <Typography color=\"text.secondary\">\n                      {artifact\n                        ? getMainStatDisplayStr(\n                            artifact.mainStatKey,\n                            rarity,\n                            level\n                          )\n                        : t`mainStat`}\n                    </Typography>\n                  </CardLight>\n                </Box>\n\n                {/* Current/Max Substats Efficiency */}\n                <SubstatEfficiencyDisplayCard\n                  valid={isValid}\n                  efficiency={currentEfficiency}\n                  t={t}\n                />\n                {currentEfficiency !== maxEfficiency && (\n                  <SubstatEfficiencyDisplayCard\n                    max\n                    valid={isValid}\n                    efficiency={maxEfficiency}\n                    t={t}\n                  />\n                )}\n\n                {/* Image OCR */}\n                {allowUpload && (\n                  <CardLight>\n                    <CardContent\n                      sx={{ display: 'flex', flexDirection: 'column', gap: 1 }}\n                    >\n                      {/* TODO: artifactDispatch not overwrite */}\n                      <Suspense\n                        fallback={<Skeleton width=\"100%\" height=\"100\" />}\n                      >\n                        <Grid container spacing={1} alignItems=\"center\">\n                          <Grid item flexGrow={1}>\n                            <label htmlFor=\"contained-button-file\">\n                              <InputInvis\n                                accept=\"image/*\"\n                                id=\"contained-button-file\"\n                                multiple\n                                type=\"file\"\n                                onChange={onUpload}\n                              />\n                              <Button\n                                component=\"span\"\n                                startIcon={<PhotoCamera />}\n                              >\n                                Upload Screenshot (or Ctrl-V)\n                              </Button>\n                            </label>\n                          </Grid>\n                          <Grid item>\n                            <Button\n                              color=\"info\"\n                              sx={{ px: 2, minWidth: 0 }}\n                              onClick={() => setModalShow(true)}\n                            >\n                              <HelpIcon />\n                            </Button>\n                          </Grid>\n                        </Grid>\n                        {image && (\n                          <Box display=\"flex\" justifyContent=\"center\">\n                            <Box\n                              component=\"img\"\n                              src={image}\n                              width=\"100%\"\n                              maxWidth={350}\n                              height=\"auto\"\n                              alt=\"Screenshot to parse for artifact values\"\n                            />\n                          </Box>\n                        )}\n                        {remaining > 0 && (\n                          <CardDark sx={{ pl: 2 }}>\n                            <Grid container spacing={1} alignItems=\"center\">\n                              {!firstProcessed && firstOutstanding && (\n                                <Grid item>\n                                  <CircularProgress size=\"1em\" />\n                                </Grid>\n                              )}\n                              <Grid item flexGrow={1}>\n                                <Typography>\n                                  <span>\n                                    Screenshots in file-queue:{' '}\n                                    <b>{remaining}</b>\n                                    {/* {process.env.NODE_ENV === \"development\" && ` (Debug: Processed ${processed.length}/${maxProcessedCount}, Processing: ${outstanding.filter(entry => entry.result).length}/${maxProcessingCount}, Outstanding: ${outstanding.length})`} */}\n                                  </span>\n                                </Typography>\n                              </Grid>\n                              <Grid item>\n                                <Button\n                                  size=\"small\"\n                                  color=\"error\"\n                                  onClick={clearQueue}\n                                >\n                                  Clear file-queue\n                                </Button>\n                              </Grid>\n                            </Grid>\n                          </CardDark>\n                        )}\n                      </Suspense>\n                    </CardContent>\n                  </CardLight>\n                )}\n              </Grid>\n\n              {/* Right column */}\n              <Grid item xs={1} display=\"flex\" flexDirection=\"column\" gap={1}>\n                {/* substat selections */}\n                {[0, 1, 2, 3].map((index) => (\n                  <SubstatInput\n                    key={index}\n                    index={index}\n                    artifact={cArtifact}\n                    setSubstat={setSubstat}\n                  />\n                ))}\n                {texts && (\n                  <CardLight>\n                    <CardContent>\n                      <div>{texts.slotKey}</div>\n                      <div>{texts.mainStatKey}</div>\n                      <div>{texts.mainStatVal}</div>\n                      <div>{texts.rarity}</div>\n                      <div>{texts.level}</div>\n                      <div>{texts.substats}</div>\n                      <div>{texts.setKey}</div>\n                    </CardContent>\n                  </CardLight>\n                )}\n              </Grid>\n            </Grid>\n\n            {/* Duplicate/Updated/Edit UI */}\n            {old && (\n              <Grid\n                container\n                sx={{ justifyContent: 'space-around' }}\n                spacing={1}\n              >\n                <Grid item xs={12} md={5.5} lg={4}>\n                  <CardLight>\n                    <Typography\n                      sx={{ textAlign: 'center' }}\n                      py={1}\n                      variant=\"h6\"\n                      color=\"text.secondary\"\n                    >\n                      {oldType !== 'edit'\n                        ? oldType === 'duplicate'\n                          ? t`editor.dupArt`\n                          : t`editor.upArt`\n                        : t`editor.beforeEdit`}\n                    </Typography>\n                    <ArtifactCard artifactObj={old} />\n                  </CardLight>\n                </Grid>\n                {grmd && (\n                  <Grid\n                    item\n                    md={1}\n                    display=\"flex\"\n                    alignItems=\"center\"\n                    justifyContent=\"center\"\n                  >\n                    <CardLight sx={{ display: 'flex' }}>\n                      <ChevronRight sx={{ fontSize: 40 }} />\n                    </CardLight>\n                  </Grid>\n                )}\n                <Grid item xs={12} md={5.5} lg={4}>\n                  <CardLight>\n                    <Typography\n                      sx={{ textAlign: 'center' }}\n                      py={1}\n                      variant=\"h6\"\n                      color=\"text.secondary\"\n                    >{t`editor.preview`}</Typography>\n                    <ArtifactCard artifactObj={cArtifact} />\n                  </CardLight>\n                </Grid>\n              </Grid>\n            )}\n\n            {/* Error alert */}\n            {!isValid && (\n              <Alert variant=\"filled\" severity=\"error\">\n                {errors.map((e, i) => (\n                  <div key={i}>{e}</div>\n                ))}\n              </Alert>\n            )}\n\n            {/* Buttons */}\n            <Grid container spacing={2}>\n              <Grid item>\n                {oldType === 'edit' ? (\n                  <Button\n                    startIcon={<Add />}\n                    onClick={() => {\n                      database.arts.set(old!.id, editorArtifact!)\n                      if (allowEmpty) reset()\n                      else {\n                        setShow(false)\n                        cancelEdit()\n                      }\n                    }}\n                    disabled={!editorArtifact || !isValid}\n                    color=\"primary\"\n                  >\n                    {t`editor.btnSave`}\n                  </Button>\n                ) : (\n                  <Button\n                    startIcon={<Add />}\n                    onClick={() => {\n                      database.arts.new(artifact!)\n                      if (allowEmpty) reset()\n                      else {\n                        setShow(false)\n                        cancelEdit()\n                      }\n                    }}\n                    disabled={!artifact || !isValid}\n                    color={oldType === 'duplicate' ? 'warning' : 'primary'}\n                  >\n                    {t`editor.btnAdd`}\n                  </Button>\n                )}\n              </Grid>\n              <Grid item flexGrow={1}>\n                {allowEmpty && (\n                  <Button\n                    startIcon={<Replay />}\n                    disabled={!artifact}\n                    onClick={() => {\n                      canClearArtifact() && reset()\n                    }}\n                    color=\"error\"\n                  >{t`editor.btnClear`}</Button>\n                )}\n              </Grid>\n              <Grid item>\n                {process.env.NODE_ENV === 'development' && (\n                  <Button\n                    color=\"info\"\n                    startIcon={<Shuffle />}\n                    onClick={() =>\n                      artifactDispatch({\n                        type: 'overwrite',\n                        artifact: randomizeArtifact(),\n                      })\n                    }\n                  >{t`editor.btnRandom`}</Button>\n                )}\n              </Grid>\n              {old && oldType !== 'edit' && (\n                <Grid item>\n                  <Button\n                    startIcon={<Update />}\n                    onClick={() => {\n                      database.arts.set(old.id, {\n                        ...editorArtifact,\n                        location: old.location,\n                      })\n                      allowEmpty ? reset() : setShow(false)\n                    }}\n                    disabled={!editorArtifact || !isValid}\n                    color=\"success\"\n                  >{t`editor.btnUpdate`}</Button>\n                </Grid>\n              )}\n            </Grid>\n          </CardContent>\n        </CardDark>\n      </Suspense>\n    </ModalWrapper>\n  )\n}\n"],"names":["ArtifactRarityDropdown","rarity","onChange","filter","props","t","useTranslation","DropdownButton","title","stars","inline","color","map","MenuItem","disabled","onClick","ArtifactSlotDropdown","slotKey","hasUnselect","startIcon","SlotIcon","undefined","selected","ListItemIcon","Replay","ListItemText","Divider","allArtifactSlotKeys","key","CustomNumberTextField","value","float","state","setState","useState","sendChange","useCallback","parseFunc","parseFloat","parseInt","useEffect","toString","TextField","type","e","target","onBlur","onKeyDown","allArtifactSetKeys","k","startsWith","SubstatEfficiencyDisplayCard","efficiency","max","valid","eff","CardLight","sx","py","px","Grid","container","spacing","item","flexGrow","InfoTooltip","Typography","variant","i18nKey","xs","PercentBadge","SubstatInput","index","artifact","setSubstat","mainStatKey","rolls","substats","accurateValue","reduce","a","b","unit","KeyMap","rollNum","length","error","rollData","allowedRolls","numUpgrades","high","artSubstatRollData","getSubstatValuesPercent","rollOffset","marks","useMemo","getSubstatSummedRolls","v","Box","display","ButtonGroup","size","width","StatIcon","statKey","whiteSpace","allSubstatKeys","CustomNumberInput","flexBasis","placeholder","inputProps","textAlign","TextButton","i","newValue","artDisplayValue","allStats","Button","clamp","SliderWrapper","setValue","pb","SqBadge","count","sort","val","component","indexOf","ml","flexShrink","innerValue","setinnerValue","Slider","step","min","onChangeCommitted","valueLabelDisplay","UploadExplainationModal","modalShow","hide","ModalWrapper","open","onClose","CardDark","CardContent","CloseButton","Alert","severity","mt","md","alt","src","Snippet","height","gutterBottom","href","rel","scan_art_main","large","starColor","r","g","schedulers","constructor","init","deinit","data","this","async","callback","refCount","box","result","scheduler","createScheduler","promises","Array","fill","worker","createWorker","errorHandler","console","load","loadLanguage","language","initialize","addWorker","Promise","any","_language","then","terminate","queueReducer","queue","message","processed","outstanding","files","file","slice","processEntry","entry","fileName","imageURL","fileToURL","ocrResult","imageData","urlFile","resolve","img","Image","onload","image","canvas","document","createElement","context","getContext","drawImage","getImageData","imageToImageData","halfHeight","Math","floor","bottomOpts","rectangle","top","left","awaits","textsFromImage","bandPass","mode","region","rarities","pixels","d","lastRowNum","rowsWithNumber","results","Set","y","star","onStar","x","colorCloseEnough","add","parseRarities","whiteTexts","substatTexts","artifactSetTexts","all","ocr","texts","textSetKeys","slotKeys","mainStatKeys","mainStatValues","relevantSetKey","bestScore","bestArtifacts","setKey","level","location","lock","rarityRates","objKeyMap","allArtifactRarityKeys","score","set","getArtSheet","includes","substat","getSubstatRolls","artSlotsData","stats","mainStatScore","has","relevantMainStatValues","mainStatValue","rarityString","rarityIndividualScore","Object","entries","setKeys","rarityScore","minimumMainStatValue","values","getMainStatDisplayValues","findIndex","mainStatValScore","push","chosen","mainStatVal","resultMainStatVal","getMainStatDisplayValue","every","other","unknownText","name","text","ambiguousText","available","detectedText","inferredText","addText","recommended","valueStrFunc","find","findBestArtifact","hammingDistance","replace","nameRaw","parseSetKeys","parseSlotKeys","matches","match","RegExp","exec","parseSubstats","allMainStatKeys","toLowerCase","parseMainStatKeys","regex","parseMainStatValues","reader","FileReader","onloadend","readAsDataURL","options","putImageData","imageDataToCanvas","borrow","addJob","lines","line","color1","color2","threshold","intCloseEnough","abs","pixelData","Uint8ClampedArray","from","bot","bw","invert","halfInd","ImageData","allSubstatFilter","artifactReducer","action","oldIndex","current","InputInvis","styled","ArtifactEditor","artifactIdToEdit","cancelEdit","allowUpload","allowEmpty","disableSet","disableSlot","database","useContext","DatabaseContext","show","setShow","dirtyDatabase","setDirtyDatabase","useForceUpdate","arts","followAny","editorArtifact","artifactDispatch","useReducer","validateArtifact","setModalShow","dispatchQueue","firstProcessed","firstOutstanding","processingImageURL","usePromise","processingResult","remaining","artifactProcessed","disableEditSlot","numProcessing","processingCurrent","forEach","uploadFiles","clearQueue","pasteFunc","clipboardData","window","addEventListener","removeEventListener","onUpload","old","oldType","databaseArtifact","get","duplicated","upgraded","findDups","cArtifact","errors","validated","cachedArtifact","structuredClone","sheet","reset","update","newSheet","pick","prefer","slots","isValid","currentEfficiency","maxEfficiency","Artifact","preventClosing","preventDefault","theme","useTheme","grmd","useMediaQuery","breakpoints","up","element","allElementWithPhyKeys","ele","updateSetKey","setACDisable","Suspense","fallback","Skeleton","CardHeader","flexDirection","gap","columns","ArtifactSetAutocomplete","artSetKey","setArtSetKey","label","getOptionDisabled","id","mr","my","margin","l","keys","p","getSlotName","ImgIcon","artifactAsset","mainStatK","getMainStatDisplayStr","alignItems","htmlFor","accept","multiple","PhotoCamera","minWidth","Help","justifyContent","maxWidth","pl","CircularProgress","lg","ArtifactCard","artifactObj","ChevronRight","fontSize","Add","new","confirm","process","Update"],"sourceRoot":""}